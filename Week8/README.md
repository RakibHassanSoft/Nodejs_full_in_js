# Day 50

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: One-to-many with ObjectId**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ **One-to-Many relationship** à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‹, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦•à¦Ÿà¦¿ à¦¡à¦•à§à¦®à§‡à¦¨à§à¦Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦…à¦¨à§‡à¦•à¦—à§à¦²à¦¿ à¦¸à¦¾à¦¬-à¦¡à¦•à§à¦®à§‡à¦¨à§à¦Ÿ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¥à¦¾à¦•à¦¬à§‡à¥¤ à¦à¦Ÿà¦¿ à¦¸à¦¾à¦§à¦¾à¦°à¦£à¦¤ **ObjectId** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ MongoDB-à¦¤à§‡ à¦•à¦¾à¦°à§à¦¯à¦•à¦° à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤ 

---

## â¸ï¸ 1. What is One-to-Many Relationship?

à¦à¦•à¦Ÿà¦¿ **One-to-Many** à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡à¦° à¦®à¦§à§à¦¯à§‡, à¦à¦•à¦Ÿà¦¿ à¦à¦•à¦• à¦¡à¦•à§à¦®à§‡à¦¨à§à¦Ÿ à¦…à¦¨à§à¦¯ à¦…à¦¨à§‡à¦• à¦¡à¦•à§à¦®à§‡à¦¨à§à¦Ÿà§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¥à¦¾à¦•à§‡à¥¤ à¦‰à¦¦à¦¾à¦¹à¦°à¦£à¦¸à§à¦¬à¦°à§‚à¦ª, à¦à¦•à¦Ÿà¦¿ **Author** à¦®à¦¡à§‡à¦² à¦¹à¦¤à§‡ à¦ªà¦¾à¦°à§‡ à¦¯à¦¾à¦° à¦…à¦¨à§‡à¦•à¦—à§à¦²à¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦¥à¦¾à¦•à¦¬à§‡à¥¤ à¦à¦–à¦¾à¦¨à§‡ **Author** à¦®à¦¡à§‡à¦²à¦Ÿà¦¿ **Blog** à¦®à¦¡à§‡à¦²à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¥à¦¾à¦•à§‡, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦•à¦Ÿà¦¿ **Author** à¦à¦° à¦œà¦¨à§à¦¯ à¦…à¦¨à§‡à¦• **Blog** à¦ªà§‹à¦·à§à¦Ÿ à¦¥à¦¾à¦•à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¥¤

---

## â¸ï¸ 2. Set up Mongoose Models

### Author Model

à¦ªà§à¦°à¦¥à¦®à§‡ **Author** à¦®à¦¡à§‡à¦² à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦²à§‡à¦–à¦•à§‡à¦° à¦¨à¦¾à¦® à¦à¦¬à¦‚ à¦‡à¦®à§‡à¦‡à¦² à¦¥à¦¾à¦•à¦¬à§‡à¥¤

```js
const mongoose = require('mongoose');

const authorSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true
  },
  email: {
    type: String,
    required: true,
    unique: true
  }
});

const Author = mongoose.model('Author', authorSchema);
module.exports = Author;
```

à¦à¦–à¦¾à¦¨à§‡:
- **Author** à¦®à¦¡à§‡à¦²à¦Ÿà¦¿ à¦²à§‡à¦–à¦•à§‡à¦° à¦¨à¦¾à¦® à¦à¦¬à¦‚ à¦‡à¦®à§‡à¦‡à¦² à¦§à¦¾à¦°à¦£ à¦•à¦°à§‡à¥¤

### Blog Model

à¦à¦–à¦¨ **Blog** à¦®à¦¡à§‡à¦² à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦¶à¦¿à¦°à§‹à¦¨à¦¾à¦®, à¦•à¦¨à¦Ÿà§‡à¦¨à§à¦Ÿ à¦à¦¬à¦‚ à¦²à§‡à¦–à¦• (author) à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ ObjectId à¦¥à¦¾à¦•à¦¬à§‡à¥¤

```js
const mongoose = require('mongoose');

const blogSchema = new mongoose.Schema({
  title: {
    type: String,
    required: true
  },
  content: {
    type: String,
    required: true
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  author: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Author',
    required: true
  }
});

const Blog = mongoose.model('Blog', blogSchema);
module.exports = Blog;
```

à¦à¦–à¦¾à¦¨à§‡:
- **author** à¦«à¦¿à¦²à§à¦¡à¦Ÿà¦¿ **Author** à¦®à¦¡à§‡à¦²à§‡à¦° **ObjectId** à¦°à§‡à¦«à¦¾à¦°à§‡à¦¨à§à¦¸ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦›à§‡à¥¤ à¦à¦Ÿà¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦²à§‡à¦–à¦•à§‡à¦° à¦¸à¦®à§à¦ªà¦°à§à¦• à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§‡à¥¤

---

## â¸ï¸ 3. Create API to Add Blog for an Author

à¦à¦–à¦¨, à¦†à¦®à¦¾à¦¦à§‡à¦° à¦à¦•à¦Ÿà¦¿ API à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡ à¦¯à¦¾ à¦à¦•à¦Ÿà¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‡ à¦à¦¬à¦‚ à¦²à§‡à¦–à¦• (author) à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¤à¦¥à§à¦¯ à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦•à¦°à¦¬à§‡à¥¤

### Example: Add Blog with Author Reference

```js
const express = require('express');
const mongoose = require('mongoose');
const Author = require('./models/Author');
const Blog = require('./models/Blog');
const app = express();
const port = 3000;

mongoose.connect('mongodb://localhost:27017/blogAPI', { useNewUrlParser: true, useUnifiedTopology: true })
  .then(() => console.log('MongoDB connected'))
  .catch(err => console.log(err));

app.use(express.json());

// Add Blog Post for an Author
app.post('/blogs', async (req, res) => {
  try {
    const { title, content, authorId } = req.body;

    // Check if the author exists
    const author = await Author.findById(authorId);
    if (!author) {
      return res.status(404).json({ message: 'Author not found' });
    }

    // Create a new blog post with the author reference
    const newBlog = new Blog({
      title,
      content,
      author: authorId
    });

    // Save the new blog post
    await newBlog.save();
    res.status(201).json(newBlog);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});

app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});
```

à¦à¦–à¦¾à¦¨à§‡:
- **POST `/blogs`** API à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦†à¦®à¦°à¦¾ à¦à¦•à¦Ÿà¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦²à§‡à¦–à¦• (author) à¦à¦° **ObjectId** à¦ªà§à¦°à§‡à¦°à¦¿à¦¤ à¦¹à§Ÿà¥¤

---

## â¸ï¸ 4. Get Blogs for an Author (One-to-Many)

à¦à¦–à¦¨, à¦†à¦®à¦°à¦¾ à¦à¦•à¦Ÿà¦¿ API à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‹ à¦¯à¦¾ à¦à¦•à¦Ÿà¦¿ à¦¨à¦¿à¦°à§à¦¦à¦¿à¦·à§à¦Ÿ à¦²à§‡à¦–à¦•à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¸à¦®à¦¸à§à¦¤ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦ªà§à¦°à¦¦à¦°à§à¦¶à¦¨ à¦•à¦°à¦¬à§‡à¥¤ à¦à¦Ÿà¦¿ **One-to-Many** à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡à¦° à¦¬à¦¾à¦¸à§à¦¤à¦¬à¦¾à§Ÿà¦¨à¥¤

### Example: Get Blogs by Author

```js
// Get all blogs by a specific author
app.get('/authors/:authorId/blogs', async (req, res) => {
  try {
    const blogs = await Blog.find({ author: req.params.authorId }).populate('author');
    if (blogs.length === 0) {
      return res.status(404).json({ message: 'No blogs found for this author' });
    }
    res.json(blogs);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});
```

à¦à¦–à¦¾à¦¨à§‡:
- **GET `/authors/:authorId/blogs`** API à¦²à§‡à¦–à¦•à§‡à¦° **`authorId`** à¦¦à§à¦¬à¦¾à¦°à¦¾ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¸à¦®à¦¸à§à¦¤ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦«à§‡à¦°à¦¤ à¦¦à§‡à§Ÿà¥¤
- **`populate('author')`** à¦¬à§à¦¯à¦¬à¦¹à§ƒà¦¤ à¦¹à§Ÿà§‡à¦›à§‡ à¦¯à¦¾à¦¤à§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦²à§‡à¦–à¦•à§‡à¦° à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤ à¦¤à¦¥à§à¦¯à¦“ à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¥¤

---

## â¸ï¸ 5. Testing the One-to-Many API

à¦à¦–à¦¨, à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¤à§ˆà¦°à¦¿ API à¦—à§à¦²à¦¿ à¦ªà¦°à§€à¦•à§à¦·à¦¾ à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯ **Postman** à¦…à¦¥à¦¬à¦¾ **Insomnia** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡à¥¤

1. **POST `/blogs`** à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿ à¦ªà¦¾à¦ à¦¾à¦¨ à¦à¦•à¦Ÿà¦¿ à¦¨à¦¤à§à¦¨ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡:
   - **Request Body:**
     ```json
     {
       "title": "My Second Blog Post",
       "content": "Content for the second blog post.",
       "authorId": "authorObjectIdHere"
     }
     ```

2. **GET `/authors/:authorId/blogs`** à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿ à¦ªà¦¾à¦ à¦¾à¦¨ à¦²à§‡à¦–à¦•à§‡à¦° à¦¸à¦®à¦¸à§à¦¤ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦ªà§‡à¦¤à§‡:
   - **Response:**
     ```json
     [
       {
         "title": "My Second Blog Post",
         "content": "Content for the second blog post.",
         "author": {
           "_id": "authorObjectIdHere",
           "name": "Author Name",
           "email": "author@example.com"
         }
       }
     ]
     ```

---

## ðŸ“Œ à¦¸à¦‚à¦•à§à¦·à§‡à¦ªà§‡, à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨:

- **One-to-Many relationship** à¦•à¦¿à¦­à¦¾à¦¬à§‡ **MongoDB** à¦à¦¬à¦‚ **Mongoose** à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦•à¦¾à¦°à§à¦¯à¦•à¦° à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤
- **ObjectId** à¦°à§‡à¦«à¦¾à¦°à§‡à¦¨à§à¦¸ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ **Blog** à¦®à¦¡à§‡à¦²à§‡ **Author** à¦®à¦¡à§‡à¦²à§‡à¦° à¦¤à¦¥à§à¦¯ à¦¸à¦‚à¦¯à§à¦•à§à¦¤ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
- **populate()** à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¡à§‡à¦Ÿà¦¾ à¦à¦•à¦¤à§à¦°à§‡ à¦«à§‡à¦°à¦¤ à¦ªà¦¾à¦“à§Ÿà¦¾ à¦¯à¦¾à§Ÿà¥¤

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨ à¦•à¦¿à¦­à¦¾à¦¬à§‡ **One-to-Many relationship** à¦¬à¦¾à¦¸à§à¦¤à¦¬à¦¾à§Ÿà¦¨ à¦•à¦°à¦¬à§‡à¦¨ à¦à¦¬à¦‚ MongoDB-à¦¤à§‡ à¦à¦Ÿà¦¿ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¬à§‡à¦¨à¥¤ ðŸŽ‰ðŸš€





# Day 51

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: Populate Comments Inside Post**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦¶à¦¿à¦–à¦¬à§‹ à¦•à¦¿à¦­à¦¾à¦¬à§‡ MongoDB à¦¤à§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡ **Comments** à¦ªà¦ªà§à¦²à§‡à¦Ÿ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤ à¦à¦Ÿà¦¿ **One-to-Many** à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡à¦° à¦à¦•à¦Ÿà¦¿ à¦‰à¦¨à§à¦¨à¦¤ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦•à¦Ÿà¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡ à¦à¦•à¦¾à¦§à¦¿à¦• à¦®à¦¨à§à¦¤à¦¬à§à¦¯ (comments) à¦¥à¦¾à¦•à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¥¤ à¦†à¦®à¦°à¦¾ à¦à¦‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦Ÿà¦¿ **Mongoose** à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¬à¦¾à¦¸à§à¦¤à¦¬à¦¾à§Ÿà¦¨ à¦•à¦°à¦¬à§‹ à¦à¦¬à¦‚ **populate()** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦…à¦¨à§à¦¤à¦°à§à¦­à§à¦•à§à¦¤ à¦•à¦°à¦¬à§‹à¥¤

---

## â¸ï¸ 1. What is Populate Comments Inside Post?

à¦¯à¦–à¦¨ à¦à¦•à¦Ÿà¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦¥à¦¾à¦•à§‡, à¦¤à¦–à¦¨ à¦ªà§à¦°à¦¤à¦¿à¦Ÿà¦¿ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à§‡à¦° à¦¤à¦¥à§à¦¯ **Post** à¦®à¦¡à§‡à¦²à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¥à¦¾à¦•à§‡à¥¤ à¦†à¦®à¦°à¦¾ **populate()** à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à§‹à¦•à§‡ à¦à¦•à¦¤à§à¦°à§‡ à¦¨à¦¿à§Ÿà§‡ à¦†à¦¸à¦¤à§‡ à¦ªà¦¾à¦°à¦¿à¥¤ à¦à¦‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦Ÿà¦¿ à¦à¦•à¦¦à¦¿à¦•à§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦à¦¬à¦‚ à¦…à¦¨à§à¦¯à¦¦à¦¿à¦•à§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ (comments) à¦à¦° à¦®à¦§à§à¦¯à§‡ à¦¥à¦¾à¦•à¦¤à§‡ à¦ªà¦¾à¦°à§‡, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦• à¦ªà§‹à¦¸à§à¦Ÿà§‡ à¦…à¦¨à§‡à¦• à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦¥à¦¾à¦•à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¥¤

---

## â¸ï¸ 2. Set up Mongoose Models

à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¦à§à¦‡à¦Ÿà¦¿ à¦®à¦¡à§‡à¦² à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡:
1. **Post** - à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦œà¦¨à§à¦¯
2. **Comment** - à¦®à¦¨à§à¦¤à¦¬à§à¦¯à§‡à¦° à¦œà¦¨à§à¦¯

### Post Model

à¦ªà§à¦°à¦¥à¦®à§‡ **Post** à¦®à¦¡à§‡à¦² à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¯à¦¾à¦•, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦¶à¦¿à¦°à§‹à¦¨à¦¾à¦®, à¦•à¦¨à¦Ÿà§‡à¦¨à§à¦Ÿ à¦à¦¬à¦‚ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ (comments) à¦¥à¦¾à¦•à¦¬à§‡à¥¤

```js
const mongoose = require('mongoose');

const postSchema = new mongoose.Schema({
  title: {
    type: String,
    required: true
  },
  content: {
    type: String,
    required: true
  },
  createdAt: {
    type: Date,
    default: Date.now
  },
  comments: [{
    type: mongoose.Schema.Types.ObjectId,
    ref: 'Comment'
  }]
});

const Post = mongoose.model('Post', postSchema);
module.exports = Post;
```

à¦à¦–à¦¾à¦¨à§‡:
- **comments** à¦«à¦¿à¦²à§à¦¡à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ à¦…à§à¦¯à¦¾à¦°à§‡, à¦¯à§‡à¦–à¦¾à¦¨à§‡ **Comment** à¦®à¦¡à§‡à¦²à§‡à¦° **ObjectId** à¦°à§‡à¦«à¦¾à¦°à§‡à¦¨à§à¦¸ à¦¥à¦¾à¦•à¦¬à§‡à¥¤

### Comment Model

à¦à¦–à¦¨ **Comment** à¦®à¦¡à§‡à¦² à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¯à¦¾à¦•, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à§‡à¦° à¦•à¦¨à¦Ÿà§‡à¦¨à§à¦Ÿ à¦à¦¬à¦‚ à¦²à§‡à¦–à¦• (author) à¦¥à¦¾à¦•à¦¬à§‡à¥¤

```js
const mongoose = require('mongoose');

const commentSchema = new mongoose.Schema({
  content: {
    type: String,
    required: true
  },
  author: {
    type: String,
    required: true
  },
  createdAt: {
    type: Date,
    default: Date.now
  }
});

const Comment = mongoose.model('Comment', commentSchema);
module.exports = Comment;
```

à¦à¦–à¦¾à¦¨à§‡:
- **Comment** à¦®à¦¡à§‡à¦²à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à§‡à¦° à¦•à¦¨à¦Ÿà§‡à¦¨à§à¦Ÿ à¦à¦¬à¦‚ à¦²à§‡à¦–à¦• à¦§à¦¾à¦°à¦£ à¦•à¦°à§‡à¥¤

---

## â¸ï¸ 3. Add Comments to a Post

à¦à¦–à¦¨, à¦†à¦®à¦¾à¦¦à§‡à¦° à¦à¦•à¦Ÿà¦¿ API à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡ à¦¯à¦¾ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦¯à§‹à¦— à¦•à¦°à¦¬à§‡à¥¤ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦¸à¦‚à¦¯à§à¦•à§à¦¤ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡ à¦à¦¬à¦‚ à¦¸à§‡à¦‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à§‡à¦° **ObjectId** à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° **comments** à¦…à§à¦¯à¦¾à¦°à§‡à¦¤à§‡ à¦°à¦¾à¦–à¦¾ à¦¹à¦¬à§‡à¥¤

### Example: Add Comment to Post

```js
const express = require('express');
const mongoose = require('mongoose');
const Post = require('./models/Post');
const Comment = require('./models/Comment');
const app = express();
const port = 3000;

mongoose.connect('mongodb://localhost:27017/blogAPI', { useNewUrlParser: true, useUnifiedTopology: true })
  .then(() => console.log('MongoDB connected'))
  .catch(err => console.log(err));

app.use(express.json());

// Add Comment to a Post
app.post('/posts/:postId/comments', async (req, res) => {
  try {
    const { content, author } = req.body;
    const postId = req.params.postId;

    // Find the post to add the comment to
    const post = await Post.findById(postId);
    if (!post) {
      return res.status(404).json({ message: 'Post not found' });
    }

    // Create a new comment
    const newComment = new Comment({
      content,
      author
    });

    // Save the new comment
    await newComment.save();

    // Add the comment's ObjectId to the post's comments array
    post.comments.push(newComment._id);
    await post.save();

    res.status(201).json(newComment);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});

app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});
```

à¦à¦–à¦¾à¦¨à§‡:
- **POST `/posts/:postId/comments`** à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿà§‡ à¦à¦•à¦Ÿà¦¿ à¦¨à¦¤à§à¦¨ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¹à§Ÿ à¦à¦¬à¦‚ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° **comments** à¦…à§à¦¯à¦¾à¦°à§‡à¦¤à§‡ **ObjectId** à¦¯à§à¦•à§à¦¤ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

---

## â¸ï¸ 4. Populate Comments Inside Post

à¦à¦–à¦¨, à¦†à¦®à¦¾à¦¦à§‡à¦° à¦à¦•à¦Ÿà¦¿ API à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡ à¦¯à¦¾ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à§‹ à¦ªà¦ªà§à¦²à§‡à¦Ÿ à¦•à¦°à§‡ à¦¦à§‡à¦–à¦¾à¦¬à§‡à¥¤

### Example: Get Post with Populated Comments

```js
// Get post with populated comments
app.get('/posts/:postId', async (req, res) => {
  try {
    const post = await Post.findById(req.params.postId).populate('comments');
    if (!post) {
      return res.status(404).json({ message: 'Post not found' });
    }
    res.json(post);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});
```

à¦à¦–à¦¾à¦¨à§‡:
- **GET `/posts/:postId`** à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿà§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦¤à¦¥à§à¦¯ à¦à¦¬à¦‚ à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à§‹ **populate()** à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦¤à§à¦°à§‡ à¦¦à§‡à¦–à¦¾ à¦¯à¦¾à¦¬à§‡à¥¤

---

## â¸ï¸ 5. Testing the Populate Comments API

à¦à¦–à¦¨, à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¤à§ˆà¦°à¦¿ API à¦—à§à¦²à¦¿ à¦ªà¦°à§€à¦•à§à¦·à¦¾ à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯ **Postman** à¦…à¦¥à¦¬à¦¾ **Insomnia** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡à¥¤

1. **POST `/posts/:postId/comments`** à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿ à¦ªà¦¾à¦ à¦¾à¦¨ à¦à¦•à¦Ÿà¦¿ à¦¨à¦¤à§à¦¨ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡:
   - **Request Body:**
     ```json
     {
       "content": "This is a comment on the post.",
       "author": "Author Name"
     }
     ```

2. **GET `/posts/:postId`** à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿ à¦ªà¦¾à¦ à¦¾à¦¨ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿ à¦¸à¦¹ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à¦¿ à¦ªà§‡à¦¤à§‡:
   - **Response:**
     ```json
     {
       "title": "My Blog Post",
       "content": "Content for the blog post.",
       "comments": [
         {
           "_id": "commentObjectIdHere",
           "content": "This is a comment on the post.",
           "author": "Author Name",
           "createdAt": "2025-04-10T12:00:00Z"
         }
       ]
     }
     ```

---

## ðŸ“Œ à¦¸à¦‚à¦•à§à¦·à§‡à¦ªà§‡, à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨:

- **Populate()** à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à¦¿ à¦ªà¦ªà§à¦²à§‡à¦Ÿ à¦•à¦°à¦¤à§‡à¥¤
- à¦•à¦¿à¦­à¦¾à¦¬à§‡ **One-to-Many** à¦¸à¦®à§à¦ªà¦°à§à¦• à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ à¦ªà§‹à¦¸à§à¦Ÿà§‡ à¦®à¦¨à§à¦¤à¦¬à§à¦¯ à¦¯à§à¦•à§à¦¤ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤
- à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à¦¿ à¦à¦•à¦¤à§à¦°à§‡ à¦ªà§à¦°à¦¾à¦ªà§à¦¤ à¦•à¦°à¦¤à§‡ API à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾à¥¤

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨ à¦•à¦¿à¦­à¦¾à¦¬à§‡ **populate()** à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ MongoDB à¦¤à§‡ à¦¬à§à¦²à¦— à¦ªà§‹à¦·à§à¦Ÿà§‡à¦° à¦®à¦¨à§à¦¤à¦¬à§à¦¯à¦—à§à¦²à¦¿ à¦ªà¦ªà§à¦²à§‡à¦Ÿ à¦•à¦°à¦¬à§‡à¦¨à¥¤ ðŸŽ‰ðŸš€





# Day 52

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: Start MongoDB Transaction**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦¶à¦¿à¦–à¦¬à§‹ à¦•à¦¿à¦­à¦¾à¦¬à§‡ **MongoDB** à¦¤à§‡ **transactions** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤ **MongoDB transactions** à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨à¦•à§‡ à¦à¦•à¦¤à§à¦°à§‡ à¦•à¦¾à¦°à§à¦¯à¦•à¦° à¦•à¦°à¦¤à§‡ à¦¸à¦•à§à¦·à¦® à¦¹à§Ÿ, à¦¯à¦¾ à¦à¦•à¦• à¦‡à¦‰à¦¨à¦¿à¦Ÿ à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦•à¦¾à¦œ à¦•à¦°à§‡à¥¤ à¦…à¦°à§à¦¥à¦¾à§Ž, à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à¦“ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ à¦ªà§à¦°à§‹ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à¦Ÿà¦¿ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¹à§Ÿ, à¦«à¦²à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦…à¦°à§à¦§à§‡à¦• à¦†à¦ªà¦¡à§‡à¦Ÿà§‡à¦° à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à§‡ à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦¹à¦¬à§‡à¥¤

---

## â¸ï¸ 1. What is MongoDB Transaction?

MongoDB à¦¤à§‡ **transaction** à¦à¦•à¦Ÿà¦¿ à¦¬à¦¾ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ (à¦¯à§‡à¦®à¦¨, insert, update, delete) à¦à¦•à¦¤à§à¦°à§‡ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾à¦° à¦ªà§à¦°à¦•à§à¦°à¦¿à§Ÿà¦¾à¥¤ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à¦“ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ à¦ªà§à¦°à§‹ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¹à§Ÿ, à¦¯à§‡à¦¨ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨ à¦…à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¿à¦¤ à¦¥à¦¾à¦•à§‡à¥¤

MongoDB à¦¤à§‡ transaction à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡, **session** à¦à¦¬à¦‚ **transaction** à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤ à¦à¦Ÿà¦¿ **ACID** (Atomicity, Consistency, Isolation, Durability) à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à§‡à¥¤

---

## â¸ï¸ 2. Setup MongoDB Connection with Transactions

MongoDB à¦¤à§‡ transaction à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯ à¦ªà§à¦°à¦¥à¦®à§‡ **MongoDB Atlas** à¦…à¦¥à¦¬à¦¾ à¦²à§‹à¦•à¦¾à¦² MongoDB à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦¸à¦‚à¦¯à§‹à¦— à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡à¥¤ à¦à¦–à¦¾à¦¨à§‡ à¦†à¦®à¦°à¦¾ **Mongoose** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ MongoDB à¦¤à§‡ à¦¸à¦‚à¦¯à§‹à¦— à¦à¦¬à¦‚ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¶à§à¦°à§ à¦•à¦°à¦¬à§‹à¥¤

### MongoDB Connection Setup

```js
const mongoose = require('mongoose');

mongoose.connect('mongodb://localhost:27017/yourDatabase', {
  useNewUrlParser: true,
  useUnifiedTopology: true,
})
  .then(() => console.log('MongoDB connected'))
  .catch((err) => console.log(err));
```

à¦à¦–à¦¾à¦¨à§‡, à¦†à¦®à¦°à¦¾ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦¸à¦‚à¦¯à§‹à¦— à¦¸à§à¦¥à¦¾à¦ªà¦¨ à¦•à¦°à§‡à¦›à¦¿à¥¤ à¦¸à¦‚à¦¯à§‹à¦— à¦¸à¦«à¦² à¦¹à¦²à§‡ **MongoDB connected** à¦®à§à¦¯à¦¾à¦¸à§‡à¦œ à¦¦à§‡à¦–à¦¾à¦¨à§‹ à¦¹à¦¬à§‡à¥¤

---

## â¸ï¸ 3. Create Models for Transactions

à¦†à¦œà¦•à§‡à¦° à¦‰à¦¦à¦¾à¦¹à¦°à¦£à§‡ à¦†à¦®à¦°à¦¾ à¦¦à§à¦Ÿà¦¿ à¦®à¦¡à§‡à¦² à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‹: **User** à¦à¦¬à¦‚ **Order**à¥¤ à¦à¦•à¦Ÿà¦¿ **User** à¦®à¦¡à§‡à¦² à¦¥à¦¾à¦•à¦¬à§‡ à¦à¦¬à¦‚ à¦à¦•à¦Ÿà¦¿ **Order** à¦®à¦¡à§‡à¦² à¦¥à¦¾à¦•à¦¬à§‡ à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€ à¦à¦•à¦Ÿà¦¿ à¦ªà¦£à§à¦¯ à¦…à¦°à§à¦¡à¦¾à¦° à¦•à¦°à¦¬à§‡à¥¤ à¦†à¦®à¦°à¦¾ à¦¦à§‡à¦–à¦¬à§‹ à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦à¦•à¦¯à§‹à¦—à§‡ **User** à¦à¦¬à¦‚ **Order** à¦®à¦¡à§‡à¦²à§‡à¦° à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ MongoDB transaction à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡à¥¤

### User Model

```js
const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
  name: String,
  balance: {
    type: Number,
    default: 0,
  },
});

const User = mongoose.model('User', userSchema);
module.exports = User;
```

### Order Model

```js
const mongoose = require('mongoose');

const orderSchema = new mongoose.Schema({
  product: String,
  price: Number,
  userId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User',
  },
});

const Order = mongoose.model('Order', orderSchema);
module.exports = Order;
```

à¦à¦–à¦¾à¦¨à§‡:
- **User** à¦®à¦¡à§‡à¦²à¦Ÿà¦¿ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦¨à¦¾à¦® à¦à¦¬à¦‚ à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦§à¦¾à¦°à¦£ à¦•à¦°à§‡à¥¤
- **Order** à¦®à¦¡à§‡à¦²à¦Ÿà¦¿ à¦ªà¦£à§à¦¯ à¦à¦¬à¦‚ à¦¤à¦¾à¦° à¦®à§‚à¦²à§à¦¯à¦¸à¦¹ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¥à¦¾à¦•à§‡à¥¤

---

## â¸ï¸ 4. Start MongoDB Transaction

à¦à¦–à¦¨ à¦†à¦®à¦°à¦¾ **MongoDB Transaction** à¦¶à§à¦°à§ à¦•à¦°à¦¬à§‹à¥¤ à¦à¦•à¦¾à¦§à¦¿à¦• à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¸à¦¾à¦¥à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦•à¦°à¦¾ à¦¹à¦¬à§‡: 
1. à¦à¦•à¦Ÿà¦¿ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦¥à§‡à¦•à§‡ à¦Ÿà¦¾à¦•à¦¾ à¦•à¦®à¦¾à¦¨à§‹à¥¤
2. à¦à¦•à¦Ÿà¦¿ à¦…à¦°à§à¦¡à¦¾à¦° à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾à¥¤

### Example: MongoDB Transaction for User Order

```js
const express = require('express');
const mongoose = require('mongoose');
const User = require('./models/User');
const Order = require('./models/Order');
const app = express();
const port = 3000;

app.use(express.json());

app.post('/order', async (req, res) => {
  const session = await mongoose.startSession();
  session.startTransaction();
  
  try {
    const { userId, product, price } = req.body;

    // Find user and check balance
    const user = await User.findById(userId).session(session);
    if (!user) {
      throw new Error('User not found');
    }
    if (user.balance < price) {
      throw new Error('Insufficient balance');
    }

    // Deduct balance from the user
    user.balance -= price;
    await user.save();

    // Create order
    const newOrder = new Order({
      product,
      price,
      userId: user._id,
    });
    await newOrder.save();

    // Commit transaction
    await session.commitTransaction();
    res.status(201).json({ message: 'Order placed successfully', order: newOrder });
  } catch (error) {
    // If any error occurs, rollback transaction
    await session.abortTransaction();
    res.status(500).json({ error: error.message });
  } finally {
    session.endSession();
  }
});

app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});
```

### Explanation:

1. **Start Session:** à¦ªà§à¦°à¦¥à¦®à§‡ `startSession()` à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ à¦¸à§‡à¦¶à¦¨ à¦¶à§à¦°à§ à¦¹à§Ÿà¥¤ à¦à¦°à¦ªà¦° à¦¸à§‡à¦¶à¦¨à¦Ÿà¦¿à¦•à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¶à§à¦°à§ à¦•à¦°à¦¤à§‡ `startTransaction()` à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
   
2. **Perform Operations:** 
   - à¦ªà§à¦°à¦¥à¦®à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦šà§‡à¦• à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤ à¦¯à¦¦à¦¿ à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦•à¦® à¦¥à¦¾à¦•à§‡, à¦¤à¦¾à¦¹à¦²à§‡ **Insufficient balance** à¦à¦°à¦° à¦¦à§‡à¦–à¦¾à¦¨à§‹ à¦¹à§Ÿà¥¤
   - à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦¥à§‡à¦•à§‡ à¦®à§‚à¦²à§à¦¯ à¦•à¦®à¦¾à¦¨à§‹ à¦¹à§Ÿ à¦à¦¬à¦‚ à¦¤à¦¾à¦°à¦ªà¦° à¦à¦•à¦Ÿà¦¿ à¦¨à¦¤à§à¦¨ à¦…à¦°à§à¦¡à¦¾à¦° à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
   
3. **Commit or Abort Transaction:**
   - à¦¯à¦¦à¦¿ à¦¸à¦¬ à¦•à¦¿à¦›à§ à¦ à¦¿à¦• à¦¥à¦¾à¦•à§‡, à¦¤à¦¾à¦¹à¦²à§‡ `commitTransaction()` à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦•à¦®à¦¿à¦Ÿ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
   - à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦­à§à¦² à¦˜à¦Ÿà§‡, à¦¤à¦¾à¦¹à¦²à§‡ `abortTransaction()` à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

4. **End Session:** à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¶à§‡à¦·à§‡ à¦¸à§‡à¦¶à¦¨à¦Ÿà¦¿ à¦¶à§‡à¦· à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

---

## â¸ï¸ 5. Testing the MongoDB Transaction

à¦à¦–à¦¨, à¦†à¦®à¦°à¦¾ à¦à¦‡ API à¦Ÿà¦¿à¦° à¦•à¦¾à¦°à§à¦¯à¦•à¦¾à¦°à¦¿à¦¤à¦¾ à¦ªà¦°à§€à¦•à§à¦·à¦¾ à¦•à¦°à¦¤à§‡ **Postman** à¦…à¦¥à¦¬à¦¾ **Insomnia** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿à¥¤

### Example Request:

**POST `/order`**

Request Body:
```json
{
  "userId": "userObjectIdHere",
  "product": "Laptop",
  "price": 500
}
```

Response:
```json
{
  "message": "Order placed successfully",
  "order": {
    "_id": "orderObjectIdHere",
    "product": "Laptop",
    "price": 500,
    "userId": "userObjectIdHere"
  }
}
```

---

## ðŸ“Œ à¦¸à¦‚à¦•à§à¦·à§‡à¦ªà§‡, à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨:

- à¦•à¦¿à¦­à¦¾à¦¬à§‡ **MongoDB Transaction** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¤à§à¦°à§‡ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤
- à¦•à¦¿à¦­à¦¾à¦¬à§‡ **session** à¦à¦¬à¦‚ **transaction** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ ACID à¦•à¦®à¦ªà§à¦²à¦¾à§Ÿà§‡à¦¨à§à¦¸ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
- **commitTransaction()** à¦à¦¬à¦‚ **abortTransaction()** à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦à¦¬à¦‚ à¦¸à¦«à¦²à¦¤à¦¾ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨ à¦•à¦¿à¦­à¦¾à¦¬à§‡ MongoDB à¦¤à§‡ **transactions** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡à¦° à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¯à§‹à¦—à§‡ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤ ðŸŽ‰ðŸš€






# Day 53

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: Implement rollback using `abortTransaction()`**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦¶à¦¿à¦–à¦¬à§‹ à¦•à¦¿à¦­à¦¾à¦¬à§‡ MongoDB à¦¤à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦¸à¦®à§Ÿ **rollback** à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ `abortTransaction()` à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡à¥¤ MongoDB à¦¤à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦†à¦®à¦°à¦¾ à¦à¦•à¦¾à¦§à¦¿à¦• à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¸à¦¾à¦¥à§‡ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿, à¦à¦¬à¦‚ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à¦“ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¬à§‡ à¦ªà§à¦°à§‹ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à¦Ÿà¦¿ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤ 

`abortTransaction()` à¦®à§‡à¦¥à¦¡ MongoDB à¦¤à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦¹à§Ÿ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à¦Ÿà¦¿ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯, à¦¯à¦¾à¦¤à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦•à§‹à¦¨à¦“ à¦…à¦ªà§à¦°à¦¤à§à¦¯à¦¾à¦¶à¦¿à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦¨à¦¾ à¦˜à¦Ÿà§‡à¥¤

---

## â¸ï¸ 1. What is Rollback in MongoDB?

MongoDB à¦¤à§‡ **rollback** à¦¹à¦² à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¯à¦¾ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡à¦° à¦†à¦—à§‡à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾ à¦«à¦¿à¦°à§‡ à¦¨à¦¿à§Ÿà§‡ à¦†à¦¸à§‡à¥¤ à¦à¦Ÿà¦¿ à¦¤à¦–à¦¨ à¦ªà§à¦°à§Ÿà§‹à¦œà¦¨ à¦¹à§Ÿ à¦¯à¦–à¦¨ à¦•à§‹à¦¨ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¯à§‹à¦—à§‡ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦¨ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡ à¦à¦¬à¦‚ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ à¦ªà§à¦°à§‹ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à¦Ÿà¦¿ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤ à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦…à¦¯à¦¾à¦šà¦¿à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦¥à§‡à¦•à§‡ à¦°à¦•à§à¦·à¦¾ à¦ªà¦¾à¦“à§Ÿà¦¾ à¦¯à¦¾à§Ÿà¥¤

---

## â¸ï¸ 2. Setup MongoDB Connection with Mongoose

à¦à¦–à¦¾à¦¨à§‡ à¦†à¦®à¦°à¦¾ MongoDB à¦à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦‚à¦¯à§‹à¦— à¦¸à§à¦¥à¦¾à¦ªà¦¨ à¦•à¦°à¦¬à§‹ à¦à¦¬à¦‚ `startSession()` à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¶à§à¦°à§ à¦•à¦°à¦¬à§‹à¥¤

### MongoDB Connection Setup

```js
const mongoose = require('mongoose');

mongoose.connect('mongodb://localhost:27017/yourDatabase', {
  useNewUrlParser: true,
  useUnifiedTopology: true,
})
  .then(() => console.log('MongoDB connected'))
  .catch((err) => console.log(err));
```

à¦à¦–à¦¾à¦¨à§‡, à¦†à¦®à¦°à¦¾ MongoDB à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦¸à¦‚à¦¯à§‹à¦— à¦¸à§à¦¥à¦¾à¦ªà¦¨ à¦•à¦°à¦›à¦¿à¥¤

---

## â¸ï¸ 3. Create Models for Transaction Example

à¦†à¦®à¦°à¦¾ à¦¦à§à¦Ÿà¦¿ à¦®à¦¡à§‡à¦² à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‹: **User** à¦à¦¬à¦‚ **Order**à¥¤ à¦à¦–à¦¾à¦¨à§‡ **User** à¦®à¦¡à§‡à¦²à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦¤à¦¥à§à¦¯ à¦§à¦¾à¦°à¦£ à¦•à¦°à¦¬à§‡ à¦à¦¬à¦‚ **Order** à¦®à¦¡à§‡à¦²à¦Ÿà¦¿ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦…à¦°à§à¦¡à¦¾à¦° à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦•à¦°à¦¬à§‡à¥¤

### User Model

```js
const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
  name: String,
  balance: {
    type: Number,
    default: 0,
  },
});

const User = mongoose.model('User', userSchema);
module.exports = User;
```

### Order Model

```js
const mongoose = require('mongoose');

const orderSchema = new mongoose.Schema({
  product: String,
  price: Number,
  userId: {
    type: mongoose.Schema.Types.ObjectId,
    ref: 'User',
  },
});

const Order = mongoose.model('Order', orderSchema);
module.exports = Order;
```

à¦à¦–à¦¾à¦¨à§‡:
- **User** à¦®à¦¡à§‡à¦² à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€ à¦¤à¦¥à§à¦¯ à¦§à¦¾à¦°à¦£ à¦•à¦°à§‡, à¦¯à§‡à¦®à¦¨ à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸à¥¤
- **Order** à¦®à¦¡à§‡à¦² à¦…à¦°à§à¦¡à¦¾à¦° à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¤à¦¥à§à¦¯ à¦§à¦¾à¦°à¦£ à¦•à¦°à§‡, à¦¯à§‡à¦®à¦¨ à¦ªà¦£à§à¦¯à§‡à¦° à¦¨à¦¾à¦® à¦à¦¬à¦‚ à¦®à§‚à¦²à§à¦¯à¥¤

---

## â¸ï¸ 4. Implementing `abortTransaction()` for Rollback

à¦à¦–à¦¨ à¦†à¦®à¦°à¦¾ MongoDB à¦¤à§‡ **rollback** à¦ªà§à¦°à§Ÿà§‹à¦— à¦•à¦°à¦¬à§‹à¥¤ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ `abortTransaction()` à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¹à¦¬à§‡à¥¤

### Example: Rollback with `abortTransaction()`

```js
const express = require('express');
const mongoose = require('mongoose');
const User = require('./models/User');
const Order = require('./models/Order');
const app = express();
const port = 3000;

app.use(express.json());

app.post('/order', async (req, res) => {
  const session = await mongoose.startSession();
  session.startTransaction();
  
  try {
    const { userId, product, price } = req.body;

    // Find user and check balance
    const user = await User.findById(userId).session(session);
    if (!user) {
      throw new Error('User not found');
    }
    if (user.balance < price) {
      throw new Error('Insufficient balance');
    }

    // Deduct balance from the user
    user.balance -= price;
    await user.save();

    // Create order
    const newOrder = new Order({
      product,
      price,
      userId: user._id,
    });
    await newOrder.save();

    // Commit transaction
    await session.commitTransaction();
    res.status(201).json({ message: 'Order placed successfully', order: newOrder });
  } catch (error) {
    // If any error occurs, rollback transaction
    await session.abortTransaction();
    res.status(500).json({ error: error.message });
  } finally {
    session.endSession();
  }
});

app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});
```

### Explanation:

1. **Start Session and Transaction:** 
   - à¦ªà§à¦°à¦¥à¦®à§‡, à¦†à¦®à¦°à¦¾ `startSession()` à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ à¦¸à§‡à¦¶à¦¨ à¦¶à§à¦°à§ à¦•à¦°à¦¿ à¦à¦¬à¦‚ à¦ªà¦°à§‡ `startTransaction()` à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¶à§à¦°à§ à¦•à¦°à¦¿à¥¤

2. **Perform Operations:** 
   - **User Balance Check:** à¦ªà§à¦°à¦¥à¦®à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦šà§‡à¦• à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤ à¦¯à¦¦à¦¿ à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦•à¦® à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ **Insufficient balance** à¦à¦°à¦° à¦¦à§‡à¦–à¦¾à¦¨à§‹ à¦¹à§Ÿà¥¤
   - **Deduct User Balance:** à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸ à¦¥à§‡à¦•à§‡ à¦¨à¦¿à¦°à§à¦¦à¦¿à¦·à§à¦Ÿ à¦ªà¦°à¦¿à¦®à¦¾à¦£ à¦Ÿà¦¾à¦•à¦¾ à¦•à¦®à¦¾à¦¨à§‹ à¦¹à§Ÿà¥¤
   - **Create Order:** à¦¤à¦¾à¦°à¦ªà¦° à¦à¦•à¦Ÿà¦¿ à¦¨à¦¤à§à¦¨ à¦…à¦°à§à¦¡à¦¾à¦° à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

3. **Commit or Abort Transaction:** 
   - à¦¯à¦¦à¦¿ à¦¸à¦®à¦¸à§à¦¤ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¸à¦ à¦¿à¦•à¦­à¦¾à¦¬à§‡ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ `commitTransaction()` à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à¦Ÿà¦¿ à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
   - à¦¯à¦¦à¦¿ à¦•à§‹à¦¨ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ `abortTransaction()` à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à¦Ÿà¦¿ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦•à¦°à¦¾ à¦¹à§Ÿ, à¦…à¦°à§à¦¥à¦¾à§Ž à¦ªà§‚à¦°à§à¦¬à§‡à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾ à¦«à¦¿à¦°à§‡ à¦†à¦¸à§‡à¥¤

4. **End Session:** 
   - à¦¸à§‡à¦¶à¦¨ à¦¶à§‡à¦·à§‡, `endSession()` à¦®à§‡à¦¥à¦¡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦¸à§‡à¦¶à¦¨à¦Ÿà¦¿ à¦¶à§‡à¦· à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

---

## â¸ï¸ 5. Testing the Rollback

à¦à¦–à¦¨, à¦†à¦®à¦°à¦¾ à¦à¦‡ API à¦Ÿà¦¿à¦° à¦•à¦¾à¦°à§à¦¯à¦•à¦¾à¦°à¦¿à¦¤à¦¾ à¦ªà¦°à§€à¦•à§à¦·à¦¾ à¦•à¦°à¦¤à§‡ **Postman** à¦¬à¦¾ **Insomnia** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿à¥¤

### Example Request:

**POST `/order`**

Request Body:
```json
{
  "userId": "userObjectIdHere",
  "product": "Laptop",
  "price": 500
}
```

Response:
```json
{
  "message": "Order placed successfully",
  "order": {
    "_id": "orderObjectIdHere",
    "product": "Laptop",
    "price": 500,
    "userId": "userObjectIdHere"
  }
}
```

à¦à¦›à¦¾à§œà¦¾, à¦¯à¦¦à¦¿ à¦•à§‹à¦¨ à¦¬à§à¦¯à¦¾à¦²à§‡à¦¨à§à¦¸à§‡à¦° à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à§Ÿ, à¦¤à¦–à¦¨:
```json
{
  "error": "Insufficient balance"
}
```

---

## ðŸ“Œ à¦¸à¦‚à¦•à§à¦·à§‡à¦ªà§‡, à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨:

- à¦•à¦¿à¦­à¦¾à¦¬à§‡ MongoDB à¦¤à§‡ **rollback** à¦ªà§à¦°à§Ÿà§‹à¦— à¦•à¦°à¦¾ à¦¹à§Ÿ `abortTransaction()` à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡à¥¤
- à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦à¦•à¦¾à¦§à¦¿à¦• à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¯à§‹à¦—à§‡ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ MongoDB à¦¤à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡à¥¤
- à¦•à¦¿à¦­à¦¾à¦¬à§‡ **transaction commit** à¦à¦¬à¦‚ **rollback** à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¹à§Ÿ à¦¸à¦«à¦² à¦à¦¬à¦‚ à¦¬à§à¦¯à¦°à§à¦¥ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨à§‡à¦° à¦•à§à¦·à§‡à¦¤à§à¦°à§‡à¥¤

à¦à¦Ÿà¦¿ MongoDB à¦à¦° à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦¸à¦®à§Ÿ à¦°à§‹à¦²à¦¬à§à¦¯à¦¾à¦• à¦ªà§à¦°à§Ÿà§‹à¦— à¦•à¦°à¦¾à¦° à¦à¦•à¦Ÿà¦¿ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦…à¦‚à¦¶ à¦›à¦¿à¦²à¥¤ ðŸŽ‰ðŸš€





# Day 54

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: Soft delete using flags**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦¶à¦¿à¦–à¦¬à§‹ à¦•à¦¿à¦­à¦¾à¦¬à§‡ **Soft Delete** à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ MongoDB à¦¤à§‡à¥¤ à¦¸à¦¾à¦§à¦¾à¦°à¦£à¦¤ **soft delete** à¦à¦®à¦¨ à¦à¦•à¦Ÿà¦¿ à¦ªà§à¦°à¦•à§à¦°à¦¿à§Ÿà¦¾, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦¡à¦¾à¦Ÿà¦¾ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦•à¦°à¦¾ à¦¹à§Ÿ à¦¨à¦¾, à¦¬à¦°à¦‚ à¦¡à¦¾à¦Ÿà¦¾à¦° à¦à¦•à¦Ÿà¦¿ à¦«à§à¦²à§à¦¯à¦¾à¦— à¦¸à§‡à¦Ÿ à¦•à¦°à¦¾ à¦¹à§Ÿ, à¦¯à¦¾ à¦¸à§‡à¦‡ à¦°à§‡à¦•à¦°à§à¦¡à¦Ÿà¦¿ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¹à§Ÿà§‡à¦›à§‡ à¦¬à¦²à§‡ à¦šà¦¿à¦¹à§à¦¨à¦¿à¦¤ à¦•à¦°à§‡à¥¤ à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡, à¦¡à¦¾à¦Ÿà¦¾ à¦¸à¦¹à¦œà§‡ à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦° à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ à¦à¦¬à¦‚ à¦‡à¦¤à¦¿à¦¹à¦¾à¦¸ à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦•à¦°à¦¾ à¦¸à¦®à§à¦­à¦¬ à¦¹à§Ÿà¥¤

---

## â¸ï¸ 1. What is Soft Delete?

**Soft Delete** à¦¹à¦² à¦à¦®à¦¨ à¦à¦•à¦Ÿà¦¿ à¦ªà¦¦à§à¦§à¦¤à¦¿ à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦•à§‹à¦¨à§‹ à¦¡à¦¾à¦Ÿà¦¾ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¨à¦¾ à¦•à¦°à§‡, à¦¤à¦¾à¦° à¦¸à§à¦¥à¦¾à¦¨à§‡ à¦à¦•à¦Ÿà¦¿ à¦«à§à¦²à§à¦¯à¦¾à¦— à¦¸à§‡à¦Ÿ à¦•à¦°à¦¾ à¦¹à§Ÿ, à¦¯à¦¾ à¦¸à§‡à¦‡ à¦¡à¦¾à¦Ÿà¦¾à¦•à§‡ "à¦¡à¦¿à¦²à¦¿à¦Ÿ" à¦¬à¦¾ "à¦…à¦•à§à¦°à¦¿à§Ÿ" à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦šà¦¿à¦¹à§à¦¨à¦¿à¦¤ à¦•à¦°à§‡à¥¤ à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¡à¦¾à¦Ÿà¦¾ à¦à¦–à¦¨à¦“ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦°à§Ÿà§‡ à¦¯à¦¾à§Ÿ à¦à¦¬à¦‚ à¦ªà¦°à§‡ à¦ªà§à¦°à§Ÿà§‹à¦œà¦¨ à¦¹à¦²à§‡ à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦° à¦•à¦°à¦¾ à¦¯à§‡à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¥¤

MongoDB à¦¤à§‡ soft delete à¦ªà§à¦°à¦•à§à¦°à¦¿à§Ÿà¦¾ à¦–à§à¦¬à¦‡ à¦œà¦¨à¦ªà§à¦°à¦¿à§Ÿ à¦•à¦¾à¦°à¦£ à¦à¦Ÿà¦¿ à¦¡à¦¾à¦Ÿà¦¾ à¦¹à¦¾à¦°à¦¾à¦¨à§‹à¦° à¦à§à¦à¦•à¦¿ à¦•à¦®à¦¾à§Ÿ à¦à¦¬à¦‚ à¦…à¦¸à§à¦¥à¦¾à§Ÿà§€à¦­à¦¾à¦¬à§‡ à¦¡à¦¾à¦Ÿà¦¾ à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦•à¦°à¦¾ à¦¸à¦¹à¦œ à¦•à¦°à§‡à¥¤

---

## â¸ï¸ 2. Why Soft Delete?

- **Data Retention:** à¦¡à¦¾à¦Ÿà¦¾ à¦¯à¦¦à¦¿ à¦•à¦–à¦¨à¦“ à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦¹à§Ÿ, à¦¤à¦¬à§‡ à¦à¦Ÿà¦¿ à¦¸à¦¹à¦œ à¦¹à¦¬à§‡ à¦•à¦¾à¦°à¦£ à¦à¦Ÿà¦¿ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦…à¦¬à¦¿à¦•à§ƒà¦¤à¦­à¦¾à¦¬à§‡ à¦¸à¦‚à¦°à¦•à§à¦·à¦¿à¦¤ à¦¥à¦¾à¦•à¦¬à§‡à¥¤
- **Audit Trail:** à¦†à¦ªà¦¨à¦¿ à¦•à¦¿ à¦•à¦–à¦¨à¦“ à¦œà¦¾à¦¨à¦¤à§‡ à¦šà¦¾à¦¨ à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦à¦¬à¦‚ à¦•à¦–à¦¨ à¦¡à¦¾à¦Ÿà¦¾ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¹à§Ÿà§‡à¦›à¦¿à¦²? Soft delete à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦†à¦ªà¦¨à¦¿ à¦¤à¦¾ à¦Ÿà§à¦°à§à¦¯à¦¾à¦• à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨à¥¤
- **Unwanted Deletion Prevention:** à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦­à§à¦²à¦¬à¦¶à¦¤ à¦¡à¦¾à¦Ÿà¦¾ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¹à§Ÿà§‡ à¦¯à¦¾à§Ÿ, à¦¤à¦¬à§‡ soft delete à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¤à¦¾ à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦° à¦•à¦°à¦¾ à¦¸à¦®à§à¦­à¦¬ à¦¹à¦¬à§‡à¥¤

---

## â¸ï¸ 3. Create Schema with Soft Delete Flag

MongoDB à¦¤à§‡ soft delete à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯ à¦†à¦®à¦°à¦¾ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦®à¦¡à§‡à¦² à¦¸à§à¦•à¦¿à¦®à¦¾à¦¤à§‡ à¦à¦•à¦Ÿà¦¿ **flag** à¦«à¦¿à¦²à§à¦¡ à¦¯à§‹à¦— à¦•à¦°à¦¬à§‹ à¦¯à¦¾ à¦°à§‡à¦•à¦°à§à¦¡à¦Ÿà¦¿à¦° à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¸à§à¦Ÿà§‡à¦Ÿà¦¾à¦¸ à¦Ÿà§à¦°à§à¦¯à¦¾à¦• à¦•à¦°à¦¬à§‡à¥¤

### Example: User Model with Soft Delete

```js
const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true,
  },
  email: {
    type: String,
    required: true,
    unique: true,
  },
  deleted: {
    type: Boolean,
    default: false, // flag to indicate if user is deleted or not
  },
  createdAt: {
    type: Date,
    default: Date.now,
  },
});

const User = mongoose.model('User', userSchema);
module.exports = User;
```

### Explanation:

- **deleted:** à¦à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ **Boolean** à¦«à§à¦²à§à¦¯à¦¾à¦— à¦¯à¦¾ à¦°à§‡à¦•à¦°à§à¦¡à¦Ÿà¦¿à¦° à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¹à¦“à§Ÿà¦¾ à¦¨à¦¾ à¦¹à¦“à§Ÿà¦¾ à¦šà¦¿à¦¹à§à¦¨à¦¿à¦¤ à¦•à¦°à§‡à¥¤ à¦¯à¦¦à¦¿ à¦à¦Ÿà¦¿ `true` à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ à¦°à§‡à¦•à¦°à§à¦¡à¦Ÿà¦¿ à¦¡à¦¿à¦²à¦¿à¦Ÿà§‡à¦¡ à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦šà¦¿à¦¹à§à¦¨à¦¿à¦¤ à¦¹à¦¬à§‡à¥¤
- **default:** à¦¡à¦¿à¦«à¦²à§à¦Ÿà¦­à¦¾à¦¬à§‡ `false` à¦¥à¦¾à¦•à¦¬à§‡, à¦…à¦°à§à¦¥à¦¾à§Ž à¦°à§‡à¦•à¦°à§à¦¡à¦Ÿà¦¿ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦¹à¦“à§Ÿà¦¾ à¦¹à§Ÿà¦¨à¦¿à¥¤

---

## â¸ï¸ 4. Implement Soft Delete in Routes

à¦à¦–à¦¨ à¦†à¦®à¦°à¦¾ **soft delete** à¦à¦° à¦œà¦¨à§à¦¯ à¦à¦•à¦Ÿà¦¿ API à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‹à¥¤ à¦à¦‡ API à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦•à§‡ à¦¡à¦¿à¦²à¦¿à¦Ÿ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡, à¦¤à¦¬à§‡ à¦¡à¦¿à¦²à¦¿à¦Ÿà§‡à¦° à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à§‡ **deleted** à¦«à§à¦²à§à¦¯à¦¾à¦—à¦Ÿà¦¿ `true` à¦¸à§‡à¦Ÿ à¦•à¦°à¦¬à§‡à¥¤

### Soft Delete API Endpoint

```js
const express = require('express');
const mongoose = require('mongoose');
const User = require('./models/User');
const app = express();
const port = 3000;

app.use(express.json());

// Soft delete user by setting 'deleted' flag to true
app.delete('/user/:id', async (req, res) => {
  try {
    const { id } = req.params;

    // Find user by ID
    const user = await User.findById(id);
    if (!user) {
      return res.status(404).json({ message: 'User not found' });
    }

    // Mark as deleted
    user.deleted = true;
    await user.save();

    res.status(200).json({ message: 'User soft deleted successfully', user });
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
});

app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});
```

### Explanation:

- **Find User by ID:** à¦†à¦®à¦°à¦¾ à¦ªà§à¦°à¦¥à¦®à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦•à§‡ à¦¤à¦¾à¦° **ID** à¦¦à¦¿à§Ÿà§‡ à¦–à§à¦à¦œà§‡ à¦¬à§‡à¦° à¦•à¦°à¦¿à¥¤
- **Set Deleted Flag:** à¦¤à¦¾à¦°à¦ªà¦° `deleted = true` à¦•à¦°à§‡ à¦¸à§‡à¦‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦•à§‡ "à¦¡à¦¿à¦²à¦¿à¦Ÿ" à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦šà¦¿à¦¹à§à¦¨à¦¿à¦¤ à¦•à¦°à¦¿à¥¤
- **Save User:** à¦¶à§‡à¦·à¦®à§‡à¦¶ à¦†à¦®à¦°à¦¾ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦•à§‡ à¦¸à§‡à¦­ à¦•à¦°à¦¿, à¦¯à¦¾à¦¤à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œà§‡ à¦à¦‡ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨à¦Ÿà¦¿ à¦¸à¦‚à¦°à¦•à§à¦·à¦¿à¦¤ à¦¹à§Ÿà¥¤

---

## â¸ï¸ 5. Implement Soft Delete in Queries

Soft delete à¦•à¦°à¦¾à¦° à¦ªà¦°, à¦†à¦ªà¦¨à¦¿ à¦¸à¦¾à¦§à¦¾à¦°à¦£à¦¤ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦œ à¦¥à§‡à¦•à§‡ **à¦¡à¦¿à¦²à¦¿à¦Ÿà§‡à¦¡ à¦°à§‡à¦•à¦°à§à¦¡**à¦—à§à¦²à¦¿ à¦¦à§‡à¦–à¦¤à§‡ à¦šà¦¾à¦¨ à¦¨à¦¾à¥¤ à¦¤à¦¾à¦‡ à¦†à¦®à¦¾à¦¦à§‡à¦° **find** à¦à¦¬à¦‚ à¦…à¦¨à§à¦¯à¦¾à¦¨à§à¦¯ queries à¦ `deleted: false` à¦«à¦¿à¦²à§à¦Ÿà¦¾à¦° à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦‰à¦šà¦¿à¦¤à¥¤

### Find All Non-deleted Users

```js
app.get('/users', async (req, res) => {
  try {
    const users = await User.find({ deleted: false });
    res.status(200).json(users);
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
});
```

### Explanation:

- **deleted: false:** à¦à¦‡ à¦«à¦¿à¦²à§à¦Ÿà¦¾à¦° à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦†à¦®à¦°à¦¾ à¦¶à§à¦§à§à¦®à¦¾à¦¤à§à¦° **à¦¡à¦¿à¦²à¦¿à¦Ÿà§‡à¦¡ à¦¨à¦¾ à¦¹à¦“à§Ÿà¦¾** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦¦à§‡à¦° à¦¦à§‡à¦–à¦¤à§‡ à¦ªà¦¾à¦šà§à¦›à¦¿à¥¤

---

## â¸ï¸ 6. Restoring Soft Deleted Data

à¦§à¦°à¦¾ à¦¯à¦¾à¦•, à¦¯à¦¦à¦¿ à¦†à¦ªà¦¨à¦¿ à¦•à§‹à¦¨ à¦¡à¦¿à¦²à¦¿à¦Ÿà§‡à¦¡ à¦°à§‡à¦•à¦°à§à¦¡ à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦šà¦¾à¦¨, à¦¤à¦¾à¦¹à¦²à§‡ à¦†à¦ªà¦¨à¦¿ à¦«à§à¦²à§à¦¯à¦¾à¦—à¦Ÿà¦¿ à¦†à¦¬à¦¾à¦° `false` à¦•à¦°à§‡ à¦¦à¦¿à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨à¥¤

### Restore Soft Deleted User

```js
app.put('/user/restore/:id', async (req, res) => {
  try {
    const { id } = req.params;

    // Find soft deleted user by ID
    const user = await User.findById(id);
    if (!user || !user.deleted) {
      return res.status(404).json({ message: 'User not found or not deleted' });
    }

    // Restore user by setting 'deleted' flag to false
    user.deleted = false;
    await user.save();

    res.status(200).json({ message: 'User restored successfully', user });
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
});
```

### Explanation:

- **Find and Check Deleted Flag:** à¦ªà§à¦°à¦¥à¦®à§‡ à¦†à¦®à¦°à¦¾ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€ à¦–à§à¦à¦œà§‡ à¦¬à§‡à¦° à¦•à¦°à¦¿ à¦à¦¬à¦‚ à¦¯à¦¾à¦šà¦¾à¦‡ à¦•à¦°à¦¿ à¦¯à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€ **à¦¡à¦¿à¦²à¦¿à¦Ÿà§‡à¦¡** à¦•à¦¿ à¦¨à¦¾à¥¤
- **Restore:** à¦¯à¦¦à¦¿ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€ à¦¡à¦¿à¦²à¦¿à¦Ÿà§‡à¦¡ à¦¥à¦¾à¦•à§‡, à¦¤à¦¬à§‡ à¦†à¦®à¦°à¦¾ `deleted` à¦«à§à¦²à§à¦¯à¦¾à¦—à¦Ÿà¦¿ `false` à¦•à¦°à§‡ à¦¤à¦¾à¦•à§‡ à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦° à¦•à¦°à¦¿à¥¤

---

## ðŸ“Œ à¦¸à¦‚à¦•à§à¦·à§‡à¦ªà§‡, à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨:

- **Soft delete** à¦•à¦¿à¦­à¦¾à¦¬à§‡ MongoDB à¦¤à§‡ à¦«à§à¦²à§à¦¯à¦¾à¦— à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤
- **Soft delete** à¦•à¦°à¦¾à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¡à¦¾à¦Ÿà¦¾ **à¦…à¦¸à§à¦¥à¦¾à§Ÿà§€à¦­à¦¾à¦¬à§‡ à¦¡à¦¿à¦²à¦¿à¦Ÿ** à¦•à¦°à¦¾ à¦à¦¬à¦‚ **à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦°** à¦•à¦°à¦¾à¥¤
- à¦•à¦¿à¦­à¦¾à¦¬à§‡ **queries** à¦ soft deleted à¦¡à¦¾à¦Ÿà¦¾ à¦«à¦¿à¦²à§à¦Ÿà¦¾à¦° à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤
- à¦•à¦¿à¦­à¦¾à¦¬à§‡ **restore** à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ soft deleted à¦¡à¦¾à¦Ÿà¦¾à¥¤

à¦à¦Ÿà¦¿ MongoDB à¦¤à§‡ **soft delete** à¦à¦° à¦à¦•à¦Ÿà¦¿ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦…à¦‚à¦¶ à¦›à¦¿à¦²à¥¤ ðŸŽ‰ðŸš€






# Day 55

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: Wrap DB operations in transaction**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦¶à¦¿à¦–à¦¬à§‹ à¦•à¦¿à¦­à¦¾à¦¬à§‡ **MongoDB à¦¤à§‡ transaction** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤ MongoDB 4.0 à¦¸à¦‚à¦¸à§à¦•à¦°à¦£ à¦¥à§‡à¦•à§‡ **transactions** à¦¸à¦®à¦°à§à¦¥à¦¿à¦¤, à¦¯à¦¾ ACID (Atomicity, Consistency, Isolation, Durability) à¦—à§à¦£à¦¾à¦¬à¦²à§€ à¦ªà§à¦°à¦¦à¦¾à¦¨ à¦•à¦°à§‡à¥¤

---

## â¸ï¸ 1. What is a Database Transaction?

**Database Transaction** à¦à¦®à¦¨ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¯à¦¾ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦•à¦°à§à¦®à¦ªà¦¦à§à¦§à¦¤à¦¿ (operations) à¦à¦•à¦¤à§à¦°à§‡ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦¨ à¦•à¦°à§‡, à¦à¦¬à¦‚ à¦¸à¦®à¦¸à§à¦¤ à¦•à¦°à§à¦®à¦ªà¦¦à§à¦§à¦¤à¦¿ à¦à¦•à¦¸à¦¾à¦¥à§‡ à¦¸à¦«à¦² à¦¬à¦¾ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¤à§‡ à¦¹à¦¬à§‡à¥¤ à¦à¦° à¦®à¦¾à¦¨à§‡ à¦¹à¦² à¦¯à§‡ à¦¯à¦¦à¦¿ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ à¦ªà§à¦°à§‹ transaction à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿà§‡ à¦¯à¦¾à¦¬à§‡ à¦à¦¬à¦‚ à¦¸à¦®à¦¸à§à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦‰à¦²à§à¦Ÿà§‡ à¦¯à¦¾à¦¬à§‡ (rollback)à¥¤

à¦à¦•à¦Ÿà¦¿ transaction à¦¤à¦¿à¦¨à¦Ÿà¦¿ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦—à§à¦£à¦¾à¦¬à¦²à§€ à¦§à¦¾à¦°à¦£ à¦•à¦°à§‡:
1. **Atomicity:** à¦¸à¦®à¦¸à§à¦¤ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¤à§à¦°à§‡ à¦¸à¦«à¦² à¦¬à¦¾ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¬à§‡à¥¤
2. **Consistency:** à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨ à¦ªà§‚à¦°à§à¦¬à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦™à§à¦—à¦¤à¦¿à¦ªà§‚à¦°à§à¦£ à¦¥à¦¾à¦•à¦¬à§‡à¥¤
3. **Isolation:** à¦à¦•à¦Ÿà¦¿ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à§‡à¦° à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦…à¦¨à§à¦¯ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¹à¦¸à§à¦¤à¦•à§à¦·à§‡à¦ª à¦•à¦°à¦¬à§‡ à¦¨à¦¾à¥¤
4. **Durability:** à¦¸à¦«à¦² à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¶à§‡à¦· à¦¹à¦²à§‡, à¦¤à¦¾à¦° à¦«à¦²à¦¾à¦«à¦² à¦šà¦¿à¦°à¦•à¦¾à¦² à¦¸à§à¦¥à¦¾à§Ÿà§€ à¦¹à¦¬à§‡à¥¤

---

## â¸ï¸ 2. Why Use Transactions?

MongoDB à¦¤à§‡ transactions à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡:
- **Consistency** à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿ, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¤à§à¦°à§‡ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦¿à¦¤ à¦¹à¦¤à§‡ à¦¹à§Ÿà¥¤
- **Data integrity** à¦¬à¦œà¦¾à§Ÿ à¦°à¦¾à¦–à¦¾ à¦¯à¦¾à§Ÿ, à¦¬à¦¿à¦¶à§‡à¦· à¦•à¦°à§‡ à¦¯à¦–à¦¨ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦Ÿà§‡à¦¬à¦¿à¦² à¦¬à¦¾ à¦•à§‹à¦²à§‡à¦•à¦¶à¦¨ à¦à¦•à¦‡ à¦¸à¦®à§Ÿà§‡ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤

---

## â¸ï¸ 3. How to Use Transactions in MongoDB?

MongoDB à¦¤à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯, à¦†à¦®à¦°à¦¾ **session** à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¿ à¦à¦¬à¦‚ à¦¸à§‡à¦‡ session à¦à¦° à¦…à¦§à§€à¦¨à§‡ à¦¸à¦®à¦¸à§à¦¤ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦¨ à¦•à¦°à¦¿à¥¤ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦†à¦®à¦°à¦¾ **rollback** à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿à¥¤

---

## â¸ï¸ 4. Steps to Wrap DB Operations in a Transaction

à¦à¦–à¦¨ à¦†à¦®à¦°à¦¾ à¦¦à§‡à¦–à¦¬à§‹ à¦•à¦¿à¦­à¦¾à¦¬à§‡ **MongoDB à¦¤à§‡ transaction** à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤

### Example: Transfer Money Between Two Accounts (Transactional Operation)

à¦†à¦®à¦°à¦¾ à¦à¦•à¦Ÿà¦¿ à¦‰à¦¦à¦¾à¦¹à¦°à¦£ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‹ à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦à¦•à¦Ÿà¦¿ à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¥à§‡à¦•à§‡ à¦…à¦¨à§à¦¯ à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿà§‡ à¦Ÿà¦¾à¦•à¦¾ à¦Ÿà§à¦°à¦¾à¦¨à§à¦¸à¦«à¦¾à¦° à¦•à¦°à¦¾ à¦¹à¦¬à§‡à¥¤ à¦à¦‡ à¦•à¦¾à¦œà¦Ÿà¦¿ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à§‡, à¦¤à¦¾à¦‡ à¦†à¦®à¦°à¦¾ à¦à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à§‡ à¦°à¦¾à¦–à¦¤à§‡ à¦šà¦¾à¦‡à¥¤

### 4.1. Transaction Setup & Handling

```js
const mongoose = require('mongoose');

// Define schemas for Account model
const accountSchema = new mongoose.Schema({
  name: String,
  balance: Number,
});

const Account = mongoose.model('Account', accountSchema);

const transferMoney = async (senderId, receiverId, amount) => {
  const session = await mongoose.startSession();
  session.startTransaction();

  try {
    const sender = await Account.findById(senderId).session(session);
    const receiver = await Account.findById(receiverId).session(session);

    if (!sender || !receiver) {
      throw new Error('Sender or Receiver not found');
    }

    // Check if sender has enough balance
    if (sender.balance < amount) {
      throw new Error('Insufficient balance');
    }

    // Deduct from sender and add to receiver
    sender.balance -= amount;
    receiver.balance += amount;

    // Save both documents
    await sender.save();
    await receiver.save();

    // Commit the transaction
    await session.commitTransaction();
    session.endSession();
    console.log('Transaction successful');
  } catch (error) {
    // Rollback the transaction in case of error
    await session.abortTransaction();
    session.endSession();
    console.error('Transaction failed', error);
  }
};
```

### Explanation:

1. **Start a session**: 
   - à¦ªà§à¦°à¦¥à¦®à§‡ à¦à¦•à¦Ÿà¦¿ session à¦¶à§à¦°à§ à¦•à¦°à¦¾ à¦¹à§Ÿ `mongoose.startSession()` à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡à¥¤
2. **Start Transaction**:
   - à¦¤à¦¾à¦°à¦ªà¦° à¦¸à§‡à¦‡ session à¦ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¶à§à¦°à§ à¦•à¦°à¦¾ à¦¹à§Ÿ `session.startTransaction()` à¦¦à¦¿à§Ÿà§‡à¥¤
3. **Perform DB Operations**:
   - `findById()` à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ sender à¦à¦¬à¦‚ receiver à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦–à§‹à¦à¦œà¦¾ à¦¹à§Ÿ à¦à¦¬à¦‚ à¦¸à§‡à¦‡ session à¦ à¦•à¦¾à¦°à§à¦¯à¦•à§à¦°à¦® à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
   - à¦à¦° à¦ªà¦°à§‡ sender à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¥à§‡à¦•à§‡ à¦Ÿà¦¾à¦•à¦¾ à¦•à¦¾à¦Ÿà¦¾ à¦¹à§Ÿ à¦à¦¬à¦‚ receiver à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿà§‡ à¦¯à§‹à¦— à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
4. **Commit Transaction**:
   - à¦¸à¦¬à¦•à¦¿à¦›à§ à¦ à¦¿à¦• à¦¥à¦¾à¦•à¦²à§‡, `session.commitTransaction()` à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦•à¦®à¦¿à¦Ÿ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
5. **Rollback Transaction**:
   - à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ error à¦˜à¦Ÿà§‡, à¦¤à¦¾à¦¹à¦²à§‡ `session.abortTransaction()` à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à¦¾ à¦¹à§Ÿ à¦à¦¬à¦‚ à¦•à§‹à¦¨ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡ à¦¸à§‡à¦­ à¦¹à§Ÿ à¦¨à¦¾à¥¤

---

## â¸ï¸ 5. Using Transactions with Multiple Collections

MongoDB à¦¤à§‡ à¦à¦•à¦¾à¦§à¦¿à¦• à¦•à§‹à¦²à§‡à¦•à¦¶à¦¨à§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¸à¦®à§à¦­à¦¬à¥¤ à¦†à¦ªà¦¨à¦¿ à¦¯à¦¦à¦¿ à¦à¦•à¦¾à¦§à¦¿à¦• à¦•à§‹à¦²à§‡à¦•à¦¶à¦¨à§‡ à¦¡à¦¾à¦Ÿà¦¾ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¤à§‡ à¦šà¦¾à¦¨, à¦¤à¦¬à§‡ à¦¸à§‡à¦—à§à¦²à¦¿à¦“ à¦à¦•à¦Ÿà¦¿ à¦¸à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦¤à§à¦°à§‡ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à¦¤à§‡ à¦¹à¦¬à§‡à¥¤

```js
const orderSchema = new mongoose.Schema({
  productId: mongoose.Schema.Types.ObjectId,
  userId: mongoose.Schema.Types.ObjectId,
  quantity: Number,
  status: String,
});

const Order = mongoose.model('Order', orderSchema);

const createOrderAndDeductStock = async (userId, productId, quantity) => {
  const session = await mongoose.startSession();
  session.startTransaction();

  try {
    // Create order
    const order = new Order({ productId, userId, quantity, status: 'pending' });
    await order.save({ session });

    // Deduct stock from product (assuming we have a Product model)
    const product = await Product.findById(productId).session(session);
    if (!product || product.stock < quantity) {
      throw new Error('Insufficient stock');
    }

    product.stock -= quantity;
    await product.save({ session });

    // Commit transaction
    await session.commitTransaction();
    session.endSession();
    console.log('Order created and stock updated');
  } catch (error) {
    // Rollback in case of error
    await session.abortTransaction();
    session.endSession();
    console.error('Order creation failed', error);
  }
};
```

### Explanation:

- à¦†à¦®à¦°à¦¾ à¦à¦–à¦¾à¦¨à§‡ **Order** à¦•à§‹à¦²à§‡à¦•à¦¶à¦¨à§‡à¦° à¦¸à¦¾à¦¥à§‡ **Product** à¦•à§‹à¦²à§‡à¦•à¦¶à¦¨à¦•à§‡à¦“ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦›à¦¿à¥¤
- transaction à¦à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ **order** à¦à¦¬à¦‚ **stock** à¦à¦•à¦¯à§‹à¦—à§‡ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡à¥¤
- à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦–à¦¨ **rollback** à¦¹à¦¬à§‡ à¦à¦¬à¦‚ à¦¸à¦®à¦¸à§à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦¬à¦¾à¦¤à¦¿à¦² à¦¹à§Ÿà§‡ à¦¯à¦¾à¦¬à§‡à¥¤

---

## ðŸ“Œ Summary:

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨ à¦•à¦¿à¦­à¦¾à¦¬à§‡ MongoDB à¦¤à§‡ **transaction** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¸à¦¾à¦¥à§‡ à¦¸à¦®à§à¦ªà¦¾à¦¦à¦¨ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤ à¦à¦–à¦¾à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦¦à§‡à¦–à§‡à¦›à¦¿ à¦•à¦¿à¦­à¦¾à¦¬à§‡:
- **Transaction** à¦¶à§à¦°à§ à¦à¦¬à¦‚ à¦¶à§‡à¦· à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
- à¦à¦•à¦¾à¦§à¦¿à¦• **collections** à¦à¦° à¦®à¦§à§à¦¯à§‡ **atomic** (à¦à¦•à¦•) à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤
- **Commit** à¦à¦¬à¦‚ **Rollback** à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

à¦à¦Ÿà¦¿ à¦–à§à¦¬à¦‡ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦à¦•à¦Ÿà¦¿ à¦¦à¦•à§à¦·à¦¤à¦¾ à¦¯à¦–à¦¨ à¦†à¦ªà¦¨à¦¿ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦•à¦¾à¦œ à¦•à¦°à§‡à¦¨, à¦¬à¦¿à¦¶à§‡à¦· à¦•à¦°à§‡ à¦¯à¦–à¦¨ à¦†à¦ªà¦¨à¦¿ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à¦¤à§‡ à¦šà¦¾à¦¨ à¦¯à§‡ à¦¸à¦®à¦¸à§à¦¤ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¯à§‹à¦—à§‡ à¦¸à¦«à¦² à¦¬à¦¾ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¬à§‡à¥¤ ðŸš€




# Day 56

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: Mini project: E-commerce checkout logic with rollback**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦à¦•à¦Ÿà¦¿ **E-commerce checkout logic** à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‹ à¦¯à§‡à¦–à¦¾à¦¨à§‡ **rollback** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦¹à¦¬à§‡à¥¤ à¦à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ à¦®à¦¿à¦¨à¦¿à¦ªà§à¦°à¦œà§‡à¦•à§à¦Ÿ à¦¯à¦¾ **MongoDB transaction** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦à¦•à¦Ÿà¦¿ **checkout process** à¦¬à¦¾à¦¸à§à¦¤à¦¬à¦¾à§Ÿà¦¨ à¦•à¦°à¦¬à§‡, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¯à§‡à¦®à¦¨ **order creation**, **inventory update**, à¦à¦¬à¦‚ **payment processing** à¦à¦•à¦¯à§‹à¦—à§‡ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à¦¾ à¦¹à¦¬à§‡à¥¤ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦–à¦¨ **rollback** à¦¹à¦¬à§‡ à¦à¦¬à¦‚ à¦¸à¦®à¦¸à§à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦ªà§‚à¦°à§à¦¬à¦¾à¦¬à¦¸à§à¦¥à¦¾à§Ÿ à¦«à¦¿à¦°à§‡ à¦¯à¦¾à¦¬à§‡à¥¤

---

## â¸ï¸ 1. Project Overview

à¦†à¦®à¦°à¦¾ à¦à¦•à¦Ÿà¦¿ **E-commerce checkout system** à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¬à§‹ à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦—à§à¦°à¦¾à¦¹à¦• à¦à¦•à¦Ÿà¦¿ à¦ªà¦£à§à¦¯ à¦•à¦¿à¦¨à¦¬à§‡, à¦ªà¦£à§à¦¯à§‡à¦° à¦ªà¦°à¦¿à¦®à¦¾à¦£ à¦¸à§à¦Ÿà¦• à¦¥à§‡à¦•à§‡ à¦•à¦®à¦¾à¦¨à§‹ à¦¹à¦¬à§‡ à¦à¦¬à¦‚ à¦à¦•à¦Ÿà¦¿ **order** à¦¤à§ˆà¦°à¦¿ à¦¹à¦¬à§‡à¥¤ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦à¦•à¦Ÿà¦¿ à¦§à¦¾à¦ªà§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à§Ÿ (à¦¯à§‡à¦®à¦¨, **payment failure** à¦¬à¦¾ **insufficient stock**), à¦¤à¦¾à¦¹à¦²à§‡ à¦¸à¦®à¦¸à§à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ **rollback** à¦¹à§Ÿà§‡ à¦¯à¦¾à¦¬à§‡ à¦à¦¬à¦‚ à¦—à§à¦°à¦¾à¦¹à¦•à¦•à§‡ à¦¸à¦ à¦¿à¦• à¦¤à¦¥à§à¦¯ à¦œà¦¾à¦¨à¦¾à¦¨à§‹ à¦¹à¦¬à§‡à¥¤

---

## â¸ï¸ 2. Steps to Implement Checkout Logic

### Step 1: Define the Models
à¦†à¦®à¦°à¦¾ à§©à¦Ÿà¦¿ à¦®à¦¡à§‡à¦² à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‹:
1. **Product** - à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦ªà¦£à§à¦¯à§‡à¦° à¦¤à¦¥à§à¦¯ à¦¥à¦¾à¦•à¦¬à§‡ (à¦¯à§‡à¦®à¦¨ à¦¨à¦¾à¦®, à¦¦à¦¾à¦®, à¦¸à§à¦Ÿà¦• à¦ªà¦°à¦¿à¦®à¦¾à¦£)
2. **Order** - à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦—à§à¦°à¦¾à¦¹à¦•à§‡à¦° à¦…à¦°à§à¦¡à¦¾à¦°à§‡à¦° à¦¤à¦¥à§à¦¯ à¦¥à¦¾à¦•à¦¬à§‡ (à¦¯à§‡à¦®à¦¨ à¦ªà¦£à§à¦¯à§‡à¦° à¦¤à¦¥à§à¦¯, à¦ªà¦°à¦¿à¦®à¦¾à¦£, à¦¸à§à¦Ÿà§à¦¯à¦¾à¦Ÿà¦¾à¦¸)
3. **Payment** - à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¸à¦®à§à¦ªà¦°à§à¦•à¦¿à¦¤ à¦¤à¦¥à§à¦¯ à¦¥à¦¾à¦•à¦¬à§‡ (à¦¯à§‡à¦®à¦¨ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¸à§à¦Ÿà§à¦¯à¦¾à¦Ÿà¦¾à¦¸)

### Step 2: Start Transaction for Checkout
à¦à¦–à¦¾à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦à¦•à¦¾à¦§à¦¿à¦• à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¤à§à¦°à§‡ à¦•à¦°à¦¬à§‹:
- à¦ªà¦£à§à¦¯à§‡à¦° à¦¸à§à¦Ÿà¦• à¦•à¦®à¦¾à¦¨à§‹
- à¦¨à¦¤à§à¦¨ à¦…à¦°à§à¦¡à¦¾à¦° à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾
- à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦ªà§à¦°à¦¸à§‡à¦¸ à¦•à¦°à¦¾

à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦–à¦¨ à¦†à¦®à¦°à¦¾ **rollback** à¦•à¦°à¦¬à§‹ à¦¯à¦¾à¦¤à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡ à¦•à§‹à¦¨à§‹ à¦…à¦¸à§à¦¬à¦¾à¦­à¦¾à¦¬à¦¿à¦• à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦¨à¦¾ à¦¹à§Ÿà¥¤

### Step 3: Rollback in Case of Failure
à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦à¦•à¦Ÿà¦¿ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ (à¦¯à§‡à¦®à¦¨ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿà§‡à¦° à¦¸à¦®à§Ÿ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à§Ÿ), à¦¤à¦–à¦¨ à¦†à¦®à¦°à¦¾ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ **abort** à¦•à¦°à§‡ à¦¸à¦®à¦¸à§à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ **rollback** à¦•à¦°à¦¬à§‹à¥¤

---

## â¸ï¸ 3. Code Implementation

### 3.1. Define Product, Order, and Payment Models

```js
const mongoose = require('mongoose');

// Product Model
const productSchema = new mongoose.Schema({
  name: String,
  price: Number,
  stock: Number,
});

const Product = mongoose.model('Product', productSchema);

// Order Model
const orderSchema = new mongoose.Schema({
  productId: mongoose.Schema.Types.ObjectId,
  quantity: Number,
  totalAmount: Number,
  status: String,
});

const Order = mongoose.model('Order', orderSchema);

// Payment Model
const paymentSchema = new mongoose.Schema({
  orderId: mongoose.Schema.Types.ObjectId,
  paymentStatus: String,
  paymentAmount: Number,
});

const Payment = mongoose.model('Payment', paymentSchema);
```

### 3.2. Checkout Logic with Transaction

```js
const checkout = async (userId, productId, quantity) => {
  const session = await mongoose.startSession();
  session.startTransaction();

  try {
    // Step 1: Check Product Availability
    const product = await Product.findById(productId).session(session);
    if (!product || product.stock < quantity) {
      throw new Error('Insufficient stock');
    }

    // Step 2: Create Order
    const totalAmount = product.price * quantity;
    const order = new Order({
      productId,
      quantity,
      totalAmount,
      status: 'pending',
    });
    await order.save({ session });

    // Step 3: Process Payment (Simulated)
    const paymentStatus = 'success'; // Simulate payment status
    if (paymentStatus !== 'success') {
      throw new Error('Payment failed');
    }

    // Step 4: Create Payment Record
    const payment = new Payment({
      orderId: order._id,
      paymentStatus,
      paymentAmount: totalAmount,
    });
    await payment.save({ session });

    // Step 5: Update Product Stock
    product.stock -= quantity;
    await product.save({ session });

    // Commit Transaction
    await session.commitTransaction();
    session.endSession();
    console.log('Checkout completed successfully');
  } catch (error) {
    // Rollback Transaction in case of failure
    await session.abortTransaction();
    session.endSession();
    console.error('Checkout failed:', error);
  }
};
```

### Explanation of Code:

1. **Session Start**: à¦†à¦®à¦°à¦¾ à¦ªà§à¦°à¦¥à¦®à§‡ à¦à¦•à¦Ÿà¦¿ session à¦¶à§à¦°à§ à¦•à¦°à¦¿ `mongoose.startSession()` à¦¦à¦¿à§Ÿà§‡, à¦¯à¦¾à¦¤à§‡ transaction à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿à¥¤
2. **Product Availability Check**: à¦ªà¦£à§à¦¯à§‡à¦° à¦¸à§à¦Ÿà¦• à¦¯à¦¾à¦šà¦¾à¦‡ à¦•à¦°à¦¾ à¦¹à§Ÿ, à¦¯à¦¦à¦¿ à¦ªà¦°à§à¦¯à¦¾à¦ªà§à¦¤ à¦¸à§à¦Ÿà¦• à¦¨à¦¾ à¦¥à¦¾à¦•à§‡, à¦¤à¦¾à¦¹à¦²à§‡ error throw à¦•à¦°à¦¾ à¦¹à§Ÿ à¦à¦¬à¦‚ transaction abort à¦¹à§Ÿà§‡ à¦¯à¦¾à¦¬à§‡à¥¤
3. **Order Creation**: à¦—à§à¦°à¦¾à¦¹à¦•à§‡à¦° à¦œà¦¨à§à¦¯ à¦à¦•à¦Ÿà¦¿ à¦¨à¦¤à§à¦¨ à¦…à¦°à§à¦¡à¦¾à¦° à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¹à§Ÿ à¦à¦¬à¦‚ à¦¸à§‡à¦Ÿà¦¿ **Order** à¦•à§‹à¦²à§‡à¦•à¦¶à¦¨à§‡ à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤
4. **Payment Processing**: à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦ªà§à¦°à¦¸à§‡à¦¸ à¦•à¦°à¦¾ à¦¹à§Ÿ, à¦à¦¬à¦‚ à¦¯à¦¦à¦¿ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ (à¦¯à§‡à¦®à¦¨ simulated payment failure), à¦¤à¦–à¦¨ transaction abort à¦¹à§Ÿà§‡ à¦¯à¦¾à¦¬à§‡à¥¤
5. **Product Stock Update**: à¦ªà¦£à§à¦¯à§‡à¦° à¦¸à§à¦Ÿà¦• à¦•à¦®à¦¾à¦¨à§‹ à¦¹à§Ÿ, à¦à¦Ÿà¦¿ à¦¶à§à¦§à§ à¦¤à¦–à¦¨à¦‡ à¦¹à¦¬à§‡ à¦¯à¦¦à¦¿ à¦¸à¦¬à¦•à¦¿à¦›à§ à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦¹à§Ÿà¥¤
6. **Commit or Rollback**: à¦¯à¦¦à¦¿ à¦¸à¦®à¦¸à§à¦¤ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¸à¦«à¦² à¦¹à§Ÿ, à¦†à¦®à¦°à¦¾ **commitTransaction()** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨ à¦•à¦®à¦¿à¦Ÿ à¦•à¦°à¦¿à¥¤ à¦¯à¦¦à¦¿ à¦•à§‹à¦¨à§‹ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à§Ÿ, à¦†à¦®à¦°à¦¾ **abortTransaction()** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à¦Ÿà¦¿ à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à¦¿ à¦à¦¬à¦‚ à¦¸à¦®à¦¸à§à¦¤ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦‰à¦²à§à¦Ÿà§‡ à¦¯à¦¾à¦¬à§‡à¥¤

---

## â¸ï¸ 4. Testing the Checkout Logic

à¦†à¦ªà¦¨à¦¾à¦° à¦•à§‹à¦¡ à¦¸à¦«à¦²à¦­à¦¾à¦¬à§‡ à¦•à¦¾à¦œ à¦•à¦°à¦¾à¦° à¦œà¦¨à§à¦¯, à¦†à¦ªà¦¨à¦¿ à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ à¦ªà¦°à¦¿à¦¸à§à¦¥à¦¿à¦¤à¦¿ à¦ªà¦°à§€à¦•à§à¦·à¦¾ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨:
1. **Insufficient stock**: à¦ªà¦£à§à¦¯à§‡à¦° à¦¸à§à¦Ÿà¦• à¦•à¦® à¦¥à¦¾à¦•à¦²à§‡ à¦…à¦°à§à¦¡à¦¾à¦° à¦¹à¦¬à§‡ à¦¨à¦¾ à¦à¦¬à¦‚ rollback à¦¹à¦¬à§‡à¥¤
2. **Payment failure**: à¦¯à¦¦à¦¿ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿ, à¦¤à¦¾à¦¹à¦²à§‡ à¦¸à¦®à¦¸à§à¦¤ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ rollback à¦¹à¦¬à§‡à¥¤
3. **Successful checkout**: à¦¸à¦¬à¦•à¦¿à¦›à§ à¦ à¦¿à¦•à¦ à¦¾à¦• à¦¥à¦¾à¦•à¦²à§‡, à¦…à¦°à§à¦¡à¦¾à¦° à¦¤à§ˆà¦°à¦¿ à¦¹à¦¬à§‡, à¦¸à§à¦Ÿà¦• à¦†à¦ªà¦¡à§‡à¦Ÿ à¦¹à¦¬à§‡ à¦à¦¬à¦‚ à¦ªà§‡à¦®à§‡à¦¨à§à¦Ÿ à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦¹à¦¬à§‡à¥¤

---

## ðŸ“Œ Summary:

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦ªà¦¨à¦¿ à¦¶à¦¿à¦–à¦²à§‡à¦¨ à¦•à¦¿à¦­à¦¾à¦¬à§‡ **E-commerce checkout logic** à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿ MongoDB **transaction** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡à¥¤ à¦à¦–à¦¾à¦¨à§‡ à¦†à¦®à¦°à¦¾ à¦¦à§‡à¦–à§‡à¦›à¦¿:
- à¦à¦•à¦¾à¦§à¦¿à¦• à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¯à§‡à¦®à¦¨ **order creation**, **inventory update**, à¦à¦¬à¦‚ **payment processing** à¦à¦•à¦¯à§‹à¦—à§‡ à¦¸à¦®à§à¦ªà¦¨à§à¦¨ à¦•à¦°à¦¤à§‡à¥¤
- **Rollback** à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦•à¦¾à¦œ à¦•à¦°à§‡ à¦¯à¦–à¦¨ à¦•à§‹à¦¨à§‹ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à§Ÿà¥¤
- à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦Ÿà§à¦°à¦¾à¦¨à¦œà§‡à¦•à¦¶à¦¨à§‡à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡à¦° integrity à¦°à¦•à§à¦·à¦¾ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤

à¦à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦¦à¦•à§à¦·à¦¤à¦¾, à¦¬à¦¿à¦¶à§‡à¦· à¦•à¦°à§‡ à¦¯à¦–à¦¨ à¦†à¦ªà¦¨à¦¿ à¦¬à§œ E-commerce à¦¸à¦¿à¦¸à§à¦Ÿà§‡à¦® à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§‡à¦¨, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦…à¦ªà¦¾à¦°à§‡à¦¶à¦¨ à¦à¦•à¦¯à§‹à¦—à§‡ à¦ªà¦°à¦¿à¦šà¦¾à¦²à¦¨à¦¾ à¦•à¦°à¦¤à§‡ à¦¹à§Ÿà¥¤ ðŸš€



# Day 56

âœ… **à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿: Caching**

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à§‡ à¦†à¦®à¦°à¦¾ **Caching** à¦¨à¦¿à§Ÿà§‡ à¦•à¦¾à¦œ à¦•à¦°à¦¬à§‹à¥¤ Caching à¦¹à¦² à¦à¦•à¦Ÿà¦¿ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦•à§Œà¦¶à¦² à¦¯à¦¾ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸, à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨, à¦à¦¬à¦‚ API à¦ªà¦¾à¦°à¦«à¦°à¦®à§à¦¯à¦¾à¦¨à§à¦¸ à¦‰à¦¨à§à¦¨à¦¤ à¦•à¦°à¦¤à§‡ à¦¸à¦¾à¦¹à¦¾à¦¯à§à¦¯ à¦•à¦°à§‡à¥¤ à¦à¦¤à§‡ à¦•à¦°à¦¾ à¦¹à§Ÿ à¦¨à¦¿à¦°à§à¦¦à¦¿à¦·à§à¦Ÿ à¦¡à§‡à¦Ÿà¦¾ à¦ªà§à¦¨à¦°à¦¾à§Ÿ à¦¬à¦¾à¦°à¦¬à¦¾à¦° à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¬à¦¾ à¦…à¦¨à§à¦¯ à¦‰à§Žà¦¸ à¦¥à§‡à¦•à§‡ à¦°à¦¿à¦Ÿà§à¦°à¦¿à¦­ à¦•à¦°à¦¾à¦° à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à§‡ à¦¤à¦¾ à¦à¦• à¦œà¦¾à§Ÿà¦—à¦¾à§Ÿ à¦¸à¦žà§à¦šà§Ÿ à¦•à¦°à¦¾, à¦¯à¦¾à¦¤à§‡ à¦ªà¦°à¦¬à¦°à§à¦¤à§€à¦¤à§‡ à¦¦à§à¦°à§à¦¤ à¦…à§à¦¯à¦¾à¦•à§à¦¸à§‡à¦¸ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤

Caching à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡, à¦†à¦®à¦°à¦¾ à¦¬à¦¾à¦°à¦¬à¦¾à¦° à¦à¦•à¦‡ à¦¡à§‡à¦Ÿà¦¾ à¦ªà§à¦¨à¦°à§à¦¦à§à¦§à¦¾à¦°à§‡à¦° à¦¸à¦®à§Ÿà§‡à¦° à¦œà¦¨à§à¦¯ à¦¬à§à¦¯à§Ÿ à¦•à¦®à¦¾à¦¤à§‡ à¦ªà¦¾à¦°à¦¿ à¦à¦¬à¦‚ à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨à§‡à¦° à¦ªà¦¾à¦°à¦«à¦°à¦®à§à¦¯à¦¾à¦¨à§à¦¸ à¦…à¦¨à§‡à¦• à¦¦à§à¦°à§à¦¤ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿à¥¤

---

## â¸ï¸ 1. What is Caching?

**Caching** à¦¹à¦² à¦à¦•à¦Ÿà¦¿ à¦ªà¦¦à§à¦§à¦¤à¦¿ à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦•à¦®à§à¦ªà¦¿à¦‰à¦Ÿà¦¿à¦‚ à¦°à¦¿à¦¸à§‹à¦°à§à¦¸ (à¦¯à§‡à¦®à¦¨ à¦¡à§‡à¦Ÿà¦¾à¦¬à§‡à¦¸) à¦¥à§‡à¦•à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦¬à¦¾à¦°à¦¬à¦¾à¦° à¦¬à§‡à¦° à¦•à¦°à¦¾à¦° à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à§‡ à¦¤à¦¾ à¦•à¦¿à¦›à§ à¦¸à¦®à§Ÿà§‡à¦° à¦œà¦¨à§à¦¯ **temporary storage** à¦¬à¦¾ **cache**-à¦ à¦°à¦¾à¦–à¦¾à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦ªà¦¾à¦°à¦«à¦°à¦®à§à¦¯à¦¾à¦¨à§à¦¸ à¦‰à¦¨à§à¦¨à¦¤ à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤ 

Caching à¦¸à¦¾à¦§à¦¾à¦°à¦£à¦¤ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦¹à§Ÿ:
- API à¦¬à¦¾ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¥à§‡à¦•à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦ªà§à¦°à¦¾à¦ªà§à¦¤à¦¿à¦° à¦¸à¦®à§Ÿ à¦–à¦°à¦š à¦•à¦®à¦¾à¦¨à§‹à¦° à¦œà¦¨à§à¦¯à¥¤
- à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à¦•à¦¾à¦°à§€à¦° à¦œà¦¨à§à¦¯ à¦¦à§à¦°à§à¦¤à¦¤à¦° à¦…à¦­à¦¿à¦œà§à¦žà¦¤à¦¾ à¦¤à§ˆà¦°à¦¿à¦° à¦œà¦¨à§à¦¯à¥¤

---

## â¸ï¸ 2. Types of Caching

### 2.1. **In-memory Caching**
- à¦à¦Ÿà¦¿ à¦à¦•à¦§à¦°à¦¨à§‡à¦° **volatile memory** caching, à¦¯à§‡à¦–à¦¾à¦¨à§‡ à¦¡à§‡à¦Ÿà¦¾ RAM-à¦ à¦¸à¦žà§à¦šà¦¿à¦¤ à¦¹à§Ÿà¥¤
- à¦à¦Ÿà¦¿ à¦…à¦¨à§‡à¦• à¦¦à§à¦°à§à¦¤, à¦¤à¦¬à§‡ **server restart** à¦¹à¦²à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦¹à¦¾à¦°à¦¿à§Ÿà§‡ à¦¯à¦¾à§Ÿà¥¤

### 2.2. **Persistent Caching**
- à¦à¦–à¦¾à¦¨à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦¸à§à¦Ÿà§‹à¦°à§‡à¦œ à¦¡à¦¿à¦­à¦¾à¦‡à¦¸ à¦¬à¦¾ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡ à¦¸à¦žà§à¦šà¦¿à¦¤ à¦¥à¦¾à¦•à§‡à¥¤
- à¦à¦‡ à¦§à¦°à¦¨à§‡à¦° à¦•à§à¦¯à¦¾à¦¶à¦¿à¦‚ à¦¦à§€à¦°à§à¦˜à¦¸à§à¦¥à¦¾à§Ÿà§€, à¦à¦¬à¦‚ à¦¡à§‡à¦Ÿà¦¾ **server restart** à¦¹à¦“à§Ÿà¦¾à¦° à¦ªà¦°à¦“ à¦…à¦Ÿà§‹à¦®à§‡à¦Ÿà¦¿à¦•à§à¦¯à¦¾à¦²à¦¿ à¦°à¦¿à¦¸à§à¦Ÿà§‹à¦° à¦¹à§Ÿà¥¤

---

## â¸ï¸ 3. Popular Caching Strategies

### 3.1. **Cache Aside**
- à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨ à¦ªà§à¦°à¦¥à¦®à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦•à§à¦¯à¦¾à¦¶à§‡ à¦°à§‡à¦–à§‡, à¦¤à¦¾à¦°à¦ªà¦° à¦¸à§‡à¦Ÿà¦¿ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¥à§‡à¦•à§‡ à¦°à¦¿à¦Ÿà§à¦°à¦¿à¦­ à¦•à¦°à§‡à¥¤
- à¦à¦•à¦¬à¦¾à¦° à¦¡à§‡à¦Ÿà¦¾ à¦•à§à¦¯à¦¾à¦¶à§‡ à¦šà¦²à§‡ à¦†à¦¸à¦²à§‡, à¦ªà¦°à¦¬à¦°à§à¦¤à§€ à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿ à¦¸à¦°à¦¾à¦¸à¦°à¦¿ à¦•à§à¦¯à¦¾à¦¶ à¦¥à§‡à¦•à§‡ à¦†à¦¸à§‡à¥¤
- **Pros**: à¦…à¦§à¦¿à¦• à¦•à¦¨à§à¦Ÿà§à¦°à§‹à¦², à¦ªà§à¦°à§Ÿà§‹à¦œà¦¨ à¦…à¦¨à§à¦¯à¦¾à§Ÿà§€ à¦•à§à¦¯à¦¾à¦¶ à¦•à¦°à¦¾ à¦¯à¦¾à§Ÿà¥¤
- **Cons**: à¦•à§à¦¯à¦¾à¦¶à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦¸à¦ à¦¿à¦• à¦¥à¦¾à¦•à¦¤à§‡ à¦¹à¦¬à§‡, à¦à¦¬à¦‚ cache miss à¦¹à¦²à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¥à§‡à¦•à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦¨à¦¿à§Ÿà§‡ à¦†à¦¸à¦¾ à¦¸à¦®à§Ÿà¦¸à¦¾à¦ªà§‡à¦•à§à¦· à¦¹à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¥¤

### 3.2. **Read-through Cache**
- à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨ à¦¯à¦–à¦¨ à¦¡à§‡à¦Ÿà¦¾ à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿ à¦•à¦°à§‡, à¦•à§à¦¯à¦¾à¦¶ à¦ªà§à¦°à¦¥à¦®à§‡ à¦šà§‡à¦• à¦•à¦°à§‡, à¦¯à¦¦à¦¿ à¦¡à§‡à¦Ÿà¦¾ à¦¨à¦¾ à¦¥à¦¾à¦•à§‡, à¦¤à¦¾à¦¹à¦²à§‡ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¥à§‡à¦•à§‡ à¦à¦¨à§‡ à¦•à§à¦¯à¦¾à¦¶à§‡ à¦°à¦¾à¦–à§‡à¥¤
- **Pros**: à¦•à§à¦¯à¦¾à¦¶ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à¦¾à¦° à¦à¦¾à¦®à§‡à¦²à¦¾ à¦•à¦®à¥¤
- **Cons**: à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨ à¦•à¦¨à¦«à¦¿à¦—à¦¾à¦° à¦•à¦°à¦¾ à¦•à¦ à¦¿à¦¨ à¦¹à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¥¤

### 3.3. **Write-through Cache**
- à¦¯à¦–à¦¨ à¦¡à§‡à¦Ÿà¦¾ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸à§‡ à¦²à§‡à¦–à¦¾ à¦¹à§Ÿ, à¦¤à¦–à¦¨ à¦¸à§‡à¦Ÿà¦¾ à¦•à§à¦¯à¦¾à¦¶à§‡à¦“ à¦²à§‡à¦–à¦¾ à¦¹à§Ÿà¥¤
- **Pros**: à¦•à§à¦¯à¦¾à¦¶ à¦à¦¬à¦‚ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¦à§à¦Ÿà¦¿ à¦à¦•à¦‡ à¦¡à§‡à¦Ÿà¦¾ à¦§à¦¾à¦°à¦£ à¦•à¦°à§‡à¥¤
- **Cons**: à¦¡à§‡à¦Ÿà¦¾ à¦†à¦ªà¦¡à§‡à¦Ÿà§‡à¦° à¦¸à¦®à§Ÿ à¦¬à§‡à¦¶à¦¿ à¦¸à¦®à§Ÿ à¦²à¦¾à¦—à§‡à¥¤

---

## â¸ï¸ 4. Implementing Caching in Express.js

à¦à¦–à¦¨ à¦†à¦®à¦°à¦¾ **Express.js** à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨à§‡ à¦•à§à¦¯à¦¾à¦¶à¦¿à¦‚ à¦•à¦¿à¦­à¦¾à¦¬à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¿, à¦¸à§‡à¦Ÿà¦¿ à¦¦à§‡à¦–à¦¬à¥¤

### 4.1. Use `redis` for Caching

à¦†à¦®à¦°à¦¾ à¦à¦–à¦¾à¦¨à§‡ **Redis** à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¬à§‹, à¦¯à¦¾ à¦à¦•à¦Ÿà¦¿ à¦œà¦¨à¦ªà§à¦°à¦¿à§Ÿ **in-memory caching** à¦¸à¦¿à¦¸à§à¦Ÿà§‡à¦®à¥¤ Redis à¦–à§à¦¬ à¦¦à§à¦°à§à¦¤ à¦•à¦¾à¦œ à¦•à¦°à§‡ à¦à¦¬à¦‚ à¦¸à¦¾à¦§à¦¾à¦°à¦£à¦¤ **key-value store** à¦¹à¦¿à¦¸à§‡à¦¬à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾ à¦¹à§Ÿà¥¤

#### Install Redis:

```bash
npm install redis
```

#### Setting Up Redis Cache:

```js
const redis = require('redis');
const client = redis.createClient(); // Create Redis client

client.on('connect', () => {
  console.log('Connected to Redis');
});

// Set data in cache
client.set('user:123', JSON.stringify({ name: 'John', age: 30 }));

// Get data from cache
client.get('user:123', (err, data) => {
  if (err) throw err;
  console.log('Data from cache:', JSON.parse(data));
});
```

### 4.2. Cache API Response in Express

```js
const express = require('express');
const redis = require('redis');
const client = redis.createClient();
const app = express();

client.on('connect', () => {
  console.log('Connected to Redis');
});

app.get('/api/products', (req, res) => {
  const cacheKey = 'products';
  
  // Check if data is in cache
  client.get(cacheKey, (err, data) => {
    if (data) {
      console.log('Data from cache');
      return res.json(JSON.parse(data));
    }

    // Fetch data from DB if not in cache
    // Simulating fetching from database
    const products = [
      { id: 1, name: 'Product A' },
      { id: 2, name: 'Product B' },
    ];

    // Set data in cache with an expiry time of 1 hour
    client.setex(cacheKey, 3600, JSON.stringify(products));

    console.log('Data from database');
    return res.json(products);
  });
});

app.listen(3000, () => {
  console.log('Server running on port 3000');
});
```

### Explanation:
1. **Redis Client**: à¦†à¦®à¦°à¦¾ Redis client à¦¸à§‡à¦Ÿ à¦†à¦ª à¦•à¦°à§‡à¦›à¦¿ à¦à¦¬à¦‚ Express.js à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à§‡à¦›à¦¿à¥¤
2. **Check Cache**: API à¦°à¦¿à¦•à§‹à§Ÿà§‡à¦¸à§à¦Ÿà§‡à¦° à¦†à¦—à§‡à¦‡ à¦†à¦®à¦°à¦¾ Redis cache à¦šà§‡à¦• à¦•à¦°à¦¿à¥¤ à¦¯à¦¦à¦¿ à¦¡à§‡à¦Ÿà¦¾ à¦¥à¦¾à¦•à§‡, à¦¤à¦–à¦¨ à¦¤à¦¾ à¦¸à¦°à¦¾à¦¸à¦°à¦¿ à¦°à¦¿à¦Ÿà¦¾à¦°à§à¦¨ à¦•à¦°à¦¿à¥¤
3. **Database Fallback**: à¦¯à¦¦à¦¿ cache à¦¨à¦¾ à¦¥à¦¾à¦•à§‡, à¦¤à¦–à¦¨ à¦†à¦®à¦°à¦¾ à¦¡à¦¾à¦Ÿà¦¾à¦¬à§‡à¦¸ à¦¥à§‡à¦•à§‡ à¦¡à§‡à¦Ÿà¦¾ à¦«à§‡à¦š à¦•à¦°à¦¿ à¦à¦¬à¦‚ à¦¤à¦¾ Redis cache-à¦ à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦•à¦°à¦¿à¥¤

---

## â¸ï¸ 5. Cache Expiry

Redis à¦•à§à¦¯à¦¾à¦¶à§‡ à¦¥à¦¾à¦•à¦¾ à¦¡à§‡à¦Ÿà¦¾à¦° à¦œà¦¨à§à¦¯ à¦†à¦ªà¦¨à¦¿ **expiry time** à¦¸à§‡à¦Ÿ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨, à¦¯à¦¾ à¦•à§à¦¯à¦¾à¦¶à§‡ à¦¥à¦¾à¦•à¦¾ à¦¡à§‡à¦Ÿà¦¾ à¦¨à¦¿à¦°à§à¦¦à¦¿à¦·à§à¦Ÿ à¦¸à¦®à§Ÿ à¦ªà¦° à¦®à§à¦›à§‡ à¦«à§‡à¦²à¦¬à§‡à¥¤

```js
client.setex('user:123', 3600, JSON.stringify({ name: 'John', age: 30 }));
```
à¦à¦–à¦¾à¦¨à§‡, `3600` à¦¸à§‡à¦•à§‡à¦¨à§à¦¡à§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦•à§à¦¯à¦¾à¦¶à§‡à¦° à¦¡à§‡à¦Ÿà¦¾ à¦®à§à¦›à§‡ à¦¯à¦¾à¦¬à§‡à¥¤

---

## â¸ï¸ 6. Cache Invalidation

à¦•à§à¦¯à¦¾à¦¶ à¦‡à¦¨à¦­à§à¦¯à¦¾à¦²à¦¿à¦¡à§‡à¦¶à¦¨ à¦¬à¦¾ à¦•à§à¦¯à¦¾à¦¶à§‡à¦° à¦¡à§‡à¦Ÿà¦¾ à¦–à¦¾à¦²à¦¿ à¦•à¦°à¦¾ à¦…à¦¨à§‡à¦• à¦¸à¦®à§Ÿ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦¹à§Ÿà§‡ à¦ªà§œà§‡ à¦¯à¦–à¦¨ à¦¡à§‡à¦Ÿà¦¾ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦¹à§Ÿà¥¤ Redis-à¦ à¦•à§à¦¯à¦¾à¦¶ à¦®à§à¦›à§‡ à¦«à§‡à¦²à¦¾à¦° à¦œà¦¨à§à¦¯ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨:

```js
client.del('user:123'); // Remove data from cache
```

---

## ðŸ“Œ Summary:

à¦†à¦œà¦•à§‡à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿ à¦›à¦¿à¦² **Caching** à¦¨à¦¿à§Ÿà§‡ à¦•à¦¾à¦œ à¦•à¦°à¦¾à¦° à¦¦à¦¿à¦¨à¥¤ Caching à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¾à¦° à¦®à¦¾à¦§à§à¦¯à¦®à§‡ à¦†à¦ªà¦¨à¦¿ à¦†à¦ªà¦¨à¦¾à¦° à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨à§‡à¦° à¦ªà¦¾à¦°à¦«à¦°à¦®à§à¦¯à¦¾à¦¨à§à¦¸ à¦‰à¦¨à§à¦¨à¦¤ à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à¦¬à§‡à¦¨à¥¤ **Redis** à¦¹à¦²à§‹ à¦à¦•à¦Ÿà¦¿ à¦œà¦¨à¦ªà§à¦°à¦¿à§Ÿ **in-memory caching** à¦Ÿà§à¦² à¦¯à¦¾ à¦†à¦ªà¦¨à¦¿ Express.js à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨à§‡ à¦¸à¦¹à¦œà§‡à¦‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦° à¦•à¦°à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨à¥¤

Caching à¦¸à¦¿à¦¸à§à¦Ÿà§‡à¦®à§‡à¦° à¦®à¦§à§à¦¯à§‡ **cache miss** à¦à¦¬à¦‚ **cache hit** à¦¬à§à¦à§‡ à¦•à¦¾à¦œ à¦•à¦°à¦¾ à¦…à¦¤à§à¦¯à¦¨à§à¦¤ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£, à¦à¦¬à¦‚ à¦•à§à¦¯à¦¾à¦¶à§‡à¦° à¦¡à§‡à¦Ÿà¦¾ à¦¸à¦ à¦¿à¦• à¦“ à¦¸à¦™à§à¦—à¦¤à¦¿à¦ªà§‚à¦°à§à¦£ à¦°à¦¾à¦–à¦¤à§‡ **cache invalidation** à¦¸à¦ à¦¿à¦•à¦­à¦¾à¦¬à§‡ à¦¬à§à¦¯à¦¬à¦¹à¦¾à¦°à§‡à¦° à¦‰à¦ªà¦° à¦—à§à¦°à§à¦¤à§à¦¬ à¦¦à§‡à¦“à§Ÿà¦¾ à¦‰à¦šà¦¿à¦¤à¥¤

à¦à¦Ÿà¦¿ à¦à¦•à¦Ÿà¦¿ à¦—à§à¦°à§à¦¤à§à¦¬à¦ªà§‚à¦°à§à¦£ à¦¦à¦•à§à¦·à¦¤à¦¾, à¦¬à¦¿à¦¶à§‡à¦· à¦•à¦°à§‡ à¦¯à¦–à¦¨ à¦†à¦ªà¦¨à¦¿ **high-performance** à¦…à§à¦¯à¦¾à¦ªà§à¦²à¦¿à¦•à§‡à¦¶à¦¨ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§‡à¦¨à¥¤ ðŸš€





