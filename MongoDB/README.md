# ЁЯУШ Introduction to MongoDB and Mongoose

## ЁЯЯв MongoDB

**MongoDB** is a **NoSQL, open-source, cross-platform, document-oriented database system**. 
It is designed to store, query, and process large volumes of semi-structured data using a flexible and scalable architecture.

### ЁЯз▒ Core Concepts
- MongoDB stores data as **documents**, which are key-value pairs in a format similar to JSON (called **BSON** - Binary JSON).
- A **document** is the basic unit of data in MongoDB, and documents are grouped into **collections**.
- Collections are analogous to tables in relational databases, while documents are like rows.

### тЬи Key Features:
- **Document-based:** Stores data in flexible, JSON-like documents, making it easy to evolve schemas over time.
- **Schema-less:** Each document in a collection can have a different structure. Great for agile and rapid development.
- **Scalable:** MongoDB supports **horizontal scaling** through **sharding**, allowing it to handle huge amounts of data.
- **High Performance:** Optimized for speed and capable of handling a large number of read/write operations.
- **Replication:** Built-in support for **replica sets** ensures high availability and automatic failover.
- **Indexing:** Supports various types of indexes for faster query performance (single field, compound, text, geospatial, etc.).
- **Aggregation Framework:** A powerful pipeline-based system for transforming and analyzing data.
- **ACID Transactions:** From version 4.0+, MongoDB supports multi-document ACID transactions.

### ЁЯУж Basic Terminology:
- **Database:** Container for collections.
- **Collection:** A group of MongoDB documents, similar to a table in SQL.
- **Document:** A record in MongoDB, represented as a BSON object (similar to JSON).
- **Field:** A key-value pair in a document.
- **Index:** A performance optimization to speed up query performance.

### ЁЯФН Example MongoDB Document:
```json
{
  "_id": ObjectId("661d1c09f456789abc123456"),
  "name": "Alice Johnson",
  "email": "alice@example.com",
  "age": 28,
  "skills": ["JavaScript", "MongoDB", "Node.js"],
  "isActive": true,
  "createdAt": ISODate("2025-04-16T10:15:00Z")
}
```

## ЁЯФЧ Mongoose

**Mongoose** is a popular **Object Data Modeling (ODM) library for MongoDB and Node.js**.
It provides a layer of abstraction over MongoDBтАЩs native driver to help developers define models using schemas, enforce structure and validation, and write cleaner, more maintainable code.

### ЁЯУМ Why Use Mongoose?
- Adds **schema and structure** to MongoDBтАЩs flexible documents.
- Provides **data validation** at the schema level.
- Simplifies **CRUD (Create, Read, Update, Delete)** operations using methods like `.save()`, `.find()`, `.findById()`, etc.
- Offers powerful **middleware hooks** (e.g., pre-save, post-delete) to run logic at various stages.
- Built-in support for **population** (replacing referenced IDs with full documents).
- Easy integration with Express.js for backend APIs.

### ЁЯЫа Schema Definition Example:
```js
const mongoose = require('mongoose');

const userSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true,
    trim: true
  },
  email: {
    type: String,
    required: true,
    unique: true,
    lowercase: true
  },
  age: {
    type: Number,
    min: 0
  },
  isActive: {
    type: Boolean,
    default: true
  },
  createdAt: {
    type: Date,
    default: Date.now
  }
});

const User = mongoose.model('User', userSchema);
module.exports = User;
```

### ЁЯФД Connecting to MongoDB:
```js
const mongoose = require('mongoose');

mongoose.connect('mongodb://localhost:27017/myapp', {
  useNewUrlParser: true,
  useUnifiedTopology: true
}).then(() => {
  console.log("Connected to MongoDB successfully!");
}).catch((err) => {
  console.error("MongoDB connection error:", err);
});
```

### тЪЩя╕П Common Mongoose Operations:
- **Create a new document:**
```js
const user = new User({ name: "John", email: "john@example.com" });
await user.save();
```
- **Find documents:**
```js
const users = await User.find({ isActive: true });
```
- **Update a document:**
```js
await User.updateOne({ _id: userId }, { $set: { age: 29 } });
```
- **Delete a document:**
```js
await User.deleteOne({ _id: userId });
```

### ЁЯФЧ References:
- [MongoDB Official Website](https://www.mongodb.com/)
- [Mongoose Documentation](https://mongoosejs.com/)



# тЪЩя╕П Mac ржПржмржВ Linux-ржП MongoDB Compass ржПржмржВ NoSQLBooster ржЗржирж╕рзНржЯрж▓рзЗрж╢ржи ржЧрж╛ржЗржб (ржмрж╛ржВрж▓рж╛)

## ЁЯзн MongoDB Compass ржЗржирж╕рзНржЯрж▓рзЗрж╢ржи (Mac & Linux)

### ЁЯНО MacOS ржПрж░ ржЬржирзНржп:
1я╕ПтГг [https://www.mongodb.com/try/download/compass](https://www.mongodb.com/try/download/compass) ржПржЗ рж▓рж┐ржВржХрзЗ ржпрж╛ржиред
2я╕ПтГг ржЖржкржирж╛рж░ ржЕржкрж╛рж░рзЗржЯрж┐ржВ рж╕рж┐рж╕рзНржЯрзЗржо рж╣рж┐рж╕рзЗржмрзЗ **macOS** рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рзБржиред
3я╕ПтГг Edition рж╣рж┐рж╕рзЗржмрзЗ "Stable" рж░рж╛ржЦрзБржиред
4я╕ПтГг `.dmg` ржлрж╛ржЗрж▓ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзБржи ржПржмржВ ржбрж╛ржмрж▓ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЗржирж╕рзНржЯрж▓ ржХрж░рзБржиред
5я╕ПтГг ржЕрзНржпрж╛ржкрж╕ ржлрзЛрж▓рзНржбрж╛рж░ ржерзЗржХрзЗ **MongoDB Compass** ржУржкрзЗржи ржХрж░рзБржиред

### ЁЯРз Linux (Ubuntu/Debian) ржПрж░ ржЬржирзНржп:
1я╕ПтГг ржЯрж╛рж░рзНржорж┐ржирж╛рж▓рзЗ ржирж┐ржЪрзЗрж░ ржХржорж╛ржирзНржбржЯрж┐ рж▓рж┐ржЦрзЗ .deb ржлрж╛ржЗрж▓ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзБржи:
```bash
wget https://downloads.mongodb.com/compass/mongodb-compass_*.deb
```
2я╕ПтГг рждрж╛рж░ржкрж░ ржЗржирж╕рзНржЯрж▓ ржХрж░рзБржи:
```bash
sudo dpkg -i mongodb-compass_*.deb
sudo apt-get install -f  # ржкрзНрж░рзЯрзЛржЬржи рж╣рж▓рзЗ dependencies ржлрж┐ржХрзНрж╕ ржХрж░рждрзЗ
```
3я╕ПтГг ржПрж░ржкрж░ ржЕрзНржпрж╛ржк ржбрзНржпрж╛рж╢ржмрзЛрж░рзНржб ржерзЗржХрзЗ **Compass** рж╕рж╛рж░рзНржЪ ржХрж░рзЗ ржЪрж╛рж▓рзБ ржХрж░рзБржиред

## ЁЯЪА NoSQLBooster ржЗржирж╕рзНржЯрж▓рзЗрж╢ржи (Mac & Linux)

### ЁЯНО MacOS ржПрж░ ржЬржирзНржп:
1я╕ПтГг [https://nosqlbooster.com/downloads](https://nosqlbooster.com/downloads) рж▓рж┐ржВржХрзЗ ржпрж╛ржиред
2я╕ПтГг macOS ржПрж░ ржЬржирзНржп `.dmg` ржлрж╛ржЗрж▓ржЯрж┐ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзБржиред
3я╕ПтГг ржбрж╛ржмрж▓ ржХрзНрж▓рж┐ржХ ржХрж░рзЗ ржЗржирж╕рзНржЯрж▓ ржХрж░рзБржи ржПржмржВ Applications ржлрзЛрж▓рзНржбрж╛рж░рзЗ ржбрзНрж░рзНржпрж╛ржЧ ржХрж░рзЗ рж░рж╛ржЦрзБржиред
4я╕ПтГг ржПрж░ржкрж░ NoSQLBooster ржЕрзНржпрж╛ржкржЯрж┐ ржЪрж╛рж▓рзБ ржХрж░рзБржиред

### ЁЯРз Linux (Ubuntu/Debian) ржПрж░ ржЬржирзНржп:
1я╕ПтГг `.deb` ржлрж╛ржЗрж▓ржЯрж┐ ржбрж╛ржЙржирж▓рзЛржб ржХрж░рзБржи [https://nosqlbooster.com/downloads](https://nosqlbooster.com/downloads) ржерзЗржХрзЗред
2я╕ПтГг ржЯрж╛рж░рзНржорж┐ржирж╛рж▓рзЗ ржПржЗ ржХржорж╛ржирзНржб ржжрж┐ржи:
```bash
sudo dpkg -i nosqlbooster4mongo-*.deb
sudo apt-get install -f
```
3я╕ПтГг ржЗржирж╕рзНржЯрж▓рзЗрж╢ржи рж╢рзЗрж╖ рж╣рж▓рзЗ, Dash ржорзЗржирзБрждрзЗ ржЧрж┐рзЯрзЗ тАЬNoSQLBoosterтАЭ рж▓рж┐ржЦрзЗ ржУржкрзЗржи ржХрж░рзБржиред

тЬЕ ржПржЦржи ржЖржкржирж┐ ржжрзБржЗржЯрж┐ ржЯрзБрж▓ ржжрж┐рзЯрзЗржЗ MongoDB ржбрж╛ржЯрж╛ржмрзЗрж╕ ржмрзНрж░рж╛ржЙржЬ, ржХрзБрзЯрзЗрж░рж┐ ржПржмржВ ржоржбрзЗрж▓ ржорзНржпрж╛ржирзЗржЬ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи!

---
тД╣я╕П **ржЯрж┐ржкрж╕:** MongoDB Compass ржбрж╛ржЯрж╛ ржмрзНрж░рж╛ржЙржЬ ржХрж░рж╛рж░ ржЬржирзНржп ржнрж┐ржЬрзНржпрзБрзЯрж╛рж▓ ржЯрзБрж▓ ржПржмржВ NoSQLBooster ржЙржирзНржиржд ржХрзБрзЯрзЗрж░рж┐, рж╕рзНржХрзНрж░рж┐ржкрзНржЯрж┐ржВ ржПржмржВ MongoDB shell ржкрж░рж┐ржЪрж╛рж▓ржирж╛рж░ ржЬржирзНржп ржкрж╛рж░ржлрзЗржХрзНржЯред



# ЁЯЪА Express.js ржжрж┐рзЯрзЗ MongoDB Function API ржЙржжрж╛рж╣рж░ржг

## ЁЯФЧ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзЗржЯржЖржк:
```js
const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

const userSchema = new mongoose.Schema({
  name: String,
  age: Number,
  city: String,
  job: String
});

const User = mongoose.model('User', userSchema);
```

## ЁЯЯв insertOne - POST API
```js
app.post('/add-user', async (req, res) => {
  const newUser = new User(req.body);
  const savedUser = await newUser.save();
  res.json(savedUser);
});
```

## ЁЯЯв insertMany - POST API
```js
app.post('/add-multiple-users', async (req, res) => {
  const users = await User.insertMany(req.body);
  res.json(users);
});
```

## ЁЯФН find - GET API (рж╕ржХрж▓ ржЗржЙржЬрж╛рж░)
```js
app.get('/users', async (req, res) => {
  const users = await User.find(); // рж╕ржм ржЗржЙржЬрж╛рж░
  res.json(users);
});
```

## ЁЯФН findOne - GET API (ржирж╛ржо ржжрж┐рзЯрзЗ ржЦрзЛржБржЬрж╛)
```js
app.get('/user/:name', async (req, res) => {
  const user = await User.findOne({ name: req.params.name });
  res.json(user);
});
```

## ЁЯОп Field Filtering / Projection - GET API
```js
app.get('/users/projection', async (req, res) => {
  const filtered = await User.find({}, { name: 1, city: 1, _id: 0 });
  res.json(filtered);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе ржПржЗ рж░рж╛ржЙржЯржЧрзБрж▓рзЛ рж╕рж░рж╛рж╕рж░рж┐ Postman, Insomnia, ржмрж╛ React/Frontend ржерзЗржХрзЗ рж╣рж┐ржЯ ржХрж░рзЗ MongoDB рждрзЗ ржбрзЗржЯрж╛ Create, Read ржПржмржВ Filter ржХрж░рж╛ ржпрж╛рзЯред

тЬЕ ржЪрж╛ржЗрж▓рзЗ ржкрж░ржмрж░рзНрждрзА ржзрж╛ржкрзЗ `update`, `delete`, `query with params`, ржмрж╛ `pagination` ржжрж┐рзЯрзЗржУ ржЖржорж┐ ржПржЗ ржлрж╛ржВрж╢ржиржЧрзБрж▓рзЛржХрзЗ ржмрж╛рзЬрж╛рждрзЗ ржкрж╛рж░рж┐ред



# ЁЯФН MongoDB ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░: $eq, $neq, $gt, $lt, $gte, $lte - Express.js ржЙржжрж╛рж╣рж░ржг

## ЁЯФЧ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзЗржЯржЖржк:
```js
const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

const userSchema = new mongoose.Schema({
  name: String,
  age: Number,
  city: String,
  job: String
});

const User = mongoose.model('User', userSchema);
```

## ЁЯЯв $eq (ржЗржХрзНржпрзБрзЯрж╛рж▓) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛ ржарж┐ржХ ржорзЗрж▓рж╛ржирзЛ ржкрзНрж░рзЯрзЛржЬржиред 
```js
app.get('/users/equal', async (req, res) => {
  const users = await User.find({ age: { $eq: 30 } }); // age 30
  res.json(users);
});
```

## ЁЯЯв $neq (ржиржЯ ржЗржХрзНржпрзБрзЯрж╛рж▓) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛ ржорзЗрж▓рж╛ржирзЛ ржпрж╛ржмрзЗ ржирж╛ ржПржоржи рж╢рж░рзНржд ржжрж┐рждрзЗ рж╣рзЯред
```js
app.get('/users/neq', async (req, res) => {
  const users = await User.find({ age: { $neq: 30 } }); // age is not 30
  res.json(users);
});
```

## ЁЯЯв $gt (ржЧрзНрж░рзЗржЯрж╛рж░ ржжрзНржпрж╛ржи) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛рж░ ржорж╛ржи ржмрзЬ рж╣рждрзЗ рж╣ржмрзЗред
```js
app.get('/users/gt', async (req, res) => {
  const users = await User.find({ age: { $gt: 25 } }); // age greater than 25
  res.json(users);
});
```

## ЁЯЯв $lt (рж▓рзЗрж╕ ржжрзНржпрж╛ржи) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛рж░ ржорж╛ржи ржЫрзЛржЯ рж╣рждрзЗ рж╣ржмрзЗред
```js
app.get('/users/lt', async (req, res) => {
  const users = await User.find({ age: { $lt: 30 } }); // age less than 30
  res.json(users);
});
```

## ЁЯЯв $gte (ржЧрзНрж░рзЗржЯрж╛рж░ ржжрзНржпрж╛ржи ржЕрж░ ржЗржХрзНржпрзБрзЯрж╛рж▓) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛рж░ ржорж╛ржи ржмрзЬ ржмрж╛ рж╕ржорж╛ржи рж╣рждрзЗ рж╣ржмрзЗред
```js
app.get('/users/gte', async (req, res) => {
  const users = await User.find({ age: { $gte: 25 } }); // age greater than or equal to 25
  res.json(users);
});
```

## ЁЯЯв $lte (рж▓рзЗрж╕ ржжрзНржпрж╛ржи ржЕрж░ ржЗржХрзНржпрзБрзЯрж╛рж▓) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛рж░ ржорж╛ржи ржЫрзЛржЯ ржмрж╛ рж╕ржорж╛ржи рж╣рждрзЗ рж╣ржмрзЗред
```js
app.get('/users/lte', async (req, res) => {
  const users = await User.find({ age: { $lte: 30 } }); // age less than or equal to 30
  res.json(users);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе ржПржЗ ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░ржЧрзБрж▓рзЛржХрзЗ ржЖржкржирж┐ MongoDB ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗрж░ ржпрзЗржХрзЛржирзЛ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржПржмржВ рж╕рж╣ржЬрзЗ рж░рзЗржЮрзНржЬ/ржХржорзНржкрж╛рж░рж┐рж╕ржи ржнрж┐рждрзНрждрж┐ржХ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

тЬЕ ржкрж░ржмрж░рзНрждрзА рж╕ржорзЯрзЗ ржЖрж░ржУ ржЬржЯрж┐рж▓ ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░ ржмрж╛ ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗрж╢ржи рж╕ржорзНржкрж░рзНржХрзЗ ржЬрж╛ржирждрзЗ ржЪрж╛ржЗрж▓рзЗ ржЖржорж╛ржХрзЗ ржЬрж╛ржирж╛ржи!



# ЁЯФН MongoDB ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░: $in, $nin, ржПржмржВ Implicit AND Condition - Express.js ржЙржжрж╛рж╣рж░ржг

## ЁЯФЧ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзЗржЯржЖржк:
```js
const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

const userSchema = new mongoose.Schema({
  name: String,
  age: Number,
  city: String,
  job: String
});

const User = mongoose.model('User', userSchema);
```

## ЁЯЯв $in (ржЗржи) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛рж░ ржорж╛ржи ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рждрж╛рж▓рж┐ржХрж╛рж░ ржоржзрзНржпрзЗ рж╣рждрзЗ рж╣ржмрзЗред
```js
app.get('/users/in', async (req, res) => {
  const users = await User.find({ city: { $in: ['Dhaka', 'Chittagong'] } }); // city is either Dhaka or Chittagong
  res.json(users);
});
```

## ЁЯЯв $nin (ржиржЯ ржЗржи) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржбрж╛ржЯрж╛рж░ ржорж╛ржи ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рждрж╛рж▓рж┐ржХрж╛рж░ ржоржзрзНржпрзЗ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ ржирж╛ред
```js
app.get('/users/nin', async (req, res) => {
  const users = await User.find({ city: { $nin: ['Dhaka', 'Chittagong'] } }); // city is neither Dhaka nor Chittagong
  res.json(users);
});
```

## ЁЯЯв Implicit AND Condition (ржЕржержмрж╛ AND ржХржирзНржбрж┐рж╢ржи) - GET API
MongoDB ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ ржПржХрж╛ржзрж┐ржХ ржХржирзНржбрж┐рж╢ржи ржПржХрж╕рж╛ржерзЗ "AND" ржЕржкрж╛рж░рзЗржЯрж░ рж╣рж┐рж╕рзЗржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗред 
ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржЖржкржирж┐ ржпржжрж┐ age 30 ржПрж░ ржмрзЗрж╢рж┐ ржПржмржВ city Dhaka ржПрж░ ржоржзрзНржпрзЗ ржЗржЙржЬрж╛рж░ ржЦрзБржБржЬрждрзЗ ржЪрж╛ржи, рждржмрзЗ ржирж┐ржЪрзЗрж░ ржоржд ржХрж░рзЗ ржХрзБрзЯрзЗрж░рж┐ ржХрж░ржмрзЗржи:

```js
app.get('/users/and', async (req, res) => {
  const users = await User.find({ 
    age: { $gt: 25 }, 
    city: 'Dhaka' 
  }); // AND condition: age > 25 AND city is Dhaka
  res.json(users);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе `$in` ржПржмржВ `$nin` ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж┐ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржирзЗрж░ рждрж╛рж▓рж┐ржХрж╛рж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи, ржПржмржВ Implicit AND ржХржирзНржбрж┐рж╢ржи ржжрзНржмрж╛рж░рж╛ рж╕рж╣ржЬрзЗржЗ ржПржХрж╛ржзрж┐ржХ ржХржирзНржбрж┐рж╢ржи ржПржХрж╕рж╛ржерзЗ ржкрзНрж░рзЯрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред

тЬЕ ржпржжрж┐ ржЖрж░ржУ ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░ ржмрж╛ ржЬржЯрж┐рж▓ ржХрзБрзЯрзЗрж░рж┐ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ ржЬрж╛ржирждрзЗ ржЪрж╛ржи, ржпрзЗржоржи `$or`, `$and` ржмрж╛ ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗрж╢ржи ржмрзНржпржмрж╣рж╛рж░, ржЖржорж╛ржХрзЗ ржЬрж╛ржирж╛ржмрзЗржи!



# ЁЯФН MongoDB ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░: $and, $or, Implicit vs Explicit - Express.js ржЙржжрж╛рж╣рж░ржг


## ЁЯФЧ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзЗржЯржЖржк:

```js

const express = require('express');

const mongoose = require('mongoose');


const app = express();

app.use(express.json());


mongoose.connect('mongodb://localhost:27017/mydb', {

  useNewUrlParser: true,

  useUnifiedTopology: true

});


const userSchema = new mongoose.Schema({

  name: String,

  age: Number,

  city: String,

  job: String

});


const User = mongoose.model('User', userSchema);

```


## ЁЯЯв $and (ржЕрзНржпрж╛ржирзНржб) - GET API

$and ржХржирзНржбрж┐рж╢ржи ржПржХрж╛ржзрж┐ржХ ржХржирзНржбрж┐рж╢ржи ржПржХрж╕рж╛ржерзЗ ржкрзНрж░рзЯрзЛржЧ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржЖржкржирж╛ржХрзЗ ржПржХрж╛ржзрж┐ржХ рж╢рж░рзНржд ржПржХрж╕рж╛ржерзЗ ржорж┐рж▓рж╛рждрзЗ рж╣ржмрзЗред


```js

app.get('/users/and', async (req, res) => {

  const users = await User.find({

    $and: [

      { age: { $gt: 25 } },    // age > 25

      { city: 'Dhaka' }        // city = Dhaka

    ]

  });

  res.json(users);

});

```


## ЁЯЯв $or (ржЕрж░) - GET API

$or ржХржирзНржбрж┐рж╢ржи ржПржХрж╛ржзрж┐ржХ рж╢рж░рзНрждрзЗрж░ ржоржзрзНржпрзЗ ржпрзЗ ржХрзЛржи ржПржХржЯрж┐ рж╢рж░рзНржд рж╕рждрзНржп рж╣рж▓рзЗ ржорж┐рж▓рж┐рзЯрзЗ ржжрж┐ржмрзЗред


```js

app.get('/users/or', async (req, res) => {

  const users = await User.find({

    $or: [

      { age: { $gt: 25 } },    // age > 25

      { city: 'Chittagong' }   // city = Chittagong

    ]

  });

  res.json(users);

});

```


## ЁЯЯв Implicit AND Condition (ржЕржержмрж╛ AND ржХржирзНржбрж┐рж╢ржи) - GET API

MongoDB ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ ржПржХрж╛ржзрж┐ржХ ржХржирзНржбрж┐рж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржПржЧрзБрж▓рж┐ "implicit AND condition" рж╣рзЯрзЗ ржерж╛ржХрзЗ, ржЕрж░рзНржерж╛рзО ржЖржкржирж╛ржХрзЗ **$and** ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржирж╛ ржХрж░рзЗржУ ржПржХрж╛ржзрж┐ржХ ржХржирзНржбрж┐рж╢ржи ржорж┐рж▓рж╛рждрзЗ ржкрж╛рж░ржмрзЗржиред


```js

app.get('/users/implicit-and', async (req, res) => {

  const users = await User.find({

    age: { $gt: 25 },     // age > 25

    city: 'Dhaka'         // city = Dhaka

  });                    // Implicitly AND condition

  res.json(users);

});

```


## ЁЯЯв Explicit AND Condition - GET API

$and ржХржирзНржбрж┐рж╢ржи explicitржнрж╛ржмрзЗ ржжрзЗржУрзЯрж╛ рж╣рзЯ, ржпрж╛рж░ ржоржзрзНржпрзЗ ржПржХрж╛ржзрж┐ржХ ржХржирзНржбрж┐рж╢ржи ржерж╛ржХрзЗ, ржПржмржВ ржЖржкржирж╛ржХрзЗ ржпрзЗржХрзЛржирзЛ ржжрзБржЯрж┐ ржмрж╛ рждрж╛рж░ ржмрзЗрж╢рж┐ рж╢рж░рзНржд ржорж┐рж▓рж╛рждрзЗ рж╣рзЯред


```js

app.get('/users/explicit-and', async (req, res) => {

  const users = await User.find({

    $and: [

      { age: { $gt: 25 } },  // age > 25

      { city: 'Dhaka' }      // city = Dhaka

    ]

  });

  res.json(users);

});

```


## ЁЯЯв Explicit OR Condition - GET API

$or ржХржирзНржбрж┐рж╢ржи explicitржнрж╛ржмрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ, ржпрзЗржЦрж╛ржирзЗ ржПржХрж╛ржзрж┐ржХ рж╢рж░рзНрждрзЗрж░ ржоржзрзНржпрзЗ ржпрзЗ ржХрзЛржи ржПржХржЯрж┐ рж╕рждрзНржп рж╣рж▓рзЗ ржорж┐рж▓рж┐рзЯрзЗ ржжрж┐ржмрзЗред


```js

app.get('/users/explicit-or', async (req, res) => {

  const users = await User.find({

    $or: [

      { age: { $gt: 25 } },    // age > 25

      { city: 'Chittagong' }   // city = Chittagong

    ]

  });

  res.json(users);

});

```


## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:

```js

app.listen(5000, () => {

  console.log('Server is running on port 5000');

});

```


---

ЁЯФе **Implicit AND** ржПржмржВ **Explicit AND** ржжрзБржЯрж┐ ржПржХржЗ ржХрж╛ржЬ ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ **Implicit** ржХржирзНржбрж┐рж╢ржи MongoDB ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ ржмрзЛржЭрзЗ, ржпрзЗржЦрж╛ржирзЗ **Explicit** ржХржирзНржбрж┐рж╢ржи рж╕рж░рж╛рж╕рж░рж┐ `$and` ржжрж┐рзЯрзЗ ржЙрж▓рзНрж▓рзЗржЦ ржХрж░рждрзЗ рж╣рзЯред


ЁЯФе **Implicit OR** ржПржмржВ **Explicit OR** ржХржирзНржбрж┐рж╢ржиржУ ржПржХржЗржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ, рждржмрзЗ `OR` ржХржирзНржбрж┐рж╢ржирзЗрж░ ржЬржирзНржп `$or` ржЕржкрж╛рж░рзЗржЯрж░ ржЕржмрж╢рзНржпржЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ рж╣рзЯред


тЬЕ ржЖрж░ржУ ржЬржЯрж┐рж▓ ржХрзБрзЯрзЗрж░рж┐ ржмрж╛ ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗрж╢ржи ржЬрж╛ржирждрзЗ ржЪрж╛ржЗрж▓рзЗ ржЖржорж╛ржХрзЗ ржЬрж╛ржирж╛ржмрзЗржи!
``


# ЁЯФН MongoDB ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░: $exists, $type, $size, $all, $elemMatch - Express.js ржЙржжрж╛рж╣рж░ржг

## ЁЯФЧ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзЗржЯржЖржк:
```js
const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

const userSchema = new mongoose.Schema({
  name: String,
  age: Number,
  city: String,
  job: String,
  skills: [String],          // Array field
  details: {
    hobbies: [String]       // Nested array inside an object
  }
});

const User = mongoose.model('User', userSchema);
```

## ЁЯЯв $exists (ржПржХрзНрж╕рж┐рж╕рзНржЯ) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржЖржкржирж┐ ржПржХржЯрж┐ ржлрж┐рж▓рзНржбрзЗрж░ ржЕрж╕рзНрждрж┐рждрзНржм ржЪрзЗржХ ржХрж░рждрзЗ ржЪрж╛ржи, ржЕрж░рзНржерж╛рзО ржлрж┐рж▓рзНржбржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗ ржЖржЫрзЗ ржХрж┐ ржирж╛ред

```js
app.get('/users/exists', async (req, res) => {
  const users = await User.find({ city: { $exists: true } }); // city ржлрж┐рж▓рзНржбржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗ ржЖржЫрзЗ ржХрж┐ржирж╛
  res.json(users);
});
```

## ЁЯЯв $type (ржЯрж╛ржЗржк) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржлрж┐рж▓рзНржбрзЗрж░ ржбрж╛ржЯрж╛ ржЯрж╛ржЗржк ржЪрзЗржХ ржХрж░рждрзЗ, ржпрзЗржоржи рж╕рзНржЯрзНрж░рж┐ржВ, ржирж╛ржорзНржмрж╛рж░ ржЗрждрзНржпрж╛ржжрж┐ред

```js
app.get('/users/type', async (req, res) => {
  const users = await User.find({ age: { $type: 'number' } }); // age ржлрж┐рж▓рзНржбржЯрж┐ number ржЯрж╛ржЗржк
  res.json(users);
});
```

## ЁЯЯв $size (рж╕рж╛ржЗржЬ) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржЖржкржирж┐ ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗрж░ рж╕рж╛ржЗржЬ ржЪрзЗржХ ржХрж░рждрзЗ ржЪрж╛ржиред

```js
app.get('/users/size', async (req, res) => {
  const users = await User.find({ skills: { $size: 3 } }); // skills ржЕрзНржпрж╛рж░рзЗрж░ рж╕рж╛ржЗржЬ рзй
  res.json(users);
});
```

## ЁЯЯв $all (ржЕрж▓) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржЖржкржирж┐ ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржбрзЗ ржПржХрж╛ржзрж┐ржХ ржорж╛ржи ржЪрзЗржХ ржХрж░рждрзЗ ржЪрж╛ржиред

```js
app.get('/users/all', async (req, res) => {
  const users = await User.find({ skills: { $all: ['JavaScript', 'Node.js'] } }); // skills ржЕрзНржпрж╛рж░рзЗрждрзЗ JavaScript ржПржмржВ Node.js ржжрзБржЯрж┐ ржорж╛ржи ржерж╛ржХрждрзЗ рж╣ржмрзЗ
  res.json(users);
});
```

## ЁЯЯв $elemMatch (ржПрж▓рж┐ржорзНржпрж╛ржЯ ржорзНржпрж╛ржЪ) - GET API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржпржЦржи ржЖржкржирж┐ ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржбрзЗрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЕржмржЬрзЗржХрзНржЯ ржмрж╛ ржЙржкрж╛ржжрж╛ржи ржорж┐рж▓рж╛рждрзЗ ржЪрж╛ржиред рж╕рж╛ржзрж╛рж░ржгржд, nested ржЕрзНржпрж╛рж░рзЗ ржмрж╛ ржЕржмржЬрзЗржХрзНржЯрзЗрж░ ржЬржирзНржп ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред

```js
app.get('/users/elemmatch', async (req, res) => {
  const users = await User.find({ 
    'details.hobbies': { 
      $elemMatch: { $eq: 'Reading' } 
    }
  }); // hobbies ржЕрзНржпрж╛рж░рзЗ ржерзЗржХрзЗ 'Reading' ржерж╛ржХрж╛ ржЗржЙржЬрж╛рж░ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рж╛
  res.json(users);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$exists** ржЕржкрж╛рж░рзЗржЯрж░ ржлрж┐рж▓рзНржбрзЗрж░ ржЕрж╕рзНрждрж┐рждрзНржм ржЪрзЗржХ ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ, **$type** ржбрж╛ржЯрж╛ ржЯрж╛ржЗржк ржЪрзЗржХ ржХрж░рждрзЗ, **$size** ржЕрзНржпрж╛рж░рзЗрж░ рж╕рж╛ржЗржЬ ржЪрзЗржХ ржХрж░рждрзЗ, **$all** ржЕрзНржпрж╛рж░рзЗрж░ ржоржзрзНржпрзЗ рж╕ржм ржорж╛ржирзЗрж░ ржЙржкрж╕рзНржерж┐рждрж┐ ржЪрзЗржХ ржХрж░рждрзЗ, ржПржмржВ **$elemMatch** ржирзЗрж╕рзНржЯрзЗржб ржЕрзНржпрж╛рж░рзЗ ржмрж╛ ржЕржмржЬрзЗржХрзНржЯрзЗрж░ ржоржзрзНржпрзЗ рж╢рж░рзНржд ржЕржирзБржпрж╛рзЯрзА ржПрж▓рж┐ржорзЗржирзНржЯ ржЦрзБржБржЬрждрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред

тЬЕ ржпржжрж┐ ржЖрж░ржУ ржХрзЛржирзЛ ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░ ржмрж╛ ржЬржЯрж┐рж▓ ржХрзБрзЯрзЗрж░рж┐ ржЬрж╛ржирждрзЗ ржЪрж╛ржи, ржЖржорж╛ржХрзЗ ржЬрж╛ржирж╛ржмрзЗржи!



# ЁЯФН MongoDB ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░: $set, $addToSet, $push, $unset, $pop, $pull, $pullAll - Express.js ржЙржжрж╛рж╣рж░ржг

## ЁЯФЧ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзЗржЯржЖржк:
```js
const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

const userSchema = new mongoose.Schema({
  name: String,
  age: Number,
  city: String,
  job: String,
  skills: [String],          // Array field
  details: {
    hobbies: [String]       // Nested array inside an object
  }
});

const User = mongoose.model('User', userSchema);
```

## ЁЯЯв $set (рж╕рзЗржЯ) - PUT API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржЖржкржбрзЗржЯ ржХрж░рждрзЗред

```js
app.put('/users/set', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' }, 
    { $set: { age: 30 } }   // age ржХрзЗ 30 рждрзЗ ржЖржкржбрзЗржЯ ржХрж░рж╛
  );
  res.json(updatedUser);
});
```

## ЁЯЯв $addToSet (ржЕрзНржпрж╛ржб ржЯрзБ рж╕рзЗржЯ) - PUT API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржбрзЗ ржирждрзБржи ржорж╛ржи ржпрзЛржЧ ржХрж░рж╛рж░ ржЬржирзНржп, рждржмрзЗ ржпрзЗржЧрзБрж▓рж┐ ржЖржЧрзЗржЗ рж░рзЯрзЗржЫрзЗ рждрж╛ ржЖрж░ ржпрзЛржЧ ржХрж░рж╛ рж╣рзЯ ржирж╛ред

```js
app.put('/users/addtset', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' },
    { $addToSet: { skills: 'React' } }  // React ржпржжрж┐ already ржирж╛ ржерж╛ржХрзЗ рждржмрзЗ ржЕрзНржпрж╛рж░рзЗрждрзЗ ржпрзЛржЧ рж╣ржмрзЗ
  );
  res.json(updatedUser);
});
```

## ЁЯЯв $push (ржкрзБрж╢) - PUT API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржбрзЗ ржирждрзБржи ржорж╛ржи ржпрзЛржЧ ржХрж░рж╛рж░ ржЬржирзНржп, ржПржмржВ ржПржХржЗ ржорж╛ржи ржПржХрж╛ржзрж┐ржХржмрж╛рж░ ржпрзЛржЧ рж╣рждрзЗ ржкрж╛рж░рзЗред

```js
app.put('/users/push', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' },
    { $push: { skills: 'Node.js' } }  // Node.js ржпрзЛржЧ рж╣ржмрзЗ
  );
  res.json(updatedUser);
});
```

## ЁЯЯв $unset (ржЖржирж╕рзЗржЯ) - PUT API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржлрж┐рж▓рзНржб ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗред

```js
app.put('/users/unset', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' },
    { $unset: { job: '' } }  // job ржлрж┐рж▓рзНржб ржорзБржЫрзЗ ржлрзЗрж▓рж╛ рж╣ржмрзЗ
  );
  res.json(updatedUser);
});
```

## ЁЯЯв $pop (ржкржк) - PUT API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржбрзЗрж░ ржкрзНрж░ржержо ржЕржержмрж╛ рж╢рзЗрж╖ ржЙржкрж╛ржжрж╛ржи ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗред

```js
app.put('/users/pop', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' },
    { $pop: { skills: 1 } }  // skills ржЕрзНржпрж╛рж░рзЗ ржерзЗржХрзЗ рж╢рзЗрж╖ ржЙржкрж╛ржжрж╛ржи ржорзБржЫрзЗ ржлрзЗрж▓ржмрзЗ (1 = рж╢рзЗрж╖ ржЙржкрж╛ржжрж╛ржи)
  );
  res.json(updatedUser);
});
```

## ЁЯЯв $pull (ржкрзБрж▓) - PUT API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗ ржерзЗржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржи ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗред

```js
app.put('/users/pull', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' },
    { $pull: { skills: 'React' } }  // skills ржЕрзНржпрж╛рж░рзЗ ржерзЗржХрзЗ 'React' ржорзБржЫрзЗ ржлрзЗрж▓ржмрзЗ
  );
  res.json(updatedUser);
});
```

## ЁЯЯв $pullAll (ржкрзБрж▓ ржЕрж▓) - PUT API
ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗ ржерзЗржХрзЗ ржПржХрж╛ржзрж┐ржХ ржорж╛ржи ржПржХрж╕рж╛ржерзЗ ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗред

```js
app.put('/users/pullall', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' },
    { $pullAll: { skills: ['JavaScript', 'Node.js'] } }  // skills ржЕрзНржпрж╛рж░рзЗ ржерзЗржХрзЗ JavaScript ржПржмржВ Node.js ржорзБржЫрзЗ ржлрзЗрж▓ржмрзЗ
  );
  res.json(updatedUser);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$set** ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж┐ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред  
**$addToSet** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржЕрзНржпрж╛рж░рзЗрж░ ржоржзрзНржпрзЗ ржХрзЛржирзЛ ржорж╛ржи ржпржжрж┐ ржЖржЧрзЗ ржерзЗржХрзЗржЗ ржерж╛ржХрзЗ, рждржмрзЗ рждрж╛ ржкрзБржирж░рж╛рзЯ ржпрзЛржЧ ржХрж░рж╛ рж╣ржмрзЗ ржирж╛ред  
**$push** ржЖржкржирж╛ржХрзЗ ржХрзЛржирзЛ ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржбрзЗ ржирждрзБржи ржорж╛ржи ржпрзЛржЧ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ, рждржмрзЗ ржПржЯрж┐ ржкрзБржирж░рж╛рзЯ ржПржХржЗ ржорж╛ржи ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗред  
**$unset** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржЖржкржирж┐ ржХрзЛржирзЛ ржлрж┐рж▓рзНржб ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░ржмрзЗржиред  
**$pop** ржПрж░ ржорж╛ржзрзНржпржорзЗ ржЕрзНржпрж╛рж░рзЗрж░ ржкрзНрж░ржержо ржмрж╛ рж╢рзЗрж╖ ржЙржкрж╛ржжрж╛ржи ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░ржмрзЗржиред  
**$pull** ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржи ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ, ржПржмржВ **$pullAll** ржПржХрж╛ржзрж┐ржХ ржорж╛ржи ржПржХрж╕рж╛ржерзЗ ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред

тЬЕ ржпржжрж┐ ржЖрж░ржУ MongoDB ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░ ржмрж╛ ржЬржЯрж┐рж▓ ржХрзБрзЯрзЗрж░рж┐ рж╢рж┐ржЦрждрзЗ ржЪрж╛ржи, ржЖржорж╛ржХрзЗ ржЬрж╛ржирж╛ржмрзЗржи!


# ЁЯФН MongoDB $set ржЕржкрж╛рж░рзЗржЯрж░, ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ ржПржмржВ ржХрж▓рзЗржХрж╢ржи ржбрзНрж░ржк - Express.js ржЙржжрж╛рж╣рж░ржг

## ЁЯФЧ ржкрзНрж░рж╛ржержорж┐ржХ рж╕рзЗржЯржЖржк:
```js
const express = require('express');
const mongoose = require('mongoose');

const app = express();
app.use(express.json());

mongoose.connect('mongodb://localhost:27017/mydb', {
  useNewUrlParser: true,
  useUnifiedTopology: true
});

const userSchema = new mongoose.Schema({
  name: String,
  age: Number,
  city: String,
  job: String,
  skills: [String],          // Array field
  details: {
    hobbies: [String]       // Nested array inside an object
  }
});

const User = mongoose.model('User', userSchema);
```

## ЁЯЯв $set (рж╕рзЗржЯ) ржЕржкрж╛рж░рзЗржЯрж░ - ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд
MongoDB-рждрзЗ **$set** ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржПржХржЯрж┐ ржмрж╛ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржЖржкржбрзЗржЯ ржХрж░рждрзЗред ржпржжрж┐ ржлрж┐рж▓рзНржбржЯрж┐ ржЖржЧрзЗ ржерзЗржХрзЗржЗ ржЙржкрж╕рзНржерж┐ржд ржерж╛ржХрзЗ, рждржмрзЗ рждрж╛ ржЖржкржбрзЗржЯ ржХрж░рж╛ рж╣ржмрзЗ; ржпржжрж┐ ржирж╛ ржерж╛ржХрзЗ, рждржмрзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб рж╣рж┐рж╕рзЗржмрзЗ рж╕рзЗржЯ рж╣ржмрзЗред

### $set ржЕржкрж╛рж░рзЗржЯрж░рзЗрж░ ржмрзНржпржмрж╣рж╛рж░:
- **$set** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржЖржкржирж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред ржПржЯрж┐ **insert** ржмрж╛ **update** ржЙржнрзЯ ржХрж╛ржЬрзЗржЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред
- **$set** ржЖржкржирж╛рж░ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржЕржВрж╢ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ ржмрж╛ржХрж┐ ржбрзЗржЯрж╛ ржЕржкрж░рж┐ржмрж░рзНрждрж┐ржд рж░рж╛ржЦрзЗред
- ржПржЯрж┐ MongoDB ржбржХрзБржорзЗржирзНржЯрзЗ ржлрж┐рж▓рзНржб ржпрзЛржЧ, ржкрж░рж┐ржмрж░рзНрждржи ржмрж╛ ржЖржкржбрзЗржЯрзЗрж░ ржЬржирзНржп ржЦрзБржмржЗ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржПржмржВ рж╕рж╣ржЬ ржЙржкрж╛рзЯред

### ржЙржжрж╛рж╣рж░ржг:
```js
app.put('/users/set', async (req, res) => {
  const updatedUser = await User.updateOne(
    { name: 'John Doe' },
    { $set: { age: 35, city: 'New York' } } // age ржУ city ржЖржкржбрзЗржЯ ржХрж░рж╛
  );
  res.json(updatedUser);
});
```

### ржмрзНржпржмрж╣рж╛рж░рж┐ржХ ржжрзГрж╖рзНржЯрж┐ржнржЩрзНржЧрж┐:
- **$set** ржЖржкржирж┐ ржпрзЗржнрж╛ржмрзЗ ржЪрж╛ржи ржлрж┐рж▓рзНржбржЯрж┐ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржирзЗ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред 
- ржпржжрж┐ ржХрзЛржирзЛ ржлрж┐рж▓рзНржб ржбржХрзБржорзЗржирзНржЯрзЗ ржирж╛ ржерж╛ржХрзЗ, рждржмрзЗ ржПржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░ржмрзЗред

## ЁЯЯв ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рж╛ - DELETE ржЕржкрж╛рж░рзЗржЯрж░
MongoDB рждрзЗ ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рж╛рж░ ржЬржирзНржп **deleteOne** ржПржмржВ **deleteMany** ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред

### deleteOne:
ржПржЯрж┐ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХржирзНржбрж┐рж╢ржи ржорж┐рж▓рзЗ ржПржХржЯрж┐ржорж╛рждрзНрж░ ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рзЗред

```js
app.delete('/users/delete', async (req, res) => {
  const deletedUser = await User.deleteOne({ name: 'John Doe' }); // John Doe ржирж╛ржорзЗрж░ ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рж╛
  res.json(deletedUser);
});
```

### deleteMany:
ржПржЯрж┐ ржПржХрж╛ржзрж┐ржХ ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рзЗ, ржпржжрж┐ ржХржирзНржбрж┐рж╢ржи ржорзЗрж▓рзЗред

```js
app.delete('/users/delete-many', async (req, res) => {
  const deletedUsers = await User.deleteMany({ city: 'Dhaka' }); // Dhaka рж╢рж╣рж░рзЗрж░ рж╕ржм ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рж╛
  res.json(deletedUsers);
});
```

## ЁЯЯв ржХрж▓рзЗржХрж╢ржи ржбрзНрж░ржк - drop() ржЕржкрж╛рж░рзЗржЯрж░
MongoDB рждрзЗ ржПржХржЯрж┐ ржкрзВрж░рзНржг ржХрж▓рзЗржХрж╢ржи ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ **drop()** ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред

### ржХрж▓рзЗржХрж╢ржи ржбрзНрж░ржк:
ржПржЯрж┐ ржкрзБрж░рзЛ ржХрж▓рзЗржХрж╢ржиржЯрж┐ ржорзБржЫрзЗ ржлрзЗрж▓рзЗ, рж╕ржорж╕рзНржд ржбржХрзБржорзЗржирзНржЯ ржПржмржВ рж╕рзНржХрж┐ржорж╛ рж╕рж╣ред

```js
app.delete('/users/drop-collection', async (req, res) => {
  const result = await User.collection.drop(); // 'User' ржХрж▓рзЗржХрж╢ржи ржорзБржЫрзЗ ржлрзЗрж▓рж╛
  res.json({ message: 'Collection dropped successfully', result });
});
```

## ЁЯЯв рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$set** ржЕржкрж╛рж░рзЗржЯрж░ ржжрж┐рзЯрзЗ ржЖржкржирж┐ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржПржмржВ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред
ЁЯФе **deleteOne** ржПржмржВ **deleteMany** ржжрж┐рзЯрзЗ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ ржбржХрзБржорзЗржирзНржЯ ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░ржмрзЗржиред
ЁЯФе **drop()** ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржкрзБрж░рзЛ ржХрж▓рзЗржХрж╢ржи ржорзБржЫрзЗ ржлрзЗрж▓рждрзЗ ржкрж╛рж░ржмрзЗржи, рждржмрзЗ ржПржЗ ржЕржкрж╛рж░рзЗрж╢ржиржЯрж┐ ржкрзБрж░рзЛ ржХрж▓рзЗржХрж╢ржиржЯрж┐рж░ ржбрзЗржЯрж╛ ржорзБржЫрзЗ ржлрзЗрж▓ржмрзЗ ржПржмржВ ржкрзБржирж░рж╛рзЯ ржкрзБржирж░рзБржжрзНржзрж╛рж░ ржХрж░рж╛ рж╕ржорзНржнржм ржирзЯред

тЬЕ ржпржжрж┐ ржЖржкржирж┐ MongoDB рж╕ржорзНржкрж░рзНржХрзЗ ржЖрж░ржУ рж╢рж┐ржЦрждрзЗ ржЪрж╛ржи, ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗржЯрж░ ржмрж╛ ржорзНржпрж╛ржирж┐ржкрзБрж▓рзЗрж╢ржи рж╕ржорзНржкрж░рзНржХрзЗ ржХрзЛржирзЛ ржкрзНрж░рж╢рзНржи ржерж╛ржХрж▓рзЗ ржЬрж╛ржирж╛ржмрзЗржи!


# ЁЯФН MongoDB Aggregation Framework - ржПржХржЯрж┐ ржкрж░рж┐ржЪрж┐рждрж┐

## ЁЯЯв MongoDB Aggregation Framework ржХрж┐?
MongoDB ржПрж░ **Aggregation Framework** ржПржХржЯрж┐ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржЯрзБрж▓ ржпрж╛ ржЖржкржирж╛ржХрзЗ ржбрзЗржЯрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж░рзНржо, ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛, ржПржмржВ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд ржЦрзБржмржЗ ржХрж╛рж░рзНржпржХрж░рзА ржпржЦржи ржЖржкржирж┐ ржбрзЗржЯрж╛рж░ ржЙржкрж░ ржмрж┐ржнрж┐ржирзНржи ржзрж░ржирзЗрж░ **ржЧрзНрж░рзБржкрж┐ржВ**, **ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ**, **рж╕рзЛрж░рзНрж╕рж┐ржВ**, **ржЕрж░рзНржбрж╛рж░рж┐ржВ**, ржПржмржВ **ржорзНржпрж╛ржкрж┐ржВ** ржХрж░рждрзЗ ржЪрж╛ржиред

MongoDB-ржПрж░ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ ржЕржирзЗржХржЧрзБрж▓рзЛ ржбржХрзБржорзЗржирзНржЯ ржерж╛ржХрждрзЗ ржкрж╛рж░рзЗ ржПржмржВ ржЖржкржирж┐ ржпржжрж┐ ржПржХрж╛ржзрж┐ржХ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржЙржкрж░ ржЕржЧрзНрж░рж╛ржзрж┐ржХрж╛рж░ рж╕рж╣ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржзрж░ржирзЗрж░ ржЕржкрж╛рж░рзЗрж╢ржи ржХрж░рждрзЗ ржЪрж╛ржи, рждржмрзЗ Aggregation Framework ржЦрзБржмржЗ ржХрж╛рж░рзНржпржХрж░ред

## ЁЯЯв Aggregation Framework ржПрж░ ржорзВрж▓ ржЙржкрж╛ржжрж╛ржи:
MongoDB-ржПрж░ Aggregation Framework ржкрзНрж░ржзрж╛ржиржд ржмрж┐ржнрж┐ржирзНржи ржзрж░ржирзЗрж░ **stage** (ржзрж╛ржк) ржирж┐ржпрж╝рзЗ ржЧржарж┐рждред ржкрзНрж░рждрж┐ржЯрж┐ stage ржбрзЗржЯрж╛ ржЯрзНрж░рж╛ржирзНрж╕ржлрж░рзНржорзЗрж░ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж╛ржЬ ржХрж░рзЗ ржПржмржВ ржПржЗржЧрзБрж▓рзЛ ржПржХрзЗ ржЕржкрж░рзЗрж░ рж╕рж╛ржерзЗ ржпрзБржХрзНржд рж╣рзЯрзЗ ржПржХржЯрж┐ ржкрж╛ржЗржкрж▓рж╛ржЗржи рждрзИрж░рж┐ ржХрж░рзЗред

### ьг╝ьЪФ Aggregate Stages:
- **$match:** ржПржХржЯрж┐ stage ржпрж╛ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рж┐ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╢рж░рзНржд ржЕржирзБржпрж╛рзЯрзА ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзЗред
- **$group:** ржбрзЗржЯрж╛ржХрзЗ ржЧрзНрж░рзБржк ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи `sum`, `avg`, `max`, `min` ржЗрждрзНржпрж╛ржжрж┐ред
- **$project:** ржбрзЗржЯрж╛рж░ ржкрзНрж░ржкрж╛рж░рзНржЯрж┐ ржирж┐рж░рзНржмрж╛ржЪржи ржмрж╛ ржорзНржпрж╛ржирж┐ржкрзБрж▓рзЗрж╢ржи ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред
- **$sort:** ржбрзЗржЯрж╛ржХрзЗ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрзНрж░ржорзЗ рж╕рж╛ржЬрж╛ржирзЛрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред
- **$limit:** ржбрзЗржЯрж╛рж░ рж╕ржВржЦрзНржпрж╛ рж╕рзАржорж╛ржмржжрзНржз ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред
- **$skip:** ржбрзЗржЯрж╛рж░ рж╢рзБрж░рзБ ржерзЗржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕ржВржЦрзНржпржХ ржбржХрзБржорзЗржирзНржЯ ржПрзЬрж┐рзЯрзЗ ржпрзЗрждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред
- **$unwind:** ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржбржЧрзБрж▓рж┐ржХрзЗ ржкрзГржержХ ржкрзГржержХ ржбржХрзБржорзЗржирзНржЯрзЗ ржмрж┐ржнржХрзНржд ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред
- **$lookup:** ржжрзБржЯрж┐ ржнрж┐ржирзНржи ржХрж▓рзЗржХрж╢ржирзЗрж░ ржоржзрзНржпрзЗ ржЬрзЛрзЬ ржмрж╛ join ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред

## ЁЯЯв Aggregation Framework-ржПрж░ ржЙржжрж╛рж╣рж░ржг:

### ржЙржжрж╛рж╣рж░ржг 1: $match ржПржмржВ $group
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржПрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржЧрзНрж░рзБржк ржХрж░рзЗ рждрж╛ржжрзЗрж░ ржЧрзЬ ржмрзЯрж╕ ржмрзЗрж░ ржХрж░рждрзЗ ржЪрж╛ржЗред

```js
app.get('/aggregation/avg-age', async (req, res) => {
  const result = await User.aggregate([
    { $match: { city: 'Dhaka' } },       // Dhaka рж╢рж╣рж░рзЗрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржлрж┐рж▓рзНржЯрж╛рж░
    { $group: { _id: null, avgAge: { $avg: '$age' } } }  // ржЧрзЬ ржмрзЯрж╕ ржмрзЗрж░ ржХрж░рж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $project
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `name` ржПржмржВ `age` ржЫрж╛рзЬрж╛ ржЕржирзНржпрж╛ржирзНржп ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржмрж╛ржж ржжрж┐рзЯрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ ржЪрж╛ржЗред

```js
app.get('/aggregation/project', async (req, res) => {
  const result = await User.aggregate([
    { $project: { name: 1, age: 1 } }   // рж╢рзБржзрзБ name ржПржмржВ age ржкрзНрж░ржжрж░рзНрж╢ржи ржХрж░рж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 3: $sort ржПржмржВ $limit
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржПрж░ ржУржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рж╕ржмржЪрзЗрзЯрзЗ ржмрзЯрж╕рзА 5 ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржХрзЗ ржжрзЗржЦрждрзЗ ржЪрж╛ржЗред

```js
app.get('/aggregation/sort-limit', async (req, res) => {
  const result = await User.aggregate([
    { $sort: { age: -1 } },       // ржмрзЯрж╕ descending order ржП рж╕рж╛ржЬрж╛ржирзЛ
    { $limit: 5 }                 // ржкрзНрж░ржержо 5 ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржжрзЗржЦрж╛ржирзЛ
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 4: $unwind
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ ржлрж┐рж▓рзНржб `hobbies` ржХрзЗ ржкрзНрж░рждрж┐ржЯрж┐ рж╣ржмрж┐ рж╣рж┐рж╕рзЗржмрзЗ ржЖрж▓рж╛ржжрж╛ ржбржХрзБржорзЗржирзНржЯрзЗ ржжрзЗржЦрждрзЗ ржЪрж╛ржЗред

```js
app.get('/aggregation/unwind', async (req, res) => {
  const result = await User.aggregate([
    { $unwind: '$details.hobbies' }   // hobbies ржЕрзНржпрж╛рж░рзЗржЯрж┐ ржкрзГржержХ ржкрзГржержХ ржбржХрзБржорзЗржирзНржЯрзЗ ржмрж┐ржнржХрзНржд
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 5: $lookup (Join)
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржжрзБржЯрж┐ ржХрж▓рзЗржХрж╢ржи, `users` ржПржмржВ `orders`, ржЬрзЛрзЬрж╛ ржХрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ржПржмржВ рждрж╛ржжрзЗрж░ ржЕрж░рзНржбрж╛рж░ рж╕ржорзНржкрж░рзНржХрж┐ржд рждржерзНржп ржПржХрж╕рж╛ржерзЗ ржЖржирждрзЗ ржЪрж╛ржЗред

```js
app.get('/aggregation/lookup', async (req, res) => {
  const result = await User.aggregate([
    { $lookup: {
      from: 'orders',                // orders ржХрж▓рзЗржХрж╢ржи ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржирж┐рзЯрзЗ ржЖрж╕рж╛
      localField: '_id',             // localField ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА ID
      foreignField: 'userId',        // foreignField ржЕрж░рзНржбрж╛рж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ID
      as: 'userOrders'               // ржлрж╛ржЗржирж╛рж▓ рж░рзЗржЬрж╛рж▓рзНржЯрзЗ ржпрзБржХрзНржд ржХрж░рж╛ рж╣ржмрзЗ 'userOrders' ржирж╛ржорзЗ
    } }
  ]);
  res.json(result);
});
```

## ЁЯЯв MongoDB Aggregation Framework-ржПрж░ ржЙржкржХрж╛рж░рж┐рждрж╛:
- **рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржбрзЗржЯрж╛ ржкрзНрж░рж╕рзЗрж╕рж┐ржВ:** ржПржЯрж┐ ржЕржирзЗржХ ржЬржЯрж┐рж▓ ржбрзЗржЯрж╛ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ ржЦрзБржм рж╕рж╣ржЬржнрж╛ржмрзЗ рж╕ржорзНржкрж╛ржжржи ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред
- **ржХрж╛рж╕рзНржЯржо ржХрзБрзЯрзЗрж░рж┐ ржЕржкрж╛рж░рзЗрж╢ржи:** ржХрж╛рж╕рзНржЯржо ржЧрзНрж░рзБржкрж┐ржВ, ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ, ржПржмржВ ржЯрзНрж░рж╛ржирзНрж╕ржлрж░рзНржорзЗрж╢ржи рж╕ржорзНржнржмред
- **ржкрзНрж░ржлрж░рзНржорзЗржирзНрж╕:** MongoDB-ржПрж░ aggregation рж╕рзНржЯрзЗржЬржЧрзБрж▓рж┐ ржЕрждрзНржпржирзНржд ржжржХрзНрж╖ ржПржмржВ ржжрзНрж░рзБржд ржкрж╛рж░ржлрж░рзНржо ржХрж░рзЗ, ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ ржмрзЬ ржбрзЗржЯрж╛ рж╕рзЗржЯрзЗрж░ ржЬржирзНржпред
- **ржЬрзЯрзЗржи:** MongoDB aggregation framework `join` рж╕ржорж░рзНржержи ржХрж░рзЗ ржпрж╛ ржПржХрж╛ржзрж┐ржХ ржХрж▓рзЗржХрж╢ржирзЗрж░ ржоржзрзНржпрзЗ рж╕ржорзНржкрж░рзНржХ рждрзИрж░рж┐ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **Aggregation Framework** MongoDB-рждрзЗ ржбрзЗржЯрж╛ ржкрзНрж░рж╕рзЗрж╕рж┐ржВрзЯрзЗрж░ ржПржХржЯрж┐ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржкржжрзНржзрждрж┐ ржпрж╛ ржбрзЗржЯрж╛ржХрзЗ ржЧрзНрж░рзБржк, ржлрж┐рж▓рзНржЯрж╛рж░, рж╕рзЛрж░рзНрж╕, рж╕рж╛ржЬрж╛ржирзЛ, ржПржмржВ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржжрзЗрзЯред ржПржЯрж┐ ржЕржирзЗржХ ржмрзЗрж╢рж┐ ржХрж╛рж░рзНржпржХрж░ ржпржЦржи ржЖржкржирж┐ ржЬржЯрж┐рж▓ ржХрзБрзЯрзЗрж░рж┐ ржПржмржВ ржбрзЗржЯрж╛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржг ржХрж░рждрзЗ ржЪрж╛ржиред


# ЁЯФН MongoDB Aggregation Framework - $match ржПржмржВ $project рж╕рзНржЯрзЗржЬ

## ЁЯЯв $match рж╕рзНржЯрзЗржЬ
**$match** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржПрж░ ржкрзНрж░ржержо рж╕рзНржЯрзЗржЬ рж╣рж┐рж╕рзЗржмрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржПржмржВ ржПржЯрж┐ ржбрзЗржЯрж╛рж░ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ ржорзВрж▓ржд **find()** ржХрзБрзЯрзЗрж░рж┐ ржлрж╛ржВрж╢ржирзЗрж░ ржорждрзЛржЗ ржХрж╛ржЬ ржХрж░рзЗ, ржХрж┐ржирзНрждрзБ ржПржЦрж╛ржирзЗ ржПржЯрж┐ aggregation pipeline-ржПрж░ ржЕржВрж╢ рж╣рж┐рж╕рзЗржмрзЗ ржХрж╛ржЬ ржХрж░рзЗред

- **$match** рж╕рзНржЯрзЗржЬрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рзЗ рж╢рзБржзрзБржорж╛рждрзНрж░ рж╕рзЗржЗ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржпрж╛ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╢рж░рзНржд ржкрзВрж░рзНржг ржХрж░рзЗред 
- ржЖржкржирж┐ **$match** рж╕рзНржЯрзЗржЬрзЗ ржпрзЗ ржХржирзНржбрж┐рж╢ржи ржжрзЗржмрзЗржи, рждрж╛ **find()** ржХрзБрзЯрзЗрж░рж┐рж░ ржорждрзЛржЗ рж╣рждрзЗ ржкрж╛рж░рзЗ (ржпрзЗржоржи: `$eq`, `$gt`, `$lt`, `$in`, `$and` ржЗрждрзНржпрж╛ржжрж┐)ред
- **$match** рж╕рзНржЯрзЗржЬ рж╕рж╛ржзрж╛рж░ржгржд aggregation pipeline-ржПрж░ ржкрзНрж░ржержорзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ, рждржмрзЗ ржПржЯрж╛ ржпрзЗ ржХрзЛржирзЛ ржЬрж╛рзЯржЧрж╛рзЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред

### ржЙржжрж╛рж╣рж░ржг 1: $match - ржПржХржХ рж╢рж░рзНрждрзЗ ржбржХрзБржорзЗржирзНржЯ ржлрж┐рж▓рзНржЯрж╛рж░
ржПржЗ ржЙржжрж╛рж╣рж░ржгрзЗ ржЖржорж░рж╛ `age` ржПрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░ржЫрж┐, ржпрж╛рждрзЗ рзйрзж ржПрж░ ржмрзЗрж╢рж┐ ржмрзЯрж╕рзЗрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯред

```js
app.get('/aggregation/match', async (req, res) => {
  const result = await User.aggregate([
    { $match: { age: { $gt: 30 } } }  // ржмрзЯрж╕ рзйрзж ржПрж░ ржмрзЗрж╢рж┐
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $match - ржПржХрж╛ржзрж┐ржХ рж╢рж░рзНрждрзЗ ржбржХрзБржорзЗржирзНржЯ ржлрж┐рж▓рзНржЯрж╛рж░
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржПржмржВ `city` ржПрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржбржХрзБржорзЗржирзНржЯ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/match-multiple', async (req, res) => {
  const result = await User.aggregate([
    { $match: { age: { $gt: 30 }, city: 'Dhaka' } }  // ржмрзЯрж╕ рзйрзж ржПрж░ ржмрзЗрж╢рж┐ ржПржмржВ рж╢рж╣рж░ Dhaka
  ]);
  res.json(result);
});
```

## ЁЯЯв $project рж╕рзНржЯрзЗржЬ
**$project** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржПрж░ ржПржХржЯрж┐ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг рж╕рзНржЯрзЗржЬ, ржпрж╛ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛржХрзЗ ржирж┐рзЯржирзНрждрзНрж░ржг ржПржмржВ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛржХрзЗ ржирж┐рж░рзНржмрж╛ржЪрж┐ржд ржХрж░рзЗ, ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рзЗ ржмрж╛ ржПржХрзНрж╕ржкрзНрж░рзЗрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рждрж╛ржжрзЗрж░ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рзЗред

- **$project** рж╕рзНржЯрзЗржЬрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржбржХрзБржорзЗржирзНржЯрзЗ ржХрзЛржи ржХрзЛржи ржлрж┐рж▓рзНржб ржерж╛ржХржмрзЗ рждрж╛ ржирж┐рзЯржирзНрждрзНрж░ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред ржЖржкржирж┐ ржЪрж╛ржЗрж▓рзЗ ржХрж┐ржЫрзБ ржлрж┐рж▓рзНржб ржмрж╛ржж ржжрж┐рждрзЗ ржкрж╛рж░рзЗржи ржЕржержмрж╛ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзБржХрзНржд ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред
- ржЖржкржирж┐ **$project** рж╕рзНржЯрзЗржЬрзЗ **0 ржмрж╛ 1** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржЗржиржХрзНрж▓рзБржб ржмрж╛ ржПржХрзНрж╕ржХрзНрж▓рзБржб ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред
- ржЖржкржирж┐ **$project** рж╕рзНржЯрзЗржЬрзЗ ржЕрзНржпрж╛рж░рзЗржЧрзЗржЯ ржЗржХрзНрж╕ржкрзНрж░рзЗрж╢ржиржУ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржпрзЗржоржи: `$add`, `$subtract`, `$multiply`, `$concat` ржЗрждрзНржпрж╛ржжрж┐ред

### ржЙржжрж╛рж╣рж░ржг 1: $project - ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржб ржирж┐рж░рзНржмрж╛ржЪржи
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ рж╢рзБржзрзБ `name` ржПржмржВ `age` ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржлрж┐рж░рж┐рзЯрзЗ ржжрж┐ржЪрзНржЫрж┐ ржПржмржВ ржЕржирзНржп рж╕ржм ржлрж┐рж▓рзНржб ржмрж╛ржж ржжрж┐ржЪрзНржЫрж┐ред

```js
app.get('/aggregation/project', async (req, res) => {
  const result = await User.aggregate([
    { $project: { name: 1, age: 1 } }   // рж╢рзБржзрзБ name ржПржмржВ age ржлрж┐рж▓рзНржб ржжрзЗржЦрж╛ржирзЛ
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $project - ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `fullName` ржирж╛ржоржХ ржПржХржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рзЗржЫрж┐ ржпрж╛ `firstName` ржПржмржВ `lastName` ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржиржХрзЗ ржпрзБржХрзНржд ржХрж░ржЫрзЗред

```js
app.get('/aggregation/project-new-field', async (req, res) => {
  const result = await User.aggregate([
    { $project: { 
        fullName: { $concat: ['$firstName', ' ', '$lastName'] },  // firstName ржПржмржВ lastName ржорж┐рж╢рж┐рзЯрзЗ fullName рждрзИрж░рж┐
        age: 1,  // рж╢рзБржзрзБ age ржлрж┐рж▓рзНржб ржкрзНрж░ржжрж░рзНрж╢ржи
    } }
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 3: $project - ржлрж┐рж▓рзНржб ржмрж╛ржж ржжрзЗрзЯрж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `city` ржлрж┐рж▓рзНржбржЯрж┐ ржмрж╛ржж ржжрж┐рзЯрзЗ ржмрж╛ржХрж┐ рж╕ржм ржлрж┐рж▓рзНржб ржирж┐рзЯрзЗ ржЖрж╕ржЫрж┐ред

```js
app.get('/aggregation/project-exclude', async (req, res) => {
  const result = await User.aggregate([
    { $project: { city: 0 } }   // city ржлрж┐рж▓рзНржб ржмрж╛ржж ржжрзЗрзЯрж╛
  ]);
  res.json(result);
});
```

## ЁЯЯв $match ржПржмржВ $project ржПржХрждрзНрж░рзЗ ржмрзНржпржмрж╣рж╛рж░
**$match** ржПржмржВ **$project** рж╕рзНржЯрзЗржЬ ржПржХрж╕рж╛ржерзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж┐ ржкрзНрж░ржержорзЗ ржбрзЗржЯрж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржПржмржВ рждрж╛рж░ржкрж░ ржкрзНрж░рзЯрзЛржЬржирзАрзЯ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

### ржЙржжрж╛рж╣рж░ржг: $match ржПржмржВ $project ржПржХрж╕рж╛ржерзЗ ржмрзНржпржмрж╣рж╛рж░
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржкрзНрж░ржержорзЗ `age` ржПрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржбржХрзБржорзЗржирзНржЯ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░ржм ржПржмржВ рждрж╛рж░ржкрж░ `name` ржПржмржВ `age` ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржжрзЗржЦрж╛ржмрзЛред

```js
app.get('/aggregation/match-project', async (req, res) => {
  const result = await User.aggregate([
    { $match: { age: { $gt: 30 } } },  // ржмрзЯрж╕ рзйрзж ржПрж░ ржмрзЗрж╢рж┐
    { $project: { name: 1, age: 1 } }  // рж╢рзБржзрзБ name ржПржмржВ age ржлрж┐рж▓рзНржб ржжрзЗржЦрж╛ржирзЛ
  ]);
  res.json(result);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$match** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбрзЗржЯрж╛ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред ржПржЯрж┐ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рж┐ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╢рж░рзНрждрзЗрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рзЗред
ЁЯФе **$project** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбрзЗржЯрж╛рж░ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛржХрзЗ ржирж┐рж░рзНржмрж╛ржЪржи, ржкрж░рж┐ржмрж░рзНрждржи ржмрж╛ ржмрж╛ржж ржжрзЗржУрзЯрж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ рж╣рзЯред
ЁЯФе ржЖржкржирж┐ **$match** ржПржмржВ **$project** рж╕рзНржЯрзЗржЬ ржПржХрж╕рж╛ржерзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржбрзЗржЯрж╛рж░ ржлрж┐рж▓рзНржЯрж╛рж░ ржПржмржВ ржорж╛ржи ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред



# ЁЯФН MongoDB Aggregation Framework - $addFields, $out ржПржмржВ $merge рж╕рзНржЯрзЗржЬ

## ЁЯЯв $addFields рж╕рзНржЯрзЗржЬ
**$addFields** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбржХрзБржорзЗржирзНржЯрзЗ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ ржПржХржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рждрзЗ ржмрж╛ ржмрж┐ржжрзНржпржорж╛ржи ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд **$project** рж╕рзНржЯрзЗржЬрзЗрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗ, рждржмрзЗ $addFields ржмрж┐ржжрзНржпржорж╛ржи ржбрзЗржЯрж╛рж░ ржоржзрзНржпрзЗ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред

- **$addFields** ржбржХрзБржорзЗржирзНржЯрзЗ ржПржХржЯрж┐ ржмрж╛ ржПржХрж╛ржзрж┐ржХ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗред
- ржЖржкржирж┐ ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗрж╢ржи, ржПржХрзНрж╕ржкрзНрж░рзЗрж╢ржи, ржмрж╛ ржХрзЛржирзЛ ржбрзЗржЯрж╛рж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

### ржЙржжрж╛рж╣рж░ржг 1: $addFields - ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржПржХржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб `fullName` рждрзИрж░рж┐ ржХрж░ржЫрж┐ ржпрж╛ `firstName` ржПржмржВ `lastName` ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржиржХрзЗ ржпрзБржХрзНржд ржХрж░ржЫрзЗред

```js
app.get('/aggregation/addfields', async (req, res) => {
  const result = await User.aggregate([
    { $addFields: { fullName: { $concat: ['$firstName', ' ', '$lastName'] } } } // firstName ржУ lastName ржпрзБржХрзНржд ржХрж░рзЗ fullName рждрзИрж░рж┐
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $addFields - ржмрж┐ржжрзНржпржорж╛ржи ржлрж┐рж▓рзНржб ржкрж░рж┐ржмрж░рзНрждржи
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржирзЗ рзл ржмржЫрж░ ржпрзЛржЧ ржХрж░рзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб `newAge` рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/addfields-age', async (req, res) => {
  const result = await User.aggregate([
    { $addFields: { newAge: { $add: ['$age', 5] } } }  // age ржПрж░ рж╕рж╛ржерзЗ рзл ржмржЫрж░ ржпрзЛржЧ ржХрж░рзЗ newAge рждрзИрж░рж┐
  ]);
  res.json(result);
});
```

## ЁЯЯв $out рж╕рзНржЯрзЗржЬ
**$out** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбрзЗржЯрж╛рж░ рж░рзЗржЬрж╛рж▓рзНржЯ рж╕рж░рж╛рж╕рж░рж┐ ржПржХржЯрж┐ ржирждрзБржи ржмрж╛ ржмрж┐ржжрзНржпржорж╛ржи ржХрж▓рзЗржХрж╢ржирзЗ рж▓рзЗржЦрж╛ рж╣рзЯред ржПржЯрж┐ ржПржХржЯрж┐ рж╢рзЗрж╖ рж╕рзНржЯрзЗржЬ рж╣рж┐рж╕рзЗржмрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржПржмржВ ржПрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржпрзЗржХрзЛржирзЛ aggregation pipeline ржПрж░ рж░рзЗржЬрж╛рж▓рзНржЯ ржХрзЗ ржПржХржЯрж┐ ржХрж▓рзЗржХрж╢ржирзЗ **write** ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред

- **$out** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржЖржкржирж┐ ржкрж┐ржкрж▓рж╛ржЗржирзЗрж░ рж╢рзЗрж╖рзЗрж░ ржбрзЗржЯрж╛ рж╕рж░рж╛рж╕рж░рж┐ ржПржХржЯрж┐ ржХрж▓рзЗржХрж╢ржирзЗ рж▓рзЗржЦрж╛рж░ рж╕рзБржпрзЛржЧ ржкрж╛ржмрзЗржиред
- ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржиржд ржбрзЗржЯрж╛ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ржЬрж╛ржд ржХрж░рж╛рж░ ржкрж░ рждрж╛ ржбрж╛ржЯрж╛ржмрзЗрж╕рзЗ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред

### ржЙржжрж╛рж╣рж░ржг: $out - ржирждрзБржи ржХрж▓рзЗржХрж╢ржирзЗ рж░рзЗржЬрж╛рж▓рзНржЯ рж▓рзЗржЦрж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ рж╕ржорж╕рзНржд `User` ржбржХрзБржорзЗржирзНржЯржХрзЗ `user_results` ржирж╛ржоржХ ржПржХржЯрж┐ ржирждрзБржи ржХрж▓рзЗржХрж╢ржирзЗ рж▓рж┐ржЦрзЗ ржлрзЗрж▓ржЫрж┐ред

```js
app.get('/aggregation/out', async (req, res) => {
  const result = await User.aggregate([
    { $match: { city: 'Dhaka' } },   // Dhaka рж╢рж╣рж░рзЗрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржирж┐рж░рзНржмрж╛ржЪржи
    { $out: 'user_results' }         // user_results ржХрж▓рзЗржХрж╢ржирзЗ рж░рзЗржЬрж╛рж▓рзНржЯ рж╕ржВрж░ржХрзНрж╖ржг
  ]);
  res.json({ message: 'Data written to user_results collection' });
});
```

- **$out** рж╕рзНржЯрзЗржЬ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ ржЖржЧрзЗрж░ ржХрж▓рзЗржХрж╢ржиржЯрж┐ ржбрж┐рж▓рж┐ржЯ рж╣рждрзЗ ржкрж╛рж░рзЗ ржмрж╛ ржкрзБрж░рзЛржкрзБрж░рж┐ ржирждрзБржи ржХрж▓рзЗржХрж╢ржи рждрзИрж░рж┐ рж╣рждрзЗ ржкрж╛рж░рзЗред
- **$out** рж╕рж╛ржзрж╛рж░ржгржд ржбрзЗржЯрж╛ ржЖрж░рзНржХрж╛ржЗржн, рж░рж┐ржкрзЛрж░рзНржЯ ржмрж╛ ржмрж┐рж╢рзНрж▓рзЗрж╖ржгрзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред

## ЁЯЯв $merge рж╕рзНржЯрзЗржЬ
**$merge** рж╕рзНржЯрзЗржЬ MongoDB-ржПрж░ **$out** рж╕рзНржЯрзЗржЬрзЗрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗ, рждржмрзЗ ржПржЯрж┐ ржЖрж░ржУ ржлрзНрж▓рзЗржХрзНрж╕рж┐ржмрж▓ ржПржмржВ ржХрж╛рж░рзНржпржХрж░рзАред ржПржЯрж┐ ржЖржкржирж╛ржХрзЗ ржбрзЗржЯрж╛ржХрзЗ ржПржХржЯрж┐ ржХрж▓рзЗржХрж╢ржирзЗ ржорж░рзНржЬ ржХрж░рж╛рж░ ржЬржирзНржп ржмрж┐ржнрж┐ржирзНржи ржзрж░ржирзЗрж░ ржЕржкрж╢ржи ржкрзНрж░ржжрж╛ржи ржХрж░рзЗред ржПрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржбрзЗржЯрж╛ **update**, **insert**, ржмрж╛ **replace** ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

- **$merge** рж╕рзНржЯрзЗржЬржЯрж┐ MongoDB 4.2 ржмрж╛ рждрж╛рж░ ржкрж░рзЗрж░ рж╕ржВрж╕рзНржХрж░ржгрзЗ ржЙржкрж▓ржмрзНржзред
- ржПржЯрж┐ ржПржХржЯрж┐ ржХрж▓рзЗржХрж╢ржирзЗ ржбрзЗржЯрж╛ ржорж░рзНржЬ, ржЖржкржбрзЗржЯ ржмрж╛ рж░рж┐ржкрзНрж▓рзЗрж╕ ржХрж░рждрзЗ рж╕ржХрзНрж╖ржоред ржЙржжрж╛рж╣рж░ржгрж╕рзНржмрж░рзВржк, ржЖржкржирж┐ ржПржХржЗ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржЙржкрж░ ржирждрзБржи ржбрзЗржЯрж╛ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ ржмрж╛ ржирждрзБржи ржбржХрзБржорзЗржирзНржЯ ржпрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред

### ржЙржжрж╛рж╣рж░ржг: $merge - ржХрж▓рзЗржХрж╢ржирзЗ ржбрзЗржЯрж╛ ржорж░рзНржЬ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `User` ржХрж▓рзЗржХрж╢ржи ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржирж┐рзЯрзЗ `user_final` ржирж╛ржоржХ ржХрж▓рзЗржХрж╢ржирзЗ ржорж░рзНржЬ ржХрж░ржЫрж┐, ржпрзЗржЦрж╛ржирзЗ ржпржжрж┐ ржПржХржЗ ржбржХрзБржорзЗржирзНржЯ ржкрж╛ржУрзЯрж╛ ржпрж╛рзЯ, рждржмрзЗ рждрж╛ ржЖржкржбрзЗржЯ рж╣ржмрзЗред

```js
app.get('/aggregation/merge', async (req, res) => {
  const result = await User.aggregate([
    { $match: { city: 'Dhaka' } },    // Dhaka рж╢рж╣рж░рзЗрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржирж┐рж░рзНржмрж╛ржЪржи
    { $merge: { into: 'user_final', whenMatched: 'merge', whenNotMatched: 'insert' } }  // ржорж░рзНржЬ ржХрж░рж╛ ржПржмржВ ржирж╛ ржкрж╛ржУрзЯрж╛ ржЧрзЗрж▓рзЗ ржирждрзБржи ржбржХрзБржорзЗржирзНржЯ ржпрзЛржЧ ржХрж░рж╛
  ]);
  res.json({ message: 'Data merged into user_final collection' });
});
```

- **whenMatched:** ржПржЦрж╛ржирзЗ ржЖржкржирж┐ ржХрж┐ржнрж╛ржмрзЗ ржорзЗржЪрж┐ржВ ржбржХрзБржорзЗржирзНржЯрзЗрж░ рж╕рж╛ржерзЗ ржХрж╛ржЬ ржХрж░ржмрзЗржи рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржпрзЗржоржи: `'merge'`, `'replace'`, `'keepExisting'` ржЗрждрзНржпрж╛ржжрж┐ред
- **whenNotMatched:** ржПржЦрж╛ржирзЗ ржЖржкржирж┐ ржирждрзБржи ржбржХрзБржорзЗржирзНржЯ ржпржЦржи ржорзЗрж▓рзЗ ржирж╛ рждржЦржи ржХрзА ржХрж░рждрзЗ ржЪрж╛ржи рждрж╛ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржпрзЗржоржи: `'insert'`, `'discard'` ржЗрждрзНржпрж╛ржжрж┐ред

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$addFields** рж╕рзНржЯрзЗржЬ ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЛржЧ ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржПржмржВ ржмрж┐ржжрзНржпржорж╛ржи ржлрж┐рж▓рзНржб ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред
ЁЯФе **$out** рж╕рзНржЯрзЗржЬ ржбрзЗржЯрж╛ рж╕рж░рж╛рж╕рж░рж┐ ржПржХржЯрж┐ ржХрж▓рзЗржХрж╢ржирзЗ рж▓рзЗржЦрж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржПржмржВ ржПржЯрж┐ ржПржХржЯрж┐ рж╢рзЗрж╖ рж╕рзНржЯрзЗржЬред
ЁЯФе **$merge** рж╕рзНржЯрзЗржЬ $out ржПрж░ ржорждрзЛржЗ, рждржмрзЗ ржПржЯрж┐ ржбрзЗржЯрж╛рж░ ржорж░рзНржЬ ржмрж╛ ржЖржкржбрзЗржЯ ржХрж░рж╛рж░ ржЬржирзНржп ржЖрж░ржУ ржлрзНрж▓рзЗржХрзНрж╕рж┐ржмрж▓ ржЕржкрж╢ржи ржжрзЗрзЯред



# ЁЯФН MongoDB Aggregation Framework - $group, $sum, ржПржмржВ $push рж╕рзНржЯрзЗржЬ

## ЁЯЯв $group рж╕рзНржЯрзЗржЬ
**$group** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбрзЗржЯрж╛ ржЧрзНрж░рзБржк ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд ржХрж┐ржЫрзБ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ ржЧрзНрж░рзБржк ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯ ржПржмржВ ржЧрзНрж░рзБржкрж┐ржВ ржХрж░рж╛рж░ ржкрж░ ржмрж┐ржнрж┐ржирзНржи ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗржЯ ржлрж╛ржВрж╢ржи ржкрзНрж░рзЯрзЛржЧ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи, ржпрзЗржоржи: **$sum**, **$avg**, **$max**, **$min** ржЗрждрзНржпрж╛ржжрж┐ред

- **$group** рж╕рзНржЯрзЗржЬрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржПржХ ржмрж╛ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржбрзЗржЯрж╛ржХрзЗ ржЧрзНрж░рзБржк ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред
- ржПржЯрж┐ ржкрзНрж░рждрж┐ржЯрж┐ ржЧрзНрж░рзБржкрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржирждрзБржи ржбржХрзБржорзЗржирзНржЯ рждрзИрж░рж┐ ржХрж░рзЗред

### ржЙржжрж╛рж╣рж░ржг 1: $group - ржЧрзНрж░рзБржкрж┐ржВ ржмрзЯрж╕ ржЕржирзБржпрж╛рзЯрзА
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ ржмрзЯрж╕рзЗрж░ ржЬржирзНржп ржорзЛржЯ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ рж╕ржВржЦрзНржпрж╛ ржЧржгржирж╛ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/group', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: '$age', totalUsers: { $sum: 1 } } }  // age ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ ржорзЛржЯ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж╕ржВржЦрзНржпрж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $group - ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ рж╕рж░рзНржмрзЛржЪрзНржЪ ржмрзЯрж╕ ржмрзЗрж░ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `city` ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ рж╢рж╣рж░рзЗрж░ рж╕рж░рзНржмрзЛржЪрзНржЪ ржмрзЯрж╕ ржмрзЗрж░ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/group-max-age', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: '$city', maxAge: { $max: '$age' } } }  // city ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ max age ржмрзЗрж░ ржХрж░рж╛
  ]);
  res.json(result);
});
```

## ЁЯЯв $sum рж╕рзНржЯрзЗржЬ
**$sum** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржПржХржЯрж┐ ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗржЯ ржлрж╛ржВрж╢ржи ржпрж╛ ржЧрзНрж░рзБржкрж┐ржВ ржХрж░рж╛рж░ ржкрж░ ржХрзЛржи ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржпрзЛржЧ ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд **$group** рж╕рзНржЯрзЗржЬрзЗрж░ ржнрж┐рждрж░рзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред

- **$sum** рж╕рзНржЯрзЗржЬ ржЧрзНрж░рзБржкрзЗрж░ ржкрзНрж░рждрж┐ржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржпрзЛржЧ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред
- ржПржЯрж┐ ржПржХрж╛ржзрж┐ржХ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржорж╛ржи ржпрзЛржЧ ржмрж╛ ржЧрзБржи ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛рзЯред

### ржЙржжрж╛рж╣рж░ржг 1: $sum - ржорзЛржЯ ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржпрзЛржЧ ржХрж░рзЗ ржорзЛржЯ ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓ ржмрзЗрж░ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/sum', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: null, totalAge: { $sum: '$age' } } }  // рж╕ржХрж▓ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржмрзЯрж╕ ржпрзЛржЧ ржХрж░рж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $sum - ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╢рж░рзНрждрзЗ ржпрзЛржЧржлрж▓
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ рж╢рзБржзрзБ `age` ржПрж░ ржнрж┐рждрзНрждрж┐рждрзЗ рж╢рж░рзНржд ржкрзВрж░рзНржг рж╣рж▓рзЗ ржорзЛржЯ ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓ ржмрзЗрж░ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/sum-condition', async (req, res) => {
  const result = await User.aggregate([
    { $match: { city: 'Dhaka' } },   // Dhaka рж╢рж╣рж░рзЗрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░рж╛
    { $group: { _id: null, totalAge: { $sum: '$age' } } }  // Dhaka рж╢рж╣рж░рзЗрж░ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓
  ]);
  res.json(result);
});
```

## ЁЯЯв $push рж╕рзНржЯрзЗржЬ
**$push** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛржХрзЗ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ рж╣рж┐рж╕рзЗржмрзЗ рж╕рж╛ржЬрж╛ржирзЛрж░ ржЬржирзНржпред ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд **$group** рж╕рзНржЯрзЗржЬрзЗрж░ рж╕рж╛ржерзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржпрж╛рждрзЗ ржПржХрж╛ржзрж┐ржХ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржорж╛ржи ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗрждрзЗ ржПржХрждрзНрж░рж┐ржд ржХрж░рж╛ ржпрж╛рзЯред

- **$push** рж╕рзНржЯрзЗржЬ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐ ржХрж░рзЗ, ржпрж╛ ржЧрзНрж░рзБржкрзЗрж░ ржнрж┐рждрж░рзЗ ржерж╛ржХрж╛ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржорж╛ржиржЧрзБрж▓рзЛ ржзрж╛рж░ржг ржХрж░ржмрзЗред
- ржПржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржХрзЛржирзЛ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржмрж╛ ржкрзБрж░рзЛ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐ ржХрж░рждрзЗ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред

### ржЙржжрж╛рж╣рж░ржг 1: $push - ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржирж╛ржорзЗрж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `city` ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ рж╢рж╣рж░рзЗрж░ рж╕ржХрж▓ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржирж╛ржорзЗрж░ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/push', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: '$city', users: { $push: '$name' } } }  // city ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ users ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $push - ржХрж╛рж╕рзНржЯржо ржлрж┐рж▓рзНржбрзЗрж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ ржмрзЯрж╕рзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржХрж╛рж╕рзНржЯржо ржлрж┐рж▓рзНржбрзЗрж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/push-custom', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: '$age', usersInfo: { $push: { name: '$name', city: '$city' } } } }  // age ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ name ржУ city ржПрж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐
  ]);
  res.json(result);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$group** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбрзЗржЯрж╛ ржЧрзНрж░рзБржк ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи: ржмрзЯрж╕, рж╢рж╣рж░, ржмрж╛ ржЕржирзНржпрж╛ржирзНржп ржХрж╛рж╕рзНржЯржо рж╢рж░рзНрждрзЗред
ЁЯФе **$sum** рж╕рзНржЯрзЗржЬ ржЧрзНрж░рзБржкрзЗрж░ ржнрж┐рждрж░рзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржпрзЛржЧ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи: ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓ ржмрж╛ ржЕржирзНржп ржХрзЛржи рж╕ржВржЦрзНржпрж╛рж░ ржпрзЛржЧржлрж▓ред
ЁЯФе **$push** рж╕рзНржЯрзЗржЬ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐ ржХрж░рзЗ ржпрж╛ ржЧрзНрж░рзБржкрзЗрж░ ржнрж┐рждрж░рзЗ ржерж╛ржХрж╛ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржиржЧрзБрж▓рзЛржХрзЗ ржзрж╛рж░ржг ржХрж░рзЗред ржПржЯрж┐ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржирж╛ржо ржмрж╛ ржЕржирзНржп ржХрж╛рж╕рзНржЯржо ржбрзЗржЯрж╛рж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред



# ЁЯФН MongoDB Aggregation Framework - $group ржПржмржВ $project рж╕рзНржЯрзЗржЬ

## ЁЯЯв $group рж╕рзНржЯрзЗржЬ
**$group** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбрзЗржЯрж╛ ржЧрзНрж░рзБржк ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ ржмрж┐ржнрж┐ржирзНржи ржбржХрзБржорзЗржирзНржЯржХрзЗ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржнрж┐рждрзНрждрж┐рждрзЗ ржЧрзНрж░рзБржк ржХрж░рзЗ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ ржЧрзНрж░рзБржкрзЗрж░ ржЙржкрж░ ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗржЯ ржлрж╛ржВрж╢ржи ржкрзНрж░рзЯрзЛржЧ ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржжрзЗрзЯред ржпрзЗржоржи, ржЖржкржирж┐ ржПржХрж╛ржзрж┐ржХ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржорж╛ржи ржпрзЛржЧ ржХрж░рждрзЗ, ржЧрзЬ ржмрзЗрж░ ржХрж░рждрзЗ, рж╕рж░рзНржмрзЛржЪрзНржЪ ржмрж╛ рж╕рж░рзНржмржирж┐ржорзНржи ржорж╛ржи ржмрзЗрж░ ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

- **$group** рж╕рзНржЯрзЗржЬ ржЧрзНрж░рзБржкрж┐ржВ ржХрж░рж╛рж░ ржкрж░ ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗржЯ ржлрж╛ржВрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржмрж┐ржнрж┐ржирзНржи рждржерзНржп ржмрзЗрж░ ржХрж░рж╛рж░ ржЬржирзНржп рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред
- **$group** рж╕рзНржЯрзЗржЬрзЗ **_id** ржлрж┐рж▓рзНржб ржерж╛ржХрж╛ ржмрж╛ржзрзНржпрждрж╛ржорзВрж▓ржХред ржПржЯрж┐ ржЧрзНрж░рзБржкрж┐ржВрзЯрзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд ржлрж┐рж▓рзНржб ржмрж╛ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржб рж╣рждрзЗ ржкрж╛рж░рзЗред
- **$group** рж╕рзНржЯрзЗржЬрзЗрж░ ржоржзрзНржпрзЗ ржмрж┐ржнрж┐ржирзНржи ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗржЯ ржлрж╛ржВрж╢ржи (ржпрзЗржоржи, **$sum**, **$avg**, **$max**, **$min**, **$first**, **$last** ржЗрждрзНржпрж╛ржжрж┐) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛рзЯред

### ржЙржжрж╛рж╣рж░ржг 1: $group - ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╢рж╣рж░рзЗрж░ ржоржзрзНржпрзЗ ржорзЛржЯ ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓ ржмрзЗрж░ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `city` ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ рж╢рж╣рж░рзЗрж░ ржЬржирзНржп ржорзЛржЯ ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓ ржмрзЗрж░ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/group-total-age', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: '$city', totalAge: { $sum: '$age' } } }  // city ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ ржорзЛржЯ ржмрзЯрж╕рзЗрж░ ржпрзЛржЧржлрж▓ ржмрзЗрж░ ржХрж░рж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $group - рж╕рж░рзНржмрзЛржЪрзНржЪ ржмрзЯрж╕ ржмрзЗрж░ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `city` ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ рж╢рж╣рж░рзЗрж░ рж╕рж░рзНржмрзЛржЪрзНржЪ ржмрзЯрж╕ ржмрзЗрж░ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/group-max-age', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: '$city', maxAge: { $max: '$age' } } }  // city ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ рж╕рж░рзНржмрзЛржЪрзНржЪ ржмрзЯрж╕ ржмрзЗрж░ ржХрж░рж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 3: $group - ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ ржирж╛ржорзЗрж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `city` ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ рж╢рж╣рж░рзЗрж░ рж╕ржХрж▓ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░ ржирж╛ржорзЗрж░ ржПржХржЯрж┐ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/group-users', async (req, res) => {
  const result = await User.aggregate([
    { $group: { _id: '$city', users: { $push: '$name' } } }  // city ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржкрж┐ржВ ржПржмржВ ржирж╛ржорзЗрж░ ржЕрзНржпрж╛рж░рзЗ рждрзИрж░рж┐
  ]);
  res.json(result);
});
```

## ЁЯЯв $project рж╕рзНржЯрзЗржЬ
**$project** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржнрзЗрждрж░рзЗрж░ ржлрж┐рж▓рзНржб ржЧрзБрж▓рзЛржХрзЗ ржЕржирзНрждрж░рзНржнрзБржХрзНржд ржмрж╛ ржмрж╛ржж ржжрзЗрзЯрж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд ржПржХржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржХрж╛ржарж╛ржорзЛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи ржлрж┐рж▓рзНржб ржЧрзБрж▓рж┐ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рж╛ ржмрж╛ ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рж╛ред

- **$project** рж╕рзНржЯрзЗржЬрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ рж╢рзБржзрзБржорж╛рждрзНрж░ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи ржПржмржВ ржмрж╛ржХрж┐ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржмрж╛ржж ржжрж┐рждрзЗ ржкрж╛рж░ржмрзЗржиред
- ржПржЯрж┐ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ, ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рждрзЗ ржмрж╛ ржмрж┐ржжрзНржпржорж╛ржи ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред
- ржЖржкржирж┐ **0** ржмрж╛ **1** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржлрж┐рж▓рзНржб ржЗржиржХрзНрж▓рзБржб ржмрж╛ ржПржХрзНрж╕ржХрзНрж▓рзБржб ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред

### ржЙржжрж╛рж╣рж░ржг 1: $project - ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржб ржЧрзБрж▓рж┐ рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `name` ржПржмржВ `age` ржлрж┐рж▓рзНржбржХрзЗ рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░ржЫрж┐ ржПржмржВ ржмрж╛ржХрж┐ ржлрж┐рж▓рзНржбржЧрзБрж▓рзЛ ржмрж╛ржж ржжрж┐ржЪрзНржЫрж┐ред

```js
app.get('/aggregation/project', async (req, res) => {
  const result = await User.aggregate([
    { $project: { name: 1, age: 1 } }  // name ржПржмржВ age рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $project - ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `firstName` ржПржмржВ `lastName` ржерзЗржХрзЗ `fullName` ржирж╛ржорзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/project-fullname', async (req, res) => {
  const result = await User.aggregate([
    { $project: { fullName: { $concat: ['$firstName', ' ', '$lastName'] } } }  // firstName ржПржмржВ lastName ржерзЗржХрзЗ fullName рждрзИрж░рж┐
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 3: $project - ржлрж┐рж▓рзНржб ржорж╛ржи ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи рзл ржмржЫрж░ ржмрж╛рзЬрж┐рзЯрзЗ ржПржХржЯрж┐ ржирждрзБржи ржлрж┐рж▓рзНржб `newAge` рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/project-age', async (req, res) => {
  const result = await User.aggregate([
    { $project: { newAge: { $add: ['$age', 5] }, name: 1 } }  // age ржП рзл ржмржЫрж░ ржпрзЛржЧ ржХрж░рзЗ newAge рждрзИрж░рж┐
  ]);
  res.json(result);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$group** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбрзЗржЯрж╛ ржЧрзНрж░рзБржк ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи: ржмрзЯрж╕, рж╢рж╣рж░, ржмрж╛ ржЕржирзНржпрж╛ржирзНржп ржХрж╛рж╕рзНржЯржо рж╢рж░рзНрждрзЗред
ЁЯФе **$sum**, **$avg**, **$max**, **$min** ржЗрждрзНржпрж╛ржжрж┐ ржЕрзНржпрж╛ржЧрзНрж░рж┐ржЧрзЗржЯ ржлрж╛ржВрж╢ржи **$group** рж╕рзНржЯрзЗржЬрзЗрж░ ржоржзрзНржпрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред
ЁЯФе **$project** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржлрж┐рж▓рзНржб ржЧрзБрж▓рж┐ рж╕рж┐рж▓рзЗржХрзНржЯ, ржмрж╛ржж ржжрзЗржУрзЯрж╛ ржмрж╛ ржирждрзБржи ржлрж┐рж▓рзНржб рждрзИрж░рж┐ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред
ЁЯФе **$project** ржлрж┐рж▓рзНржб ржорж╛ржи ржХрж╛рж╕рзНржЯржорж╛ржЗржЬ ржХрж░рж╛рж░ ржЬржирзНржпржУ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржпрж╛рзЯ, ржпрзЗржоржи: ржпрзЛржЧржлрж▓, ржПржХрзНрж╕ржкрзНрж░рзЗрж╢ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ ржЗрждрзНржпрж╛ржжрж┐ред



# ЁЯФН MongoDB Aggregation Framework - $bucket, $sort, ржПржмржВ $limit рж╕рзНржЯрзЗржЬ

## ЁЯЯв $bucket рж╕рзНржЯрзЗржЬ
**$bucket** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбрзЗржЯрж╛ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкрж░рж┐рж╕рж░рзЗрж░ ржоржзрзНржпрзЗ ржнрж╛ржЧ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ ржорзВрж▓ржд ржПржХржЯрж┐ "bucket" рждрзИрж░рж┐ ржХрж░рзЗ ржПржмржВ ржмрж┐ржнрж┐ржирзНржи ржбржХрзБржорзЗржирзНржЯржХрзЗ рж╕рзЗржЗ "bucket"-ржПрж░ ржоржзрзНржпрзЗ ржмрж┐рждрж░ржг ржХрж░рзЗред рж╕рж╛ржзрж╛рж░ржгржд ржПржЯрж┐ рж░рзЗржЮрзНржЬ ржнрж┐рждрзНрждрж┐ржХ ржЧрзНрж░рзБржкрж┐ржВ ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред

- **$bucket** рж╕рзНржЯрзЗржЬрзЗ **boundaries** (рж╕рзАржорж╛) ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржХрж░рж╛ рж╣рзЯ, ржпрзЗржЧрзБрж▓рзЛрж░ ржоржзрзНржпрзЗ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛ ржнрж╛ржЧ рж╣ржмрзЗред
- **$bucket** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЖржкржирж┐ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛрж░ ржоржзрзНржпрзЗ ржХрзЛржи ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржирзЗрж░ рж░рзЗржЮрзНржЬ ржЕржирзБржпрж╛рзЯрзА ржЧрзНрж░рзБржк ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред

### ржЙржжрж╛рж╣рж░ржг 1: $bucket - ржмрзЯрж╕рзЗрж░ рж░рзЗржЮрзНржЬрзЗ ржЧрзНрж░рзБржкрж┐ржВ
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржЕржирзБржпрж╛рзЯрзА ржмрзЯрж╕рзЗрж░ рж░рзЗржЮрзНржЬ (ржпрзЗржоржи: 0-20, 21-40, 41-60) рждрзИрж░рж┐ ржХрж░ржЫрж┐ ржПржмржВ ржкрзНрж░рждрж┐ржЯрж┐ рж░рзЗржЮрзНржЬрзЗ ржХрждржЬржи ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж░рзЯрзЗржЫрзЗ рждрж╛ ржЧржгржирж╛ ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/bucket-age', async (req, res) => {
  const result = await User.aggregate([
    { 
      $bucket: {
        groupBy: '$age',  // ржпрзЗ ржлрж┐рж▓рзНржбрзЗ ржЧрзНрж░рзБржкрж┐ржВ ржХрж░рждрзЗ рж╣ржмрзЗ (ржПржЦрж╛ржирзЗ age)
        boundaries: [0, 20, 40, 60, 80],  // ржмрзЯрж╕рзЗрж░ рж░рзЗржЮрзНржЬ
        default: 'Other',  // ржпржжрж┐ age ржХрзЛржи рж░рзЗржЮрзНржЬрзЗ ржирж╛ ржЖрж╕рзЗ, рждрж╛рж╣рж▓рзЗ 'Other' рж╣рж┐рж╕рзЗржмрзЗ ржХрзНржпрж╛ржЯрзЗржЧрж░рж╛ржЗржЬ ржХрж░рж╛ рж╣ржмрзЗ
        output: { 
          count: { $sum: 1 }  // ржкрзНрж░рждрж┐ржЯрж┐ рж░рзЗржЮрзНржЬрзЗ ржХрждржЬржи ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзА рж░рзЯрзЗржЫрзЗ рждрж╛ ржЧржгржирж╛ ржХрж░рж╛
        }
      }
    }
  ]);
  res.json(result);
});
```

## ЁЯЯв $sort рж╕рзНржЯрзЗржЬ
**$sort** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбрзЗржЯрж╛ рж╕рж╛ржЬрж╛ржирзЛрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛ рж╕рж╛ржЬрж╛ржирзЛрж░ рж╕рзБржпрзЛржЧ ржжрзЗрзЯ, ржпрзЗржоржи: ржХрзНрж░ржоAscending ржмрж╛ Descending-ржП рж╕рж╛ржЬрж╛ржирзЛред

- **$sort** рж╕рзНржЯрзЗржЬрзЗ ржлрж┐рж▓рзНржб ржирж╛ржо ржПржмржВ ржХрзНрж░ржо (1 ржмрж╛ -1) ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рж╛ рж╣рзЯ, ржпрзЗржЦрж╛ржирзЗ **1** ржорж╛ржирзЗ Ascending (ржЫрзЛржЯ ржерзЗржХрзЗ ржмрзЬ) ржПржмржВ **-1** ржорж╛ржирзЗ Descending (ржмрзЬ ржерзЗржХрзЗ ржЫрзЛржЯ)ред
- ржПржЯрж┐ ржЖржкржирж╛ржХрзЗ ржбрзЗржЯрж╛ рж╕рж╛ржЬрж╛ржирзЛрж░ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ, ржпрж╛рждрзЗ ржЖржкржирж┐ ржбрзЗржЯрж╛ рж╕ржмржЪрзЗрзЯрзЗ ржЫрзЛржЯ ржмрж╛ ржмрзЬ ржорж╛ржи ржЕржирзБрж╕рж╛рж░рзЗ рж╕рж╛ржЬрж╛рждрзЗ ржкрж╛рж░рзЗржиред

### ржЙржжрж╛рж╣рж░ржг 1: $sort - ржмрзЯрж╕ ржЕржирзБржпрж╛рзЯрзА рж╕рж╛ржЬрж╛ржирзЛ
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ рж╕рж╛ржЬрж╛ржЪрзНржЫрж┐, ржкрзНрж░ржержорзЗ Ascending (ржЫрзЛржЯ ржерзЗржХрзЗ ржмрзЬ) ржПржмржВ ржкрж░рзЗ Descending (ржмрзЬ ржерзЗржХрзЗ ржЫрзЛржЯ)ред

```js
app.get('/aggregation/sort', async (req, res) => {
  const result = await User.aggregate([
    { $sort: { age: 1 } }  // ржмрзЯрж╕рзЗрж░ ржЙржкрж░ Ascending (ржЫрзЛржЯ ржерзЗржХрзЗ ржмрзЬ) ржЕржирзБрж╕рж╛рж░рзЗ рж╕рж╛ржЬрж╛ржирзЛ
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $sort - ржмрзЯрж╕рзЗрж░ ржнрж┐рждрзНрждрж┐рждрзЗ Descending (ржмрзЬ ржерзЗржХрзЗ ржЫрзЛржЯ) рж╕рж╛ржЬрж╛ржирзЛ
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `age` ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАржжрзЗрж░ рж╕рж╛ржЬрж╛ржЪрзНржЫрж┐, рждржмрзЗ ржПржЗржмрж╛рж░ Descending (ржмрзЬ ржерзЗржХрзЗ ржЫрзЛржЯ) ржХрзНрж░ржорзЗред

```js
app.get('/aggregation/sort-desc', async (req, res) => {
  const result = await User.aggregate([
    { $sort: { age: -1 } }  // ржмрзЯрж╕рзЗрж░ ржЙржкрж░ Descending (ржмрзЬ ржерзЗржХрзЗ ржЫрзЛржЯ) ржЕржирзБрж╕рж╛рж░рзЗ рж╕рж╛ржЬрж╛ржирзЛ
  ]);
  res.json(result);
});
```

## ЁЯЯв $limit рж╕рзНржЯрзЗржЬ
**$limit** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржбржХрзБржорзЗржирзНржЯрзЗрж░ рж╕ржВржЦрзНржпрж╛ рж╕рзАржорж╛ржмржжрзНржз ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ рж╕ржВржЦрзНржпрж╛ ржкрж░рзНржпржирзНржд ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ, ржпрж╛рждрзЗ ржЖржкржирж┐ ржЕрждрж┐рж░рж┐ржХрзНржд ржбрзЗржЯрж╛ рж░рж┐ржЯрж╛рж░рзНржи ржирж╛ ржХрж░рзЗржиред

- **$limit** рж╕рзНржЯрзЗржЬ рж╕рж╛ржзрж╛рж░ржгржд ржЕржирзЗржХ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржоржзрзНржпрзЗ ржерзЗржХрзЗ ржХрж┐ржЫрзБ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржбржХрзБржорзЗржирзНржЯ ржирж┐рж░рзНржмрж╛ржЪржи ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред
- ржПржЯрж┐ рж╕ржмрж╕ржорзЯ ржбржХрзБржорзЗржирзНржЯрзЗрж░ рж╕ржВржЦрзНржпрж╛ рж╕рзАржорж╛ржмржжрзНржз ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗ, ржпрзЗржоржи: ржкрзНрж░ржержо рззрзжржЯрж┐ ржбржХрзБржорзЗржирзНржЯ ржмрж╛ рж╕рж░рзНржмрзЛржЪрзНржЪ рзлржЯрж┐ ржбржХрзБржорзЗржирзНржЯред

### ржЙржжрж╛рж╣рж░ржг 1: $limit - рж╕рж░рзНржмрзЛржЪрзНржЪ рзлржЯрж┐ ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ рж╕рж░рзНржмрзЛржЪрзНржЪ рзлржЯрж┐ ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/limit', async (req, res) => {
  const result = await User.aggregate([
    { $limit: 5 }  // ржкрзНрж░ржержо рзлржЯрж┐ ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $limit - рж╕рж░рзНржмрзЛржЪрзНржЪ рззрзжржЯрж┐ ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛ ржПржмржВ рждрж╛рж░ржкрж░ $sort
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ ржкрзНрж░ржержорзЗ рззрзжржЯрж┐ ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░ржЫрж┐ ржПржмржВ рждрж╛рж░ржкрж░ рж╕рзЗржЧрзБрж▓рзЛ ржмрзЯрж╕рзЗрж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ рж╕рж╛ржЬрж╛ржЪрзНржЫрж┐ред

```js
app.get('/aggregation/limit-sort', async (req, res) => {
  const result = await User.aggregate([
    { $limit: 10 },  // ржкрзНрж░ржержо рззрзжржЯрж┐ ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛
    { $sort: { age: 1 } }  // ржмрзЯрж╕рзЗрж░ ржЙржкрж░ Ascending (ржЫрзЛржЯ ржерзЗржХрзЗ ржмрзЬ) рж╕рж╛ржЬрж╛ржирзЛ
  ]);
  res.json(result);
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$bucket** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбрзЗржЯрж╛ржХрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржкрж░рж┐рж╕рж░рзЗрж░ ржоржзрзНржпрзЗ ржнрж╛ржЧ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи: ржмрзЯрж╕рзЗрж░ рж░рзЗржЮрзНржЬрзЗ ржЧрзНрж░рзБржкрж┐ржВ ржХрж░рж╛ред
ЁЯФе **$sort** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбрзЗржЯрж╛ рж╕рж╛ржЬрж╛ржирзЛрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи: ржмрзЯрж╕ ржмрж╛ ржирж╛ржо ржЕржирзБржпрж╛рзЯрзА Ascending ржмрж╛ Descending ржХрзНрж░ржорзЗ рж╕рж╛ржЬрж╛ржирзЛред
ЁЯФе **$limit** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржбржХрзБржорзЗржирзНржЯрзЗрж░ рж╕ржВржЦрзНржпрж╛ рж╕рзАржорж╛ржмржжрзНржз ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи: ржкрзНрж░ржержо рзлржЯрж┐ ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░рж╛ред


# ЁЯФН MongoDB Aggregation Framework - $lookup рж╕рзНржЯрзЗржЬ ржПржмржВ Embedding vs Referencing

## ЁЯЯв $lookup рж╕рзНржЯрзЗржЬ
**$lookup** рж╕рзНржЯрзЗржЬ MongoDB Aggregation Framework-ржП ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржжрзБржЯрж┐ ржЖрж▓рж╛ржжрж╛ ржХрзЛрж▓рзЗржХрж╢ржиржХрзЗ ржПржХрждрзНрж░рж┐ржд ржХрж░рж╛рж░ ржЬржирзНржпред ржПржЯрж┐ **join** ржПрж░ ржорждрзЛ ржХрж╛ржЬ ржХрж░рзЗ, ржпрзЗржЦрж╛ржирзЗ ржПржХржЯрж┐ ржХрзЛрж▓рзЗржХрж╢ржи ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржЕржирзНржп ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ рж╕рж╛ржерзЗ рж╕ржВржпрзБржХрзНржд ржХрж░рж╛ рж╣рзЯред MongoDB рждрзЗ `join` рж╕рж╛ржзрж╛рж░ржгржд ржПржХрж╛ржзрж┐ржХ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржоржзрзНржпрзЗ рж╕ржорзНржкрж░рзНржХ рж╕рзНржерж╛ржкржи ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред

- **$lookup** рж╕рзНржЯрзЗржЬ ржжрзБржЯрж┐ ржХрзЛрж▓рзЗржХрж╢ржиржХрзЗ **left outer join** ржПрж░ ржорж╛ржзрзНржпржорзЗ ржПржХрждрзНрж░рж┐ржд ржХрж░рзЗред ржЕрж░рзНржерж╛рзО, ржпрзЗржЗ ржбржХрзБржорзЗржирзНржЯржЧрзБрж▓рзЛ ржПржХ ржХрзЛрж▓рзЗржХрж╢ржирзЗ ржЙржкрж╕рзНржерж┐ржд ржЖржЫрзЗ, рждрж╛ржжрзЗрж░ рж╕рж╛ржерзЗ ржЕржирзНржп ржХрзЛрж▓рзЗржХрж╢ржи ржерзЗржХрзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд ржбрзЗржЯрж╛ ржпрзБржХрзНржд рж╣рзЯред
- ржПржЯрж┐ **from**, **localField**, **foreignField**, ржПржмржВ **as** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржжрзБржЯрж┐ ржХрзЛрж▓рзЗржХрж╢ржиржХрзЗ ржпрзБржХрзНржд ржХрж░рзЗред

### ржЙржжрж╛рж╣рж░ржг 1: $lookup - ржПржХржЯрж┐ ржХрзЛрж▓рзЗржХрж╢ржи ржерзЗржХрзЗ ржЖрж░рзЗржХржЯрж┐ ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ ржбрзЗржЯрж╛ ржпрзБржХрзНржд ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `orders` ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ `customerId` ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржзрзНржпржорзЗ `customers` ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ ржбрзЗржЯрж╛ ржпрзБржХрзНржд ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/lookup', async (req, res) => {
  const result = await Order.aggregate([
    { 
      $lookup: {
        from: 'customers',        // ржпрзЗ ржХрзЛрж▓рзЗржХрж╢ржиржЯрж┐ join ржХрж░рждрзЗ рж╣ржмрзЗ (ржПржЦрж╛ржирзЗ customers)
        localField: 'customerId',  // current ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ ржлрж┐рж▓рзНржб
        foreignField: '_id',       // joining ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ ржлрж┐рж▓рзНржб
        as: 'customerDetails'      // ржирждрзБржи ржлрж┐рж▓рзНржб ржпрзЗржЦрж╛ржирзЗ join ржбрзЗржЯрж╛ рж░рж╛ржЦрж╛ рж╣ржмрзЗ
      }
    }
  ]);
  res.json(result);
});
```

### ржЙржжрж╛рж╣рж░ржг 2: $lookup - ржПржХрж╛ржзрж┐ржХ ржХрзЛрж▓рзЗржХрж╢ржи ржерзЗржХрзЗ ржбрзЗржЯрж╛ ржпрзБржХрзНржд ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `orders` ржХрзЛрж▓рзЗржХрж╢ржи ржерзЗржХрзЗ `customerId` ржПржмржВ `productId` ржПрж░ ржорж╛ржзрзНржпржорзЗ ржпржерж╛ржХрзНрж░ржорзЗ `customers` ржПржмржВ `products` ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ ржбрзЗржЯрж╛ ржпрзБржХрзНржд ржХрж░ржЫрж┐ред

```js
app.get('/aggregation/lookup-multiple', async (req, res) => {
  const result = await Order.aggregate([
    { 
      $lookup: {
        from: 'customers',
        localField: 'customerId',
        foreignField: '_id',
        as: 'customerDetails'
      }
    },
    { 
      $lookup: {
        from: 'products',
        localField: 'productId',
        foreignField: '_id',
        as: 'productDetails'
      }
    }
  ]);
  res.json(result);
});
```

## ЁЯЯв Embedding vs Referencing

MongoDB рждрзЗ ржбрзЗржЯрж╛ рж╕рзНржЯрзЛрж░ ржХрж░рж╛рж░ ржжрзБржЗржЯрж┐ ржорзВрж▓ ржкржжрзНржзрждрж┐ рж░рзЯрзЗржЫрзЗ: **Embedding** ржПржмржВ **Referencing**ред ржПржЗ ржжрзБржЯрж┐ ржкржжрзНржзрждрж┐рж░ ржоржзрзНржпрзЗ ржкрж╛рж░рзНржержХрзНржп рж╣рж▓рзЛ ржбрзЗржЯрж╛рж░ рж╕ржВрж░ржХрзНрж╖ржг ржкржжрзНржзрждрж┐ ржПржмржВ ржХрж┐ржнрж╛ржмрзЗ ржбрзЗржЯрж╛ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рж╛ рж╣ржмрзЗред

### ЁЯФ╡ Embedding
**Embedding** ржкржжрзНржзрждрж┐рждрзЗ, ржбрзЗржЯрж╛ ржПржХржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржнрж┐рждрж░рзЗржЗ ржЕржирзНржп ржбржХрзБржорзЗржирзНржЯрзЗрж░ рждржерзНржп ржпрзБржХрзНржд ржХрж░рж╛ рж╣рзЯред ржЕрж░рзНржерж╛рзО, ржЖржкржирж┐ ржбрзЗржЯрж╛ржХрзЗ **nested** ржнрж╛ржмрзЗ рж╕рзНржЯрзЛрж░ ржХрж░рзЗржиред ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд рждржЦржи ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпржЦржи ржбрзЗржЯрж╛рж░ ржПржХржЯрж┐ ржЕржВрж╢ ржЕржкрж░ ржЕржВрж╢рзЗрж░ рж╕рж╛ржерзЗ ржжрзГрзЭржнрж╛ржмрзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд ржПржмржВ ржЖржкржирж┐ ржПржХржЗ рж╕ржорзЯрзЗ ржПржХрждрзНрж░рзЗ ржбрзЗржЯрж╛ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржХрж░рждрзЗ ржЪрж╛ржиред

- **Pros**:
  - ржжрзНрж░рзБржд ржкрзЬрж╛ (Fast reads) ржХрж╛рж░ржг рж╕ржм ржбрзЗржЯрж╛ ржПржХрждрзНрж░рзЗ ржерж╛ржХрзЗред
  - ржЕржирзЗржХ ржХржо join ржЕржкрж╛рж░рзЗрж╢ржи ржкрзНрж░ржпрж╝рзЛржЬржиред
  - ржЕржзрж┐ржХрж╛ржВрж╢ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржХржо query ржПрж░ ржкрзНрж░рзЯрзЛржЬржи рж╣рзЯред

- **Cons**:
  - ржбрзЗржЯрж╛ ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐ рж╣рждрзЗ ржкрж╛рж░рзЗ ржПржмржВ ржбрж┐рж╕рзНржХ рж╕рзНржкрзЗрж╕рзЗрж░ ржЕржкржЪрзЯ рж╣рждрзЗ ржкрж╛рж░рзЗред
  - ржпржжрж┐ ржбрзЗржЯрж╛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╣рзЯ рждржмрзЗ ржР ржбржХрзБржорзЗржирзНржЯржЯрж┐ржХрзЗ ржкрзБрж░рзЛржкрзБрж░рж┐ ржЖржкржбрзЗржЯ ржХрж░рждрзЗ рж╣ржмрзЗред
  - ржбрзЗржЯрж╛рж░ рж╕рж╛ржЗржЬ ржмрзЬ рж╣рж▓рзЗ ржбржХрзБржорзЗржирзНржЯржЯрж┐ ржмрзЬ рж╣рзЯрзЗ ржпрзЗрждрзЗ ржкрж╛рж░рзЗред

#### ржЙржжрж╛рж╣рж░ржг: Embedding
ржПржЦрж╛ржирзЗ `user` ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржоржзрзНржпрзЗ ржЖржорж░рж╛ `address` рж╕рзНржЯрзЛрж░ ржХрж░ржЫрж┐ред

```js
const userSchema = new mongoose.Schema({
  name: String,
  email: String,
  address: {
    street: String,
    city: String,
    zip: String
  }
});
```

### ЁЯФ╡ Referencing
**Referencing** ржкржжрзНржзрждрж┐рждрзЗ, ржЖржкржирж┐ ржбрзЗржЯрж╛рж░ ржжрзБржЯрж┐ ржЖрж▓рж╛ржжрж╛ ржбржХрзБржорзЗржирзНржЯ рждрзИрж░рж┐ ржХрж░рзЗржи ржПржмржВ рждрж╛ржжрзЗрж░ ржоржзрзНржпрзЗ ржПржХржЯрж┐ **reference** рж░рж╛ржЦрзЗржиред ржЕрж░рзНржерж╛рзО, ржПржХржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗ ржЕржирзНржп ржбржХрзБржорзЗржирзНржЯрзЗрж░ **ObjectId** рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рж╛ рж╣рзЯ, ржпрж╛ ржкрж░рзЗ ржкрзНрж░рзЯрзЛржЬржирзЗ ржПржХрждрзНрж░рж┐ржд ржХрж░рж╛ рж╣рзЯред

- **Pros**:
  - ржбрзЗржЯрж╛ ржкрзБржирж░рж╛ржмрзГрждрзНрждрж┐ рж╣рзЯ ржирж╛, рждрж╛ржЗ ржбрж┐рж╕рзНржХ рж╕рзНржкрзЗрж╕ рж╕рж╛рж╢рзНрж░рзЯрзАред
  - ржбрзЗржЯрж╛ ржпржЦржи ржкрж░рж┐ржмрж░рзНрждржи рж╣рзЯ, рждржЦржи рж╢рзБржзрзБржорж╛рждрзНрж░ ржПржХржЯрж┐ ржбржХрзБржорзЗржирзНржЯ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ рж╣рзЯред
  - ржЕржирзЗржХ ржмрзЗрж╢рж┐ рж╕рзНржХрзЗрж▓рзЗржмрж▓ (Scalable) ржХрж╛рж░ржг ржЫрзЛржЯ ржбржХрзБржорзЗржирзНржЯ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣рзЯред

- **Cons**:
  - ржПржХрж╛ржзрж┐ржХ ржХрзЛрж▓рзЗржХрж╢ржиржХрзЗ ржЬрзБржбрж╝рждрзЗ **join** ржмрж╛ **$lookup** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж▓рж╛ржЧрзЗ, ржпрж╛ ржХрж┐ржЫрзБржЯрж╛ ржзрзАрж░ржЧрждрж┐рж░ рж╣рждрзЗ ржкрж╛рж░рзЗред
  - ржЕрждрж┐рж░рж┐ржХрзНржд query ржПрж░ ржкрзНрж░рзЯрзЛржЬржи рж╣рждрзЗ ржкрж╛рж░рзЗред

#### ржЙржжрж╛рж╣рж░ржг: Referencing
ржПржЦрж╛ржирзЗ `order` ржбржХрзБржорзЗржирзНржЯрзЗ ржЖржорж░рж╛ `productId` ржПржмржВ `customerId` ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржзрзНржпржорзЗ ржЕржирзНржп ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ ржбрзЗржЯрж╛ рж░рзЗржлрж╛рж░рзЗржирзНрж╕ ржХрж░ржЫрж┐ред

```js
const orderSchema = new mongoose.Schema({
  customerId: { type: mongoose.Schema.Types.ObjectId, ref: 'Customer' },
  productId: { type: mongoose.Schema.Types.ObjectId, ref: 'Product' },
  orderDate: Date,
  quantity: Number
});
```

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **$lookup** рж╕рзНржЯрзЗржЬ MongoDB рждрзЗ ржжрзБржЯрж┐ ржХрзЛрж▓рзЗржХрж╢ржиржХрзЗ ржПржХрждрзНрж░рж┐ржд ржХрж░рж╛рж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржпрзЗржоржи: ржПржХ ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ `customerId` ржжрж┐рзЯрзЗ ржЖрж░рзЗржХ ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ ржбрзЗржЯрж╛ ржпрзЛржЧ ржХрж░рж╛ред
ЁЯФе **Embedding** ржкржжрзНржзрждрж┐рждрзЗ ржбрзЗржЯрж╛ ржПржХ ржбржХрзБржорзЗржирзНржЯрзЗрж░ ржоржзрзНржпрзЗ рж░рж╛ржЦрж╛ рж╣рзЯ ржПржмржВ ржПржЯрж┐ ржжрзНрж░рзБржд ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕рзЗрж░ ржЬржирзНржп ржЙржкржХрж╛рж░рзАред
ЁЯФе **Referencing** ржкржжрзНржзрждрж┐рждрзЗ ржбрзЗржЯрж╛ ржЖрж▓рж╛ржжрж╛ ржбржХрзБржорзЗржирзНржЯрзЗ рж░рж╛ржЦрж╛ рж╣рзЯ ржПржмржВ рждрж╛ржжрзЗрж░ ржоржзрзНржпрзЗ **ObjectId** ржжрж┐рзЯрзЗ рж╕ржорзНржкрж░рзНржХ рж╕рзНржерж╛ржкржи ржХрж░рж╛ рж╣рзЯ, ржпрж╛ рж╕рзНржХрзЗрж▓рзЗржмрж┐рж▓рж┐ржЯрж┐рж░ ржЬржирзНржп ржЙржкржпрзБржХрзНрждред



# ЁЯФН MongoDB - Indexing, COLLSCAN vs IXSCAN

## ЁЯЯв Indexing
**Indexing** рж╣рж▓ MongoDB-рждрзЗ ржбрзЗржЯрж╛рж░ ржжрзНрж░рзБржд ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ред ржпржЦржи ржПржХржЯрж┐ ржХрзЛрж▓рзЗржХрж╢ржирзЗ ржЕржирзЗржХ ржбржХрзБржорзЗржирзНржЯ ржерж╛ржХрзЗ, рждржЦржи ржбрзЗржЯрж╛рж░ ржоржзрзНржпрзЗ ржжрзНрж░рзБржд ржЕржирзБрж╕ржирзНржзрж╛ржи (search) ржПржмржВ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░рждрзЗ ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рж╛ рж╣рзЯред MongoDB ржбрж┐ржлрж▓рзНржЯржнрж╛ржмрзЗ **COLLSCAN** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржпржжрж┐ ржХрзЛржи ржЗржиржбрзЗржХрзНрж╕ ржирж╛ ржерж╛ржХрзЗ, рждржмрзЗ ржпржжрж┐ ржЗржиржбрзЗржХрзНрж╕ ржерж╛ржХрзЗ, рждржмрзЗ MongoDB рж╕рзЗржЗ ржЗржиржбрзЗржХрзНрж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗ, ржпрж╛ ржЦрзБржмржЗ ржжрзНрж░рзБрждред

- **Index** ржПржХржЯрж┐ ржбрж╛ржЯрж╛ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ (ржпрзЗржоржи: B-tree), ржпрж╛ MongoDB-ржХрзЗ ржжрзНрж░рзБржд ржбрзЗржЯрж╛ ржЦрзБржБржЬрзЗ ржкрзЗрждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред
- ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж┐ ржПржХржЯрж┐ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп **Query Performance** ржЙржирзНржиржд ржХрж░рждрзЗ ржкрж╛рж░рзЗржиред
- MongoDB ржмрж┐ржнрж┐ржирзНржи ржзрж░ржирзЗрж░ ржЗржиржбрзЗржХрзНрж╕ рж╕ржорж░рзНржержи ржХрж░рзЗ ржпрзЗржоржи **Single Field Index**, **Compound Index**, **Text Index**, **Geospatial Index**, ржЗрждрзНржпрж╛ржжрж┐ред

### ржЙржжрж╛рж╣рж░ржг: Single Field Index рждрзИрж░рж┐ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `email` ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░ржЫрж┐:

```js
UserSchema.index({ email: 1 });  // 1 ржорж╛ржирзЗ Ascending Order (ржЗржиржбрзЗржХрзНрж╕ Ascending ржЕржмрж╕рзНржерж╛рзЯ рж╣ржмрзЗ)
```

## ЁЯЯв COLLSCAN (Collection Scan)
**COLLSCAN** рж╣рж▓ MongoDB ржПрж░ ржПржХржЯрж┐ ржкржжрзНржзрждрж┐ ржпрзЗржЦрж╛ржирзЗ MongoDB ржХрзЛрж▓рзЗржХрж╢ржирзЗрж░ рж╕ржорж╕рзНржд ржбржХрзБржорзЗржирзНржЯ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рзЗ ржХрзБрзЯрзЗрж░рж┐ ржорзЗрж▓рзЗ ржХрж┐ржирж╛ рждрж╛ ржирж┐рж░рзНржзрж╛рж░ржг ржХрж░рждрзЗред ржПржЯрж┐ рждржЦржи ржШржЯрзЗ ржпржЦржи ржЗржиржбрзЗржХрзНрж╕ ржирж╛ ржерж╛ржХрзЗ ржПржмржВ MongoDB ржкрзБрж░рзЛ ржХрзЛрж▓рзЗржХрж╢ржи рж╕рзНржХрзНржпрж╛ржи ржХрж░рзЗ ржбрзЗржЯрж╛ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзЗред

- **COLLSCAN** рж╣ржЪрзНржЫрзЗ рж╕ржмржЪрзЗрзЯрзЗ ржзрзАрж░ ржЧрждрж┐рж░ ржкржжрзНржзрждрж┐, ржХрж╛рж░ржг MongoDB рж╕ржорж╕рзНржд ржбржХрзБржорзЗржирзНржЯ ржПржХрзЗ ржПржХрзЗ ржкрж░рзАржХрзНрж╖рж╛ ржХрж░рждрзЗ ржерж╛ржХрзЗред
- ржПржЯрж╛ ржмрж┐рж╢рзЗрж╖ржд рждржЦржи ржШржЯрзЗ ржпржЦржи ржЖржкржирж┐ ржПржоржи ржПржХржЯрж┐ ржлрж┐рж▓рзНржбрзЗ ржХрзБрзЯрзЗрж░рж┐ ржХрж░ржЫрзЗржи ржпрж╛рж░ ржЬржирзНржп ржХрзЛржирзЛ ржЗржиржбрзЗржХрзНрж╕ ржирзЗржЗред

### ржЙржжрж╛рж╣рж░ржг: COLLSCAN ржШржЯрзЗ ржпржЦржи ржЗржиржбрзЗржХрзНрж╕ ржирзЗржЗ
ржпржжрж┐ ржЖржорж░рж╛ `User` ржХрзЛрж▓рзЗржХрж╢ржирзЗ `name` ржлрж┐рж▓рзНржбрзЗ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рж┐, ржПржмржВ рж╕рзЗржЦрж╛ржирзЗ ржХрзЛржи ржЗржиржбрзЗржХрзНрж╕ ржирж╛ ржерж╛ржХрзЗ, рждржЦржи MongoDB **COLLSCAN** ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗред

```js
const users = await User.find({ name: 'John' });
```

**COLLSCAN** рж╕ржм ржбржХрзБржорзЗржирзНржЯ ржЪрзЗржХ ржХрж░ржмрзЗ `name: 'John'` ржорзЗрж▓рзЗ ржХрж┐ржирж╛ рждрж╛ ржЦрзБржБржЬрждрзЗред

## ЁЯЯв IXSCAN (Index Scan)
**IXSCAN** рж╣рж▓ MongoDB рждрзЗ ржпржЦржи ржЗржиржбрзЗржХрзНрж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржХрзБрзЯрзЗрж░рж┐ ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ржХрж░ржг ржХрж░рж╛ рж╣рзЯред MongoDB ржПржХржЯрж┐ ржЗржиржбрзЗржХрзНрж╕ рж╕рзНржХрзНржпрж╛ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЗржиржбрзЗржХрзНрж╕ ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржжрзНрж░рзБржд ржбрзЗржЯрж╛ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░рзЗред ржПржЯрж┐ **COLLSCAN** ржПрж░ ржЪрзЗрзЯрзЗ ржЕржирзЗржХ ржжрзНрж░рзБрждред

- **IXSCAN** MongoDB ржХрзЗржмрж▓ ржЗржиржбрзЗржХрзНрж╕рзЗ рж╕ржВрж░ржХрзНрж╖рж┐ржд ржбрзЗржЯрж╛рж░ ржЙржкрж░ ржнрж┐рждрзНрждрж┐ ржХрж░рзЗ ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рзЗ, ржлрж▓рзЗ ржбрзЗржЯрж╛рж░ ржоржзрзНржпрзЗ ржкрзБрж░рзЛ ржХрзЛрж▓рзЗржХрж╢ржи рж╕рзНржХрзНржпрж╛ржи ржХрж░рж╛рж░ ржкрзНрж░рзЯрзЛржЬржи рж╣рзЯ ржирж╛ред
- ржПржЯрж┐ рж╕рж╛ржзрж╛рж░ржгржд ржжрзНрж░рзБржд ржХрзБрзЯрзЗрж░рж┐ ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржкрзНрж░ржжрж╛ржи ржХрж░рзЗ, ржХрж╛рж░ржг MongoDB ржЗржиржбрзЗржХрзНрж╕рзЗрж░ ржорж╛ржзрзНржпржорзЗ ржбрзЗржЯрж╛рж░ ржЕржмрж╕рзНржерж╛ржи рж╕рж░рж╛рж╕рж░рж┐ ржЬрж╛ржирзЗред

### ржЙржжрж╛рж╣рж░ржг: IXSCAN ржШржЯрзЗ ржпржЦржи ржЗржиржбрзЗржХрзНрж╕ ржЖржЫрзЗ
ржпржжрж┐ ржЖржорж╛ржжрзЗрж░ `User` ржХрзЛрж▓рзЗржХрж╢ржирзЗ `email` ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ ржЗржиржбрзЗржХрзНрж╕ ржерж╛ржХрзЗ ржПржмржВ ржЖржорж░рж╛ `email` ржлрж┐рж▓рзНржбрзЗ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рж┐, рждржЦржи MongoDB **IXSCAN** ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗред

```js
const user = await User.find({ email: 'john@example.com' });
```

ржПржЦрж╛ржирзЗ MongoDB ржЗржиржбрзЗржХрзНрж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ **IXSCAN** ржХрж░ржмрзЗ ржПржмржВ ржЦрзБржм ржжрзНрж░рзБржд `email: 'john@example.com'` ржорзЗрж▓рж╛ржирзЛ ржбрзЗржЯрж╛ ржлрж┐рж░рж┐рзЯрзЗ ржжрзЗржмрзЗред

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **Indexing** MongoDB рждрзЗ ржбрзЗржЯрж╛рж░ ржжрзНрж░рзБржд ржЕржирзБрж╕ржирзНржзрж╛ржирзЗрж░ ржЬржирзНржп ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ MongoDB ржХрзЗ ржЗржиржбрзЗржХрзНрж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржбрзЗржЯрж╛ ржжрзНрж░рзБржд ржЦрзБржБржЬрждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред
ЁЯФе **COLLSCAN** рж╣рж▓ MongoDB ржПрж░ ржПржХржЯрж┐ ржкржжрзНржзрждрж┐, ржпрзЗржЦрж╛ржирзЗ MongoDB рж╕ржорж╕рзНржд ржбржХрзБржорзЗржирзНржЯ рж╕рзНржХрзНржпрж╛ржи ржХрж░рзЗ ржХрзБрзЯрзЗрж░рж┐ ржорзЗрж▓рж╛ржирзЛрж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░рзЗ, ржпржжрж┐ ржЗржиржбрзЗржХрзНрж╕ ржирж╛ ржерж╛ржХрзЗред
ЁЯФе **IXSCAN** MongoDB рждрзЗ ржЗржиржбрзЗржХрзНрж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржжрзНрж░рзБржд ржбрзЗржЯрж╛ ржЦрзБржБржЬрзЗ ржкрж╛ржУрзЯрж╛рж░ ржкржжрзНржзрждрж┐ред ржПржЯрж┐ **COLLSCAN** ржПрж░ ржЪрзЗрзЯрзЗ ржЕржирзЗржХ ржжрзНрж░рзБрждред



# ЁЯФН MongoDB - Compound Index ржПржмржВ Text Index

## ЁЯЯв Compound Index
**Compound Index** рж╣рж▓ ржПржоржи ржПржХржЯрж┐ ржЗржиржбрзЗржХрзНрж╕ ржпрж╛ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗ ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рзЗред MongoDB ржХрзЗржмрж▓ ржПржХржХ ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рж╛рж░ ржмржжрж▓рзЗ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рждрзЗ рж╕рж╣рж╛рзЯрждрж╛ ржХрж░рзЗред ржПржЯрж┐ рждржЦржи ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржпржЦржи ржХрзБрзЯрзЗрж░рж┐ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗ рж╣рждрзЗ ржкрж╛рж░рзЗ ржПржмржВ ржЖржкржирж┐ ржкрзНрж░рждрж┐ржЯрж┐ ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рждрзЗ ржЪрж╛ржи ржирж╛ред

- **Compound Index** ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рзЗ, ржпрж╛рждрзЗ ржмрж┐ржнрж┐ржирзНржи ржлрж┐рж▓рзНржбрзЗрж░ ржоржзрзНржпрзЗ рж╕ржорзНржкрж░рзНржХрж┐ржд ржХрзБрзЯрзЗрж░рж┐ ржжрзНрж░рзБржд ржкрзНрж░ржХрзНрж░рж┐рзЯрж╛ ржХрж░рж╛ ржпрж╛рзЯред
- Compound Index рж╕рж╛ржзрж╛рж░ржгржд рждржЦржи ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржпржЦржи ржЖржкржирж╛рж░ ржХрзБрзЯрзЗрж░рж┐ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗ ржирж┐рж░рзНржжрж┐рж╖рзНржЯ ржорж╛ржирзЗ ржлрж┐рж▓рзНржЯрж╛рж░ ржХрж░ржЫрзЗред
- Compound Index рждрзИрж░рж┐ ржХрж░рж▓рзЗ MongoDB рж╕рзЗржЗ ржЗржиржбрзЗржХрзНрж╕ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ ржПржмржВ рж╕рзЛрж░рзНржЯрж┐ржВ ржжрзБржЯрзЛржЗ ржжрзНрж░рзБржд ржХрж░рждрзЗ ржкрж╛рж░рзЗред

### ржЙржжрж╛рж╣рж░ржг: Compound Index рждрзИрж░рж┐ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `name` ржПржмржВ `email` ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ Compound Index рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
UserSchema.index({ name: 1, email: 1 });  // Compound Index on name and email
```

### ржЙржжрж╛рж╣рж░ржг: Compound Index ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рж╛
ржпржжрж┐ ржЖржорж░рж╛ `name` ржПржмржВ `email` ржжрзБржЯрзЛ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рж┐, рждрж╛рж╣рж▓рзЗ MongoDB Compound Index ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗред

```js
const user = await User.find({ name: 'John', email: 'john@example.com' });
```

**Compound Index** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ MongoDB ржПржХржЯрж┐ ржЗржиржбрзЗржХрзНрж╕ рж╕рзНржХрзНржпрж╛ржи ржХрж░ржмрзЗ, ржпрзЗржЦрж╛ржирзЗ ржПржЯрж┐ ржжрзБржЯрж┐ ржлрж┐рж▓рзНржбрзЗрж░ ржорж╛ржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржжрзНрж░рзБржд ржлрж▓рж╛ржлрж▓ ржлрж┐рж░рж┐рзЯрзЗ ржжрзЗржмрзЗред

## ЁЯЯв Text Index
**Text Index** рж╣рж▓ ржПржХржЯрж┐ ржмрж┐рж╢рзЗрж╖ ржзрж░ржирзЗрж░ ржЗржиржбрзЗржХрзНрж╕ ржпрж╛ MongoDB рждрзЗ ржЯрзЗржХрзНрж╕ржЯ ржбрзЗржЯрж╛рж░ ржЙржкрж░ ржЕржирзБрж╕ржирзНржзрж╛ржи ржкрж░рж┐ржЪрж╛рж▓ржирж╛ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред ржПржЯрж┐ MongoDB ржХрзЗ ржжрзНрж░рзБржд ржЯрзЗржХрзНрж╕ржЯрзЗрж░ ржоржзрзНржпрзЗ рж╢ржмрзНржж ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рждрзЗ рж╕рж╛рж╣рж╛ржпрзНржп ржХрж░рзЗред Text Index рж╕рж╛ржзрж╛рж░ржгржд ржмрзЬ ржкрж░рж┐ржорж╛ржгрзЗрж░ ржЯрзЗржХрзНрж╕ржЯ ржбрзЗржЯрж╛ ржпрзЗржЦрж╛ржирзЗ рж╢ржмрзНржж ржмрж╛ ржмрж╛ржХрзНржпрзЗрж░ ржоржзрзНржпрзЗ ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рж╛ рж╣рзЯ, рж╕рзЗржЦрж╛ржирзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯред

- **Text Index** рж╕рзНржмрзЯржВржХрзНрж░рж┐рзЯржнрж╛ржмрзЗ рж╕ржм рж╢ржмрзНржжржХрзЗ ржЗржиржбрзЗржХрзНрж╕ ржХрж░рзЗ, ржПржмржВ ржЖржкржирж┐ MongoDB-рждрзЗ ржмрж┐ржнрж┐ржирзНржи ржХрзБрзЯрзЗрж░рж┐ (ржпрзЗржоржи: `$text`) ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржЯрзЗржХрзНрж╕ржЯрзЗрж░ ржоржзрзНржпрзЗ ржжрзНрж░рзБржд ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржиред
- MongoDB ржПржХржЯрж┐ ржбржХрзБржорзЗржирзНржЯрзЗ ржПржХрж╛ржзрж┐ржХ **Text Index** рждрзИрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗ ржПржмржВ ржЖржкржирж┐ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рждрзЗ ржкрж╛рж░рзЗржи ржпрзЗ ржХрзЛржиржУ ржнрж╛рж╖рж╛рзЯред
- Text Index ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж▓рзЗ MongoDB ржлрж┐рж▓рзНржЯрж╛рж░рж┐ржВ, рж╕рзЛрж░рзНржЯрж┐ржВ, ржПржмржВ ржлрж╛ржЬрж┐ ржЕржирзБрж╕ржирзНржзрж╛ржи ржжрзНрж░рзБржд ржХрж░рждрзЗ ржкрж╛рж░рзЗред

### ржЙржжрж╛рж╣рж░ржг: Text Index рждрзИрж░рж┐ ржХрж░рж╛
ржПржЦрж╛ржирзЗ ржЖржорж░рж╛ `description` ржлрж┐рж▓рзНржбрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ Text Index рждрзИрж░рж┐ ржХрж░ржЫрж┐ред

```js
ProductSchema.index({ description: 'text' });  // Text Index on description
```

### ржЙржжрж╛рж╣рж░ржг: Text Index ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ ржХрзБрзЯрзЗрж░рж┐ ржХрж░рж╛
ржпржжрж┐ ржЖржорж░рж╛ `description` ржлрж┐рж▓рзНржбрзЗрж░ ржоржзрзНржпрзЗ ржЯрзЗржХрзНрж╕ржЯ ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рждрзЗ ржЪрж╛ржЗ, рждрж╛рж╣рж▓рзЗ MongoDB **$text** ржЕржкрж╛рж░рзЗржЯрж░ ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗред

```js
const products = await Product.find({ $text: { $search: 'laptop' } });
```

ржПржЦрж╛ржирзЗ MongoDB **Text Index** ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ `description` ржлрж┐рж▓рзНржбрзЗ "laptop" рж╢ржмрзНржжржЯрж┐ ржЦрзБржБржЬрзЗ ржмрзЗрж░ ржХрж░ржмрзЗ ржПржмржВ рж╕ржорж╕рзНржд ржбржХрзБржорзЗржирзНржЯ рж░рж┐ржЯрж╛рж░рзНржи ржХрж░ржмрзЗ ржпрзЗржЧрзБрж▓рзЛрж░ ржоржзрзНржпрзЗ ржПржЗ рж╢ржмрзНржжржЯрж┐ рж░рзЯрзЗржЫрзЗред

## ЁЯПБ рж╕рж╛рж░рзНржнрж╛рж░ ржЪрж╛рж▓рж╛ржирзЛ:
```js
app.listen(5000, () => {
  console.log('Server is running on port 5000');
});
```

---
ЁЯФе **Compound Index** ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗрж░ ржЙржкрж░ ржЗржиржбрзЗржХрзНрж╕ рждрзИрж░рж┐ ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ ржПржмржВ ржПржЯрж┐ ржПржоржи ржХрзБрзЯрзЗрж░рж┐ ржжрзНрж░рзБржд ржХрж░рждрзЗ рж╕рж╣рж╛рзЯрждрж╛ ржХрж░рзЗ ржпрзЗржЧрзБрж▓рзЛ ржПржХрж╛ржзрж┐ржХ ржлрж┐рж▓рзНржбрзЗ ржирж┐рж░рзНржнрж░рж╢рзАрж▓ред
ЁЯФе **Text Index** ржЯрзЗржХрзНрж╕ржЯ ржбрзЗржЯрж╛рж░ ржЙржкрж░ ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рждрзЗ ржмрзНржпржмрж╣рзГржд рж╣рзЯ, ржмрж┐рж╢рзЗрж╖ ржХрж░рзЗ ржпржЦржи ржмрзЬ ржкрж░рж┐ржорж╛ржгрзЗрж░ ржЯрзЗржХрзНрж╕ржЯ ржбрзЗржЯрж╛рждрзЗ рж╢ржмрзНржж ржмрж╛ ржмрж╛ржХрзНржпрзЗрж░ ржоржзрзНржпрзЗ ржжрзНрж░рзБржд ржЕржирзБрж╕ржирзНржзрж╛ржи ржХрж░рж╛ ржкрзНрж░рзЯрзЛржЬржиред



